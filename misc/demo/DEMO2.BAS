'$INCLUDE: 'KeyInput.BI'

DEFINT A-Z

DECLARE SUB DRAWBOX ()
DECLARE SUB SHOTSTRING ()

DIM NG%(18), NG1%(18), AP%(2), HF%(1, 6), DP(2, 4), FA%(1, 13), FY%(2), OF%(1), DT%(1), TM%(1, 13)
DIM D8(4, 3), PR%(1, 1), PC%(1), CZ%(1), OB$(9), DB$(14)
DIM R$(14), p$(1), X$(3), C7$(2), TS$(1), CM$(1), U5$(3), LC$(2), TB$(1)
DIM TR%(1, 9), Y$(1), Z5(1), Z6(1), PS$(4), D2(1), S1(1), RB(9), P5(14), P4(14)
DIM vg%(8), vh%(8), V1%(1), V2%(1), L%(1, 4), P2(1), YN$(5), PB$(1), N%(16, 16, 3), N$(16, 16, 3)
DIM YN1$(3), TP%(1), TF%(1),Q$(250),O$(9),teamIndex%(500)
DIM O%(100), HT%(100), HO$(100), H$(100), SX%(32, 1, 14), ST%(32)
DIM APT%(100, 1), CRD(100) AS LONG, SITE$(100)
DIM G9%(1), F5%(1, 8), W%(1, 13, 1), IY(1), O0%(1), V$(500), Z2(13, 13) AS SINGLE
DIM F1(13), S3(13), G4(13), G5(13), D$(15), D1(1), W0(1, 13), W1(1, 13)
DIM A(1, 13, 24) AS SINGLE, AA$(1, 13), B$(1), P7(1), R3(1), T0(1), T1(1), SX$(32, 2), W2(1, 13), W3(1, 13)
DIM B1(1, 4), S(1, 9), V9(14), C(1, 13, 6), ZZ(1, 13), B%(1, 13, 18), Z(15) AS SINGLE, Z1(15) AS SINGLE
DIM C$(1),S$(1),A1$(1),ATT(1) AS LONG,DF(1,13),PO$(1,13),RS(1,13,13),T2%(1,20)
DIM E%(13), QQ(1, 8, 13, 14), QR(1, 7, 14)

COMMON SHARED APT%(), CRD() AS LONG, SITE$(), QQ(), QR()
COMMON SHARED I, TR%(), F5%(), P9, L%(), A() AS SINGLE, C(), V1%(), V2%()
COMMON SHARED p$(), B$(), S1(), D1(), AA$(), FY%(), B%(), U$, PASS%, U6 AS SINGLE, PT%, B1(), p, B, P7()
COMMON SHARED DK%, PZ%, FT%, X3%, XX%, FB%, F AS SINGLE, PB%, NL%
COMMON SHARED A1$, B1$, C1$, D1$, E1$, F1$, G1$, H1$, J$, vg%(), vh%()
COMMON SHARED AP,U5,HT%,G9,EG%,TMT,H,T AS SINGLE,TE AS SINGLE,SX$(),SX%(),R$(),TS%,ST%,ST%()
COMMON SHARED AP%(),N,S(),ZZ(),W%(),V9(),T0(),R3()
COMMON SHARED DB$(),DT%(),D2(),OB$(),OF%(),S3(),F1(),G5(),G4(),NF%
COMMON SHARED FF$,NG1%(),YN1$(),YN$(),NG%(),VT$,W$,W1$,VT1$
COMMON SHARED Z2() AS SINGLE,W2(),W0(),Z1() AS SINGLE,Z() AS SINGLE,W3(),O%(),HO$(),HT%(),H$(),Q
COMMON SHARED W1(),Y$(),Q$(),FA%(),X,P2(),T1(),D,CTO%,XM,C1
COMMON SHARED Z5(),Z6(),RB(),X8,C7,DY,S9,D$(),JJ,G9%(),XS,CM%
COMMON SHARED TB%,TF%,N7%,TOU,TF$,N$(),N%(),PA%,HF%(),S2
COMMON SHARED DP(),D8(),X$(),C7$(),O$(),TS$(),CM$(),U5$(),LC$()
COMMON SHARED TB$(),PB$(),J,MJ,P5(),P4(),PS$(),TM%(),CZ%(),PR%(),IN,M5
COMMON SHARED F3S%,J8%,F3,BO%,V$(),V%(),NT,X0%,X1%,TP%(),LC%,FO,PB$
COMMON SHARED BU%,YN$,y2 as long,R0 AS SINGLE,CT
COMMON SHARED C$(),S$(),A1$(),ATT() AS LONG,DF(),PO$(),RS(),T2%()
COMMON SHARED E%(), Y3 AS LONG

SUB DISABLEPLAYER ()
	COLOR 15, 0
	CLS : I = P9: CALL DRAWBOX
	U$ = "DISABLE PLAYERS FOR " + B$(P9) + " (YN)"
	LOCATE , (80 - LEN(U$)) / 2
	PRINT U$
	COLOR 15, 0
	PRINT : PRINT
	PRINT "NOTE:: THE COMPUTER WILL AUTOMATICALLY DISABLE PLAYERS BASED ON"
	PRINT "       THE RATIO OF GAMES PLAYED FOR EACH PLAYER TO THE TOTAL"
	PRINT "       NUMBER OF GAMES PLAYED BY THE TEAM. YOU MAY WANT TO CHECK"
	PRINT "       TO ACTIVATE ANY COMPUTER DEACTIVATED PLAYERS"
9202 I$ = GetKeyPress$
	IF UCASE$(I$) <> "Y" THEN 9210
	DX% = 0: CLS : PRINT "TEAM ROSTER FOR "; : COLOR TR%(P9, 0), TR%(P9, 1): PRINT B$(P9): COLOR 15, 0
	PRINT "# NAME          POS   GP"
	FOR I = 0 TO 13
	IF I <= 9 THEN PRINT USING "#"; I;
	IF I = 10 THEN PRINT "A";
	IF I = 11 THEN PRINT "B";
	IF I = 12 THEN PRINT "C";
	IF I = 13 THEN PRINT "D";
	IF AA$(P9, I) = "XXX" THEN B%(P9, I, 18) = -1: COLOR TR%(P9, 0), TR%(P9, 1)
	IF B%(P9, I, 18) = 1 OR B%(P9, I, 18) = -1 THEN COLOR TR%(P9, 0), TR%(P9, 1)
	PRINT " "; AA$(P9, I); : COLOR 15, 0: PRINT TAB(18); PO$(P9, I); TAB(22); C(P9, I, 0)
	NEXT

9203 LOCATE 19, 1: PRINT "ENTER PLAYER # TO DISABLE/ENABLE (Z=FINISHED)"
	PRINT "YOU MUST HAVE AT LEAST 8 ACTIVE PLAYERS"
9205 I$ = GetKeyPress$
	IF UCASE$(I$) = "Z" THEN 9210
	I1 = VAL(I$)
	IF UCASE$(I$) = "A" THEN I1 = 10
	IF UCASE$(I$) = "B" THEN I1 = 11
	IF UCASE$(I$) = "C" THEN I1 = 12
	IF UCASE$(I$) = "D" THEN I1 = 13
	IF B%(P9, I1, 18) = 0 AND DX% < 4 THEN B%(P9, I1, 18) = -1: DX% = DX% + 1: LOCATE 3 + I1, 3: COLOR TR%(P9, 0), TR%(P9, 1): PRINT AA$(P9, I1): COLOR 15, 0: GOTO 9203
	IF B%(P9, I1, 18) = -1 THEN B%(P9, I1, 18) = 0: DX% = DX% - 1: LOCATE 3 + I1, 2: COLOR 15, 0: PRINT " "; AA$(P9, I1): GOTO 9203
	GOTO 9203

9210 END SUB


SUB DRAWBOX ()
	JJ = 1
	LOCATE 6, 8: COLOR TR%(I, 0), TR%(I, 1)
	PRINT " "; CHR$(201); STRING$(61, 205); CHR$(187); " ";
	FOR II = 1 TO JJ: LOCATE 6 + II, 8
	Print " " + Chr$(186); String$(61, 32); Chr$(186) + " "; : NEXT
	LOCATE 7 + JJ, 8
	PRINT " "; CHR$(200); STRING$(61, 205); CHR$(188); " "; : LOCATE 7
END SUB


SUB GETATEAM (I1, YN$)
OPEN p$(0) + "BASK." + YN$ FOR RANDOM AS #1 LEN = 655
FIELD #1, 15 AS Q$(0), 2 AS Q$(1), 2 AS Q$(2), 2 AS Q$(3), 2 AS Q$(4), 2 AS Q$(5), 2 AS Q$(6), 2 AS Q$(7), 2 AS Q$(8), 2 AS Q$(9), 2 AS Q$(10), 2 AS Q$(11), 2 AS Q$(12), 2 AS Q$(13), 2 AS Q$(14), 2 AS Q$(15), 2 AS Q$(16), 2 AS Q$(17), 2 AS Q$(18), 2 _
AS Q$(19), 602 AS X$
FOR I = 0 TO 13
FIELD #1, 53 + I * 43 AS X$, 15 AS Q$(I * 15 + 20), 2 AS Q$(I * 15 + 21), 2 AS Q$(I * 15 + 22), 2 AS Q$(I * 15 + 23), 2 AS Q$(I * 15 + 24), 2 AS Q$(I * 15 + 25), 2 AS Q$(I * 15 + 26), 2 AS Q$(I * 15 + 27), 2 AS Q$(I * 15 + 28), 2 AS Q$(I * 15 + 29) _
, 2 AS Q$(I * 15 + 30), 2 AS Q$(I * 15 + 31), 2 AS Q$(I * 15 + 32), 2 AS Q$(I * 15 + 33), 2 AS Q$(I * 15 + 34), 655 - 53 - 43 - I * 43 AS X$
NEXT
GET #1, I1
	B$(P9) = Q$(0)

9010 IF RIGHT$(B$(P9), 1) = " " THEN B$(P9) = LEFT$(B$(P9), LEN(B$(P9)) - 1): GOTO 9010
	S1(P9) = CVI(Q$(1)): D1(P9) = CVI(Q$(2))
	V1%(P9) = CVI(Q$(3)): V2%(P9) = CVI(Q$(4))
	FOR I3 = 0 TO 4: L%(P9, I3) = CVI(Q$(I3 + 5)): NEXT
	FOR I3 = 0 TO 9: TR%(P9, I3) = CVI(Q$(I3 + 10)): NEXT
	FOR I3 = 0 TO 13
	AA$(P9, I3) = Q$(I3 * 15 + 20)

9015 IF RIGHT$(AA$(P9, I3), 1) = " " THEN AA$(P9, I3) = LEFT$(AA$(P9, I3), LEN(AA$(P9, I3)) - 1): GOTO 9015
	FOR I4 = 0 TO 6
	A(P9, I3, I4) = CVI(Q$(I3 * 15 + I4 + 21))
	C(P9, I3, I4) = CVI(Q$(I3 * 15 + I4 + 28))
	NEXT: NEXT
CLOSE 1
	FY%(P9) = 2 * TR%(P9, 3) - TR%(P9, 4)

9016 CNT% = 0: CNTX% = 0
	IF TR%(P9, 5) = 0 THEN 9018
	FOR I = 0 TO 13
	IF B%(P9, I, 18) = -1 THEN B%(P9, I, 18) = 0
	RN = INT(RND(1) * 100) + 1
	IF UCASE$(AA$(P9, I)) = "XXX" THEN CNTX% = CNTX% + 1
	IF UCASE$(AA$(P9, I)) = "XXX" OR (B%(P9, I, 18) = 0 AND RN > INT(C(P9, I, 0) / TR%(P9, 5) * 100 + .5)) THEN B%(P9, I, 18) = -1
	NEXT
	FOR I = 0 TO 13: IF B%(P9, I, 18) = 0 THEN CNT% = CNT% + 1
	NEXT
	IF CNT% < 10 AND CNTX% < 4 THEN 9016
	IF CNTX% >= 5 AND CNT% < 8 THEN 9016

9018 REM

OPEN P$(0)+"COLBBTMS."+YN$ AS #1 LEN=566
FIELD #1,15 AS Q$(0),40 AS Q$(1),15 AS Q$(2),4 AS Q$(3)
FOR I=0 TO 13
FIELD #1,74+I*32 AS X$,2 AS Q$(I*16+4),2 AS Q$(I*16+5),2 AS Q$(I*16+6),2 AS Q$(I*16+7),2 AS Q$(I*16+8),2 AS Q$(I*16+9),2 AS Q$(I*16+10),2 AS Q$(I*16+11),2 AS Q$(I*16+12),2 AS Q$(I*16+13),2 AS Q$(I*16+14),2 AS Q$(I*16+15),2 AS Q$(I*16+16),2 AS Q$(I  _
*16+17),2 AS Q$(I*16+18),2 AS Q$(I*16+19)
FIELD #1, 522 AS X$,2 AS Q$(228),2 AS Q$(229),2 AS Q$(230),2 AS Q$(231),2 AS Q$(232),2 AS Q$(233),2 AS Q$(234),2 AS Q$(235),2 AS Q$(236),2 AS Q$(237),2 AS Q$(238),2 AS Q$(239),2 AS Q$(240),2 AS Q$(241),2 AS Q$(242),2 AS Q$(243),2 AS Q$(244),2 AS    _
Q$(245),2 AS Q$(246),2 AS Q$(247),2 AS Q$(248),2 AS Q$(249)
NEXT
GET #1, I1
	C$(P9) = Q$(0)
	S$(P9) = Q$(1)
	A1$(P9) = Q$(2)
	ATT(P9) = CVL(Q$(3))
	  FOR I=0 TO 13
	DF(P9, I) = CVI(Q$(I*16+4))
	PO$(P9, I) = Q$(I*16+5)
	FOR I1=0 TO 13
	RS(P9, I, I1) = CVI(Q$(I*16+I1+6))
	NEXT:NEXT
	FOR I = 0 TO 20
	T2%(P9, I) = CVI(Q$(228+I))
	NEXT
	CK = CVI(Q$(249))
CLOSE 1
IF CK <> 999 THEN
	C$(P9)="":S$(P9)="":A1$(P9)="":ATT(P9)=0
	FOR I = 0 TO 13:DF(P9,I) = 5:PO$(P9,I) = ""
	FOR I1 = 0 TO 13:RS(P9,I,I1)=0
	NEXT:NEXT
	FOR I=0 TO 20:T2%(P9,I)=0:NEXT
END IF
END SUB

SUB HORN ()
	FOR PP = 1 TO 70
	SOUND 50, .05
	SOUND 100, .05
	SOUND 317, .3
	NEXT PP
	FOR PZ = 1 TO 2000
	NEXT
END SUB

SUB MAKEPBP ()

1400 'PLAY BY PLAY
	IF U6 = 0 THEN 1495
	RN = INT(RND(1) * 100) + 1
	ON PT% GOTO 1410, 1420, 1430, 1440, 1445, 1450, 1460, 1470, 1480, 1490
	U$ = AA$(p, B1(p, B))

1410 'TURNOVER
	U$ = AA$(p, B1(p, B))
	IF RN > 35 AND RN <= 68 AND P7(D) > 1 AND PASS% = 1 THEN U$ = B$(p) + " CALLED FOR 10 SEC VIOLATION": GOTO 1495
	RN = INT(RND(1) * 14) + 1
	IF RN = 1 THEN U$ = U$ + " TURNS THE BALL OVER"
	IF RN = 2 THEN U$ = U$ + " THROWS IT AWAY"
	IF RN = 3 THEN U$ = U$ + " IS WHISTLED FOR TRAVELING"
	IF RN = 4 THEN U$ = U$ + " TURNS IT OVER"
	IF RN = 5 THEN U$ = U$ + " LOSES CONTROL OF THE BALL"
	IF RN = 6 THEN U$ = U$ + " LOSES IT OUT OF BOUNDS"
	IF RN = 7 THEN U$ = U$ + " LOSES THE HANDLE"
	IF RN = 8 THEN U$ = U$ + " LOSES IT"
	IF RN = 9 THEN U$ = U$ + " IS CALLED FOR STEPS"
	IF RN =10 THEN U$ = U$ + " TRAVELS"
	IF RN =11 THEN U$ = U$ + " WALKS WITH IT"
	IF RN =12 THEN U$ = U$ + " LETS IT GET AWAY"
	IF RN =13 THEN U$ = U$ + " DOUBLE DRIBBLES"
	IF RN =14 THEN U$ = U$ + " LOSES CONTROL"
	goto 1495

1420 'DUNK
	RN = INT(RND(1) * 39) + 1
	IF RN = 1 THEN U$ = "DIPSY-DOO DUNK-A-ROO!!!"
	IF RN = 2 THEN U$ = AA$(P, B1(P, B)) + " MAKES IT HAMMER TIME!!!"
	IF RN = 3 THEN U$ = AA$(P, B1(P, B)) + " SLAMS IT IN!!!"
	IF RN = 4 THEN U$ = AA$(P, B1(P, B)) + " WITH THE 2-HANDED SLAM!!!"
	IF RN = 5 THEN U$ = AA$(P, B1(P, B)) + " SLAMS IT HOME!!!"
	IF RN = 6 THEN U$ = AA$(P, B1(P, B)) + " JAMS IT HOME!!!"
	IF RN = 7 THEN U$ = AA$(P, B1(P, B)) + " THROWS IT DOWN!!!"
	IF RN = 8 THEN U$ = AA$(P, B1(P, B)) + " THUNDERSLAM!!!"
	IF RN = 9 THEN U$ = "RIM ROCKING JAM!!!"
	IF RN =10 THEN U$ = AA$(P, B1(P, B)) + " WITH THE MONSTER SLAM!!"
	IF RN =11 THEN U$ = AA$(P, B1(P, B)) + "POWER SLAMS IT!!!"
	IF RN =12 THEN U$ = AA$(P, B1(P, B)) + " WITH THE 2-HANDED STUFF!!!"
	IF RN =13 THEN U$ = AA$(P, B1(P, B)) + " BACKWARDS JAM!!!"
	IF RN =14 THEN U$ = AA$(P, B1(P, B)) + " WITH THE 1-HANDED SLAM!!!"
	IF RN =15 THEN U$ = AA$(P, B1(P, B)) + " WITH THE REVERSE SLAM!!!"
	IF RN =16 THEN U$ = AA$(P, B1(P, B)) + " WITH THE REVERSE JAM!!!"
	IF RN =17 THEN U$ = AA$(P, B1(P, B)) + " WITH THE WINDMILL JAM!!!"
	IF RN =18 THEN U$ = AA$(P, B1(P, B)) + " WITH THE WINDMILL SLAM!!!"
	IF RN =19 THEN U$ = AA$(P, B1(P, B)) + " WITH THE TOMAHAWK SLAM!!!"
	IF RN =20 THEN U$ = AA$(P, B1(P, B)) + " WITH THE 360 SLAM!!!"
	IF RN =21 THEN U$ = AA$(P, B1(P, B)) + " WITH THE SPINNING SLAM!!!"
	IF RN =22 THEN U$ = AA$(P, B1(P, B)) + " WITH THE LEFT HANDED DUNK!!!"
	IF RN =23 THEN U$ = "DOUBLE CLUTCH JAM!!!"
	IF RN =24 THEN U$ = AA$(P, B1(P, B)) + " GETS THE FLUSH!!!"
	IF RN =25 THEN U$ = AA$(P, B1(P, B)) + " PUNCHES IT HOME!!!"
	IF RN =26 THEN U$ = AA$(P, B1(P, B)) + "...DOUBLE PUMP SLAM!!!"
	IF RN =27 THEN U$ = AA$(P, B1(P, B)) + "...IN YOUR FACE SLAM!!!"
	IF RN =28 THEN U$ = AA$(p, B1(p, B)) + " IS UP": CALL PBP: U$ = "HE SPINS": CALL PBP: U$ = "BEHIND THE BACK SLAM!!!"
	IF RN =29 THEN U$ = "HE SLAMS IT HOME!!"
	IF RN =30 THEN U$ = "HE LAYS IT UP AND IN!!"
	IF RN =31 THEN U$ = "HE BANGS IT IN!!"
	IF RN =32 THEN U$ = "HE RAMS IT IN!!"
	IF RN =33 THEN U$ = "HE SLAMS IT IN!!!"
	IF RN =34 THEN U$ = "DIPSY-DOO DUNK-A-ROO!!!"
	IF RN =35 THEN U$ = "HE MAKES IT HAMMER TIME!!!"
	IF RN =36 THEN U$ = AA$(p, B1(p, B)) + " WITH THE 2-HANDED SLAM!!!"
	IF RN =37 THEN U$ = AA$(p, B1(p, B)) + " IS UP": CALL PBP: U$ = "HE SPINS": CALL PBP: U$ = "BEHIND THE BACK SLAM!!!"
	IF RN =38 THEN U$ = "HE JAMS IT HOME!!!"
	IF RN = 39 THEN U$ = "HE HAMMERS IT HOME!"
	GOTO 1495

1427 IF INT(RND(1) * 100) + 1 <= 2 THEN DK% = 1
	RETURN

1428 IF (B = 0 OR B = 1) AND INT(RND(1) * 100) + 1 <= 1 THEN DK% = 1
	IF (B = 2 OR B = 3) AND INT(RND(1) * 100) + 1 <= 5 THEN DK% = 1
	IF B = 4 AND INT(RND(1) * 100) + 1 <= 7 THEN DK% = 1
	RETURN

1430 'SHOOTS...PZ%567 SML
	U$ = AA$(p, B1(p, B))
	ON PZ% GOTO 1431, 1432, 1433, 1434, 1435, 1436, 1437, 1438, 1439, 1446

1431 'BAD
	IF RN <= 40 THEN U$ = U$ + " TAKES A TOUGH SHOT"
	IF RN > 40 AND RN <= 45 THEN U$ = U$ + " SHOOTS OFF BALANCE"
	IF RN > 45 AND RN <= 50 THEN U$ = U$ + " FORCES ONE UP"
	IF RN > 50 AND RN <= 60 THEN U$ = U$ + " SHOOTS UNDER PRESSURE"
	IF RN > 60 AND RN <= 65 THEN U$ = U$ + " WITH A BAD SHOT"
	IF RN > 65 AND RN <= 70 THEN U$ = U$ + " SHOOTS IN HEAVY TRAFFIC"
	IF RN > 70 AND RN <= 75 THEN U$ = U$ + " THROWS UP A PRAYER"
	IF RN > 75 AND RN <= 80 THEN U$ = U$ + " TAKES A BAD SHOT"
	IF RN > 80 AND RN <= 85 THEN U$ = U$ + " FORCES THE INSIDE SHOT"
	IF RN > 85 THEN U$ = U$ + " TURNS AND SHOOTS"
	GOTO 1495

1432 'INSIDE W/ASSIST
	IF RN <= 10 THEN U$ = "HE CUTS TO THE BASKET": CALL PBP: U$ = "TAKES IT UP": GOSUB 1428: GOTO 1495
	IF RN <= 20 THEN U$ = "HE TAKES IT TO THE HOLE": GOSUB 1428: GOTO 1495
	IF RN <= 30 THEN U$ = "HE TAKES IT TO THE HOOP": GOSUB 1428: GOTO 1495
	IF RN <= 40 THEN U$ = "HE LEANS IN AND SHOOTS": GOTO 1495
	IF RN <= 50 THEN U$ = "HE PUTS IT UP": GOTO 1495
	IF RN <= 60 THEN U$ = "HE TAKES IT TO THE BOARD": GOSUB 1428: GOTO 1495
	IF RN <= 70 THEN U$ = "HE PUTS IT OFF THE GLASS": GOTO 1495
	IF RN <= 80 AND B = 4 THEN U$ = "HE SHOOTS THE HOOK": GOTO 1495
	IF RN <= 80 AND B <> 4 THEN U$ = "HE GOES IN FOR THE LAYUP": GOTO 1495
	IF RN <= 90 THEN U$ = "HE TAKES IT UP STRONG": GOSUB 1428: GOTO 1495
	IF RN <= 95 THEN U$ = "HE POWERS IT UP": GOSUB 1428: GOTO 1495
	U$ = "HE LAYS IT UP": GOTO 1495

1433 'PENETRATE
	IF B = 4 AND RN <= 15 THEN U$ = "HE PUTS IT OFF THE GLASS": GOTO 1495
	IF B = 4 AND RN <= 25 THEN U$ = "HE PIVOTS TO THE BASKET": GOTO 1495
	IF B = 4 AND RN <= 40 THEN U$ = "HE POWERS IT UP": GOTO 1495
	IF B = 4 AND RN <= 58 THEN U$ = "HE TAKES IT TO THE HOOP": GOSUB 1425: GOTO 1495
	IF B = 4 AND RN <= 70 THEN U$ = "HE TAKES THE SHOT": GOTO 1495
	IF B = 4 AND RN <= 72 THEN U$ = "HE CURLS OFF A PICK IN THE PAINT": CALL PBP: U$ = "TAKES IT UP":GOSUB 1425:GOTO 1495
	IF B = 4 AND RN <= 74 THEN U$ = "HE MAKES A NICE SPIN MOVE": CALL PBP: U$ = "AND SOARS TO THE HOOP":GOSUB 1425:GOTO 1495
	IF B = 4 THEN U$ = "HE TAKES IT UP STRONG": GOSUB 1425: GOTO 1495
	IF (B =2 OR B=3) AND RN <= 16 THEN U$ = "HE TAKES IT UP": GOSUB 1426: GOTO 1495
	IF (B =2 OR B=3) AND RN <= 32 THEN U$ = "HE SPINS FREE": CALL PBP: U$ = "SHOOTS": GOSUB 1426: GOTO 1495
	IF (B =2 OR B=3) AND RN <= 48 THEN U$ = "HE GETS LOOSE IN THE PAINT": CALL PBP: U$ = "TAKES IT UP": GOSUB 1426: GOTO 1495
	IF (B =2 OR B=3) AND RN <= 64 THEN U$ = "HE PUTS IT UP": GOTO 1495
	IF (B =2 OR B=3) AND RN <= 67 THEN U$ = "HE CURLS OFF A PICK IN THE PAINT": CALL PBP: U$ = "TAKES IT UP":GOSUB 1426:GOTO 1495
	IF (B =2 OR B=3) AND RN <= 69 THEN U$ = "HE MAKES A NICE SPIN MOVE": CALL PBP: U$ = "AND SOARS TO THE HOOP":GOSUB 1426:GOTO 1495
	IF (B=2 OR B=3) AND RN <= 71 THEN U$ = "HE DRIVES THE BASELINE":CALL PBP:U$="SPINS RIGHT AND GOES UP": GOSUB 1426:GOTO 1495
	IF (B=2 OR B=3) AND RN=72 THEN U$ = "HE SLICES IN THE HOLE":CALL PBP:U$="UNDERHAND SCOOP SHOT": GOTO 1495
	IF (B=2 OR B=3) AND RN=73 THEN U$ = "STRONG CUT ALONG THE BASELINE":CALL PBP:U$="DOUBLE PUMP REVERSE LAYUP": GOTO 1495
	IF (B=2 OR B=3) AND RN = 74 THEN U$ = "HE PENETRATES":CALL PBP:U$="GORGEOUS FINGER ROLL!": GOTO 1495
	IF (B =2 OR B=3) AND RN > 80 THEN U$ = "HE SHOOTS": GOTO 1495
	IF (B =2 OR B=3) THEN U$ = "HE TAKES THE SHOT": GOTO 1495
	IF RN <= 25 THEN U$ = "HE SPINS FREE": CALL PBP: U$ = "SHOOTS": GOTO 1495
	IF RN <= 50 THEN U$ = "HE TAKES IT UP UNDER THE BASKET": GOSUB 1427: GOTO 1495
	IF RN <= 52 THEN U$ = "HE MAKES A NICE SPIN MOVE": CALL PBP: U$ = "AND SOARS TO THE HOOP":GOSUB 1427:GOTO 1495
	IF RN <= 54 THEN U$ = "HE BLOWS PAST TWO DEFENDERS": GOTO 1495
	IF RN <= 56 THEN U$ = "HE DRIVES THE BASELINE":CALL PBP:U$="SPINS RIGHT AND GOES UP": GOSUB 1427:GOTO 1495
	IF RN = 57 THEN U$ = "HE SLICES IN THE HOLE":CALL PBP:U$="UNDERHAND SCOOP SHOT": GOTO 1495
	IF RN = 58 THEN U$ = "STRONG CUT ALONG THE BASELINE":CALL PBP:U$="DOUBLE PUMP REVERSE LAYUP": GOTO 1495
	IF RN = 59 THEN U$ = "HE PENETRATES":CALL PBP:U$="GORGEOUS FINGER ROLL!": GOTO 1495
	IF RN <= 75 THEN U$ = "HE TAKES THE JUMPER": GOTO 1495
	IF RN <= 90 THEN U$ = "HE STOPS": CALL PBP: U$ = "SHOOTS": GOTO 1495
	IF RN <= 91 THEN U$ = "HE LOOKS TO PASS": CALL PBP: U$ = "NO ONE IS OPEN": CALL PBP: U$ = "HE PUTS IT UP": GOTO 1495
	U$ = "HE TAKES THE SHOT": GOTO 1495

1425 IF INT(RND(1) * 100) + 1 <= 15 THEN DK% = 1
	RETURN

1426 IF INT(RND(1) * 100) + 1 <= 7 THEN DK% = 1
	RETURN

1434 'THREE!
	IF FT% = 1 AND RN <= 50 THEN U$ = U$ + " THROWS UP A PRAYER"
	IF FT% = 1 AND RN > 50 THEN U$ = U$ + " LAUNCHES A THREE"
	IF FT% = 1 THEN FT% = 0: GOTO 1495
	IF RN <= 10 THEN U$ = U$ + " TRIES FOR THREE!"
	IF RN > 10 AND RN <= 20 THEN U$ = U$ + " SHOOTS FROM 3-POINT RANGE!"
	IF RN > 20 AND RN <= 30 THEN U$ = U$ + " HOISTS A THREE!"
	IF RN > 30 AND RN <= 40 THEN U$ = U$ + " BOMBS A THREE FROM THE CORNER!"
	IF RN > 40 AND RN <= 50 THEN U$ = U$ + " FIRES FROM THE 3-POINT LINE!"
	IF RN > 50 AND RN <= 60 THEN U$ = U$ + " SHOOTS FOR THREE!"
	IF RN > 60 AND RN <= 70 THEN U$ = U$ + " SHOOTS THE 3-POINTER!"
	IF RN > 70 AND RN <= 80 THEN U$ = U$ + " FOR 3...!"
	IF RN > 80 AND RN <= 90 THEN U$ = U$ + " PUTS UP THE TREY!"
	IF RN > 90 THEN U$ = U$ + " TAKES THE 3-POINTER!"
	GOTO 1495

1435 'SHORT JUMP
	DK% = 0
	RN  = INT(RND(1)*59) + 1
	IF RN = 1 THEN U$ = U$ + " WITH A TWISTING JUMPER"
	IF RN = 2 THEN U$ = U$ + " SHOOTS THE J"
	IF RN = 3 AND B = 4 THEN U$ = U$ + " RELEASES THE HOOK"
	IF RN = 3 AND B <> 4 THEN U$ = U$ + " TAKES THE SHOT"
	IF RN = 4 THEN U$ = U$ + " WITH A SHORT JUMPER"
	IF RN = 5 THEN U$ = U$ + " WITH THE 10 FOOTER"
	IF RN = 6 AND B<>4 THEN U$ = U$ + " WITH THE RUNNER"
	IF RN = 6 AND B=4 THEN U$ = U$ + " WITH THE RUNNING HOOK"
	IF RN = 7 AND B=4 THEN U$ = U$ + " WITH A SWEEPING HOOK"
	IF RN = 7 AND B<>4 THEN U$ = U$ + " WORKS FREE AND SHOOTS"
	IF RN = 8 AND B<>4 THEN U$ = U$ + " TAKES THE SHOT"
	IF RN = 8 AND B=4 THEN U$ = U$ + " WITH A BABY HOOK SHOT"
	IF RN = 9 THEN U$ = U$ + " LEANS IN AND SHOOTS"
	IF RN = 10 THEN U$ = U$ + " SHOOTS"
	IF RN = 11 THEN U$ = U$ + " SHOOTS FALLING AWAY"
	IF RN = 12 THEN U$ = U$ + " LEANS IN FOR THE SHOT"
	IF RN = 13 THEN U$ = U$ + " TAKES THE LEFT HANDER"
	IF RN = 14 THEN U$ = U$ + " HARD TO THE HOLE..."
	IF RN = 15 THEN U$ = U$ + " FLIPS IT UP"
	IF RN = 16 THEN U$ = U$ + " FORCES THE INSIDE SHOT"
	IF RN = 17 THEN U$ = U$ + " CUTS TO THE BASKET"
	IF RN = 18 THEN U$ = U$ + " TAKES IT IN THE PAINT"
	IF RN = 19 THEN U$ = U$ + " FLOATS IT OVER HIS MAN"
	IF RN = 20 THEN U$ = U$ + " TAKES HIS MAN INSIDE"
	IF RN = 21 THEN U$ = U$ + " WHEELS IN THE LANE"
	IF RN = 22 THEN U$ = U$ + " CUTS INSIDE FOR THE SHOT"
	IF RN = 23 THEN U$ = U$ + " PENETRATES AND SHOOTS"
	IF RN = 24 THEN U$ = U$ + " SLICES INSIDE"
	IF RN = 25 THEN U$ = U$ + " LOOKS FOR TWO"
	IF RN = 26 THEN U$ = U$ + " DRIVES INTO THE PAINT"
	IF RN = 27 THEN U$ = U$ + " HAS THE BASELINE JUMPER"
	IF RN = 28 THEN U$ = U$ + " GLIDES TO THE HOLE"
	IF RN = 29 THEN U$ = U$ + " GETS INSIDE FOR THE SHOT"
	IF RN = 30 THEN U$ = U$ + " SPINS TOWARD THE HOOP"
	IF RN = 31 THEN U$ = U$ + " FROM SHORT RANGE"
	IF RN = 32 THEN U$ = U$ + " GOES BASELINE"
	IF RN = 33 THEN U$ = U$ + " PENETRATES AND SHOOTS"
	IF RN = 34 THEN U$ = U$ + " FROM 8 FEET"
	IF RN = 35 THEN U$ = U$ + " FROM 6 FEET"
	IF RN = 36 THEN U$ = U$ + " FROM 5 FEET"
	IF RN = 37 THEN U$ = U$ + " DRIVES TO THE HOLE"
	IF RN = 38 THEN U$ = U$ + " GLIDES TO THE HOLE"
	IF RN = 39 THEN U$ = U$ + " GETS INSIDE FOR THE SHOT"
	IF RN = 40 THEN U$ = U$ + " GOES TO THE HOLE"
	IF RN = 41 THEN U$ = U$ + " CUTS INSIDE"
	IF RN = 42 THEN U$ = U$ + " SPINS INSIDE"
	IF RN = 43 THEN U$ = U$ + " BREAKS INSIDE"
	IF RN = 44 THEN U$ = U$ + " SNEAKS INSIDE"
	IF RN = 45 THEN U$ = U$ + " SCOOTS INSIDE"
	IF RN = 46 THEN U$ = U$ + " WORKS IT INSIDE"
	IF RN = 47 THEN U$ = U$ + " KNIFES INSIDE"
	IF RN = 48 THEN U$ = U$ + " SCISSORS THROUGH"
	IF RN = 49 THEN U$ = U$ + " BANGS INSIDE"
	IF RN = 50 THEN U$ = U$ + " SLICES INSIDE"
	IF RN = 51 THEN U$ = U$ + " PUMPS AND SHOOTS"
	IF RN = 52 THEN U$ = U$ + " DOUBLE PUMPS AND SHOOTS"
	IF RN = 53 THEN U$ = U$ + "...ONE HANDED FADE AWAY"
	IF RN = 54 THEN U$ = U$ + "...LEFT HANDED FADE AWAY"
	IF RN = 55 THEN U$ = U$ + "...HIGH ARCHING SHOT"
	IF RN = 56 THEN U$ = U$ + " WITH A RUNNING LEFT HANDER"
	IF RN = 57 THEN U$ = U$ + " WITH A RUNNING SCOOP SHOT"
	IF RN = 58 THEN U$ = U$ + " WITH THE SCOOP SHOT"
	IF RN = 59 THEN U$ = U$ + " WITH THE FINGER ROLL"
	  GOTO 1495

1436 DK% = 0
	RN = INT(RND(1) * 59) + 1
	IF RN = 1 THEN U$ = U$ + " POPS FROM OUTSIDE"
	IF RN = 2 THEN U$ = U$ + " DECIDES TO SHOOT IT"
	IF RN = 3 THEN U$ = U$ + " FIRES THE FADE-AWAY"
	IF RN = 4 THEN U$ = U$ + " LETS IT FLY"
	IF RN = 5 THEN U$ = U$ + " LAUNCHES ONE"
	IF RN = 6 THEN U$ = U$ + " WITH THE OUTSIDE SHOT"
	IF RN = 7 THEN U$ = U$ + " OUT OF THE CORNER"
	IF RN = 8 THEN U$ = U$ + " PUTS IT UP FROM 18"
	IF RN = 9 THEN U$ = U$ + " SPOTS UP OUTSIDE"
	IF RN = 10 THEN U$ = U$ + " RELEASES THE JUMPER"
	IF RN = 11 THEN U$ = U$ + " FROM THE TOP OF THE KEY"
	IF RN = 12 THEN U$ = U$ + " FIRES FROM THE LEFT WING"
	IF RN = 13 THEN U$ = U$ + " TRIES THE 12 FOOTER"
	IF RN = 14 THEN U$ = U$ + " PULLS UP AND POPS"
	IF RN = 15 THEN U$ = U$ + " FIRES FROM 15"
	IF RN = 16 THEN U$ = U$ + " FROM THE PERIMETER"
	IF RN = 17 THEN U$ = U$ + " TURNS AND SHOOTS"
	IF RN = 18 THEN U$ = U$ + " SHOOTS OFF THE SCREEN"
	IF RN = 19 THEN U$ = U$ + " FAKES AND SHOOTS"
	IF RN = 20 THEN U$ = U$ + " FIRES AWAY"
	IF RN = 21 THEN U$ = U$ + " POPS FROM THE BASELINE"
	IF RN = 22 THEN U$ = U$ + " DRIVES THE LANE"
	IF RN = 23 THEN U$ = U$ + " TAKES THE SHOT"
	IF RN = 24 THEN U$ = U$ + " WORKS FREE AND FIRES"
	IF RN = 25 THEN U$ = U$ + " SHOOTS OVER HIS MAN"
	IF RN = 26 THEN U$ = U$ + " SHOOTS FALLING AWAY"
	IF RN = 27 THEN U$ = U$ + " FAKES AND SHOOTS"
	IF RN = 28 THEN U$ = U$ + " FIRES AWAY"
	IF RN = 29 THEN U$ = U$ + " POPS FROM THE BASELINE"
	IF RN = 30 THEN U$ = U$ + " DRIVES THE LANE"
	IF RN = 31 THEN U$ = U$ + " TAKES THE SHOT"
	IF RN = 32 THEN U$ = U$ + " WORKS FREE AND FIRES"
	IF RN = 33 THEN U$ = U$ + " SHOOTS FROM 15"
	IF RN = 34 THEN U$ = U$ + " SHOOTS"
	IF RN = 35 THEN U$ = U$ + " TAKES THE JUMPER"
	IF RN = 36 THEN U$ = U$ + " FROM THE RIGHT CORNER"
	IF RN = 37 THEN U$ = U$ + " FROM THE LEFT CORNER"
	IF RN = 38 THEN U$ = U$ + " FROM THE KEY"
	IF RN = 39 THEN U$ = U$ + " FIRES FROM OUTSIDE"
	IF RN = 40 THEN U$ = U$ + " PUTS IT UP FROM 16"
	IF RN = 41 THEN U$ = U$ + " FROM THE PERIMETER"
	IF RN = 42 THEN U$ = U$ + " FAKES AND SHOOTS"
	IF RN = 43 THEN U$ = U$ + " FROM AROUND 16 FEET"
	IF RN = 44 THEN U$ = U$ + " PUTS IT UP"
	IF RN = 45 THEN U$ = U$ + " WITH A RUNNING ONE-HANDER"
	IF RN = 46 THEN U$ = U$ + " PULLS UP"
	IF RN = 47 THEN U$ = U$ + " KISSES THE GLASS"
	IF RN = 48 THEN U$ = U$ + " SPINS AND SHOOTS"
	IF RN = 49 THEN U$ = U$ + " PUTS IT UP FROM 16"
	IF RN = 50 THEN U$ = U$ + " WITH A LONG JUMPER"
	IF RN = 51 THEN U$ = U$ + " PUMPS AND SHOOTS"
	IF RN = 52 THEN U$ = U$ + " DOUBLE PUMPS AND SHOOTS"
	IF RN = 53 THEN U$ = U$ + "...ONE HANDED FADE AWAY"
	IF RN = 54 THEN U$ = U$ + "...LEFT HANDED FADE AWAY"
	IF RN = 55 THEN U$ = U$ + "...HIGH ARCHING SHOT"
	IF RN = 56 THEN U$ = U$ + " WITH A RUNNING LEFT HANDER"
	IF RN = 57 THEN U$ = U$ + " WITH A RUNNING SCOOP SHOT"
	IF RN = 58 THEN U$ = U$ + " WITH THE SCOOP SHOT"
	IF RN = 59 THEN U$ = U$ + " WITH THE FINGER ROLL"
	  GOTO 1495

1437 DK% = 0
	IF RN <= 10 THEN U$ = U$ + " FIRES FROM THE PERIMETER": GOTO 1495
	IF RN <= 20 THEN U$ = U$ + " SHOOTS FROM 17": GOTO 1495
	IF RN <= 30 THEN U$ = U$ + " PUTS IT UP FROM 17": GOTO 1495
	IF RN <= 40 THEN U$ = U$ + " PUTS IT UP": GOTO 1495
	IF RN <= 45 THEN U$ = U$ + " FROM INSIDE THE THE KEY": GOTO 1495
	IF RN <= 50 THEN U$ = U$ + " FIRES FROM THE CORNER": GOTO 1495
	IF RN <= 60 THEN U$ = U$ + " SHOOTS FROM OUTSIDE": GOTO 1495
	IF RN <= 70 THEN U$ = U$ + " PUMPS AND SHOOTS": GOTO 1495
	IF RN <= 80 THEN U$ = U$ + " FIRES THE FADE-AWAY": GOTO 1495
	IF RN <= 90 AND X3% = 1 THEN U$ = U$ + " FROM INSIDE THE 3-POINT LINE": GOTO 1495
	IF RN <= 91 AND X3% = 1 THEN U$ = U$ + " FOR THREE!": CALL PBP: U$ = "NO!": CALL PBP: U$ = "HIS FOOT IS ON THE 3-POINT LINE": GOTO 1495
	U$ = U$ + " SHOOTS FROM THE WING"
	GOTO 1495

1438 IF RN <= 20 THEN U$ = "HE SAILS TO THE HOOP": GOTO 1495
	IF RN <= 23 THEN U$ = "HE TAKES IT TO THE BUCKET":GOTO 1495
	IF RN <= 26 THEN U$ = "HE TAKES IT TO THE HOLE":GOTO 1495
	IF RN <= 29 THEN U$ = "HE SLASHES TO THE HOLE":GOTO 1495
	IF RN <= 32 THEN U$ = "HE SLASHES TO THE BUCKET":GOTO 1495
	IF RN <= 35 THEN U$ = "HE SOARS TO THE BUCKET":GOTO 1495
	IF RN <= 38 THEN U$ = "HE SOARS TO THE HOLE":GOTO 1495
	IF RN <= 40 THEN U$ = "HE GLIDES TO THE HOLE": GOTO 1495
	IF RN <= 60 THEN U$ = "HE GOES IN STRONG": GOTO 1495
	IF RN <= 80 THEN U$ = "HE TAKES IT IN": GOTO 1495
	IF RN <= 90 THEN U$ = "HE TAKES A DEFENDER WITH HIM": GOTO 1495
	U$ = "HE GOES UP WITH IT": GOTO 1495

1439 'BACK AFTER REB
	U$ = "HE "
	RN = INT(RND(1) *11 )  +1
	IF RN = 1 THEN U$ = U$ + "TAKES IT BACK UP"
	IF RN = 2 THEN U$ = U$ + "GOES BACK UP WITH IT"
	IF RN = 3 THEN U$ = U$ + "POWERS HIS WAY UP WITH IT"
	IF RN = 4 THEN U$ = U$ + "GOES STRONG TO THE BASKET"
	IF RN = 5 THEN U$ = U$ + "MUSCLES IT UP"
	IF RN = 6 THEN U$ = U$ + "SHOOTS"
	IF RN = 7 THEN U$ = U$ + "TAKES IT TO THE GOAL"
	IF RN = 8 THEN U$ = U$ + "PUTS IT UP AGAIN"
	IF RN = 9 THEN U$ = U$ + "SHOOTS IT AGAIN"
	IF RN =10 THEN U$ = U$ + "CLAWS HIS WAY UP"
	IF RN =11 THEN U$ = U$ + "SHOOTS IN TRAFFIC"
	  IF B = 2 OR B = 3 AND INT(RND(1) * 100) + 1 <= 7 THEN DK% = 1
	IF B = 4 AND INT(RND(1) * 100) + 1 <= 15 THEN DK% = 1
	GOTO 1495

1446 RN = INT(RND(1) * 100) + 1
	DK% = 0
	IF RN <= 20 THEN U$ = U$ + " SHOOTS FROM 15": GOTO 1495
	IF RN <= 40 THEN U$ = U$ + " SHOOTS": GOTO 1495
	IF RN <= 60 THEN U$ = U$ + " TAKES THE JUMPER": GOTO 1495
	IF RN <= 80 THEN U$ = U$ + " PUTS IT UP FROM 16": GOTO 1495
	U$ = U$ + " FAKES AND SHOOTS": GOTO 1495

1440 'THREE GOOD
	U$ = "HE "
	IF RN <= 6 THEN U$ = U$ + " DRAINS THE THREE!": CALL PBP: U$ = "NO!": CALL PBP: U$ = "HIS FOOT IS ON THE 3-POINT LINE": XX% = 1: GOTO 1495
	IF RN <= 10 THEN U$ = U$ + "FILLS UP THE BASKET!!!": GOTO 1495
	IF RN <= 20 THEN U$ = U$ + "HITS THE TREY!!!": GOTO 1495
	IF RN <= 30 THEN U$ = "IT'S GOOOODD!!": GOTO 1495
	IF RN <= 40 THEN U$ = U$ + "GETS IT!!!": GOTO 1495
	IF RN <= 45 THEN U$ = "NOTHING BUT THE BOTTOM OF THE NET": GOTO 1495
	IF RN <= 50 THEN U$ = "COUNT IT!!": GOTO 1495
	IF RN <= 55 THEN U$ = "WAY DOWNTOWN BANG!!!": GOTO 1495
	IF RN <= 60 THEN U$ = U$ + "RINGS IT UP!!!": GOTO 1495
	IF RN <= 80 THEN U$ = U$ + "DRAINS IT!!!": GOTO 1495
	IF RN <= 90 THEN U$ = "HE BURIES IT!!!": GOTO 1495
	U$ = "IT'S ALL NET!!!"
	GOTO 1495

1445 'THREE BAD
	U$ = "HE "
	IF RN <= 20 THEN U$ = U$ + "GETS NONE": GOTO 1495
	IF RN <= 25 THEN U$ = "IT NEVER HAD A CHANCE": GOTO 1495
	IF RN <= 35 THEN U$ = "AIRRRR BALLLL!!": GOTO 1495
	IF RN <= 40 THEN U$ = U$ + "MISFIRES": GOTO 1495
	IF RN <= 60 THEN U$ = "IT'S OFF THE RIM...NO GOOD!": GOTO 1495
	IF RN <= 80 THEN U$ = "IT'S SHORT": GOTO 1495
	U$ = U$ + "MISSES": GOTO 1495

1450 'FAST BREAK
	U$ = AA$(P, B1(P, B))
	RN = INT(RND(1)* 38) + 1
	IF RN = 1 THEN U$ = U$ + " HAS IT ON THE FAST BREAK!"
	IF RN = 2 THEN U$ = U$ + " IS IN TRANSITION!"
	IF RN = 3 THEN U$ = U$ + " STARTS THE BREAK!"
	IF RN = 4 THEN U$ = U$ + " IS DOWN COURT IN A HURRY!"
	IF RN = 5 THEN U$ = U$ + " IS ON THE RUN!"
	IF RN = 6 THEN U$ = U$ + " GOES COAST TO COAST!"
	IF RN = 7 THEN U$ = U$ + " ON THE BREAK!"
	IF RN = 8 THEN U$ = U$ + " ON THE RUN!"
	IF RN = 9 THEN U$ = U$ + " ON THE FAST BREAK!"
	IF RN =10 THEN U$ = U$ + " HAS THE FAST BREAK!"
	IF RN =11 THEN U$ = U$ + " BREAKS INTO THE FORECOURT!"
	IF RN =12 THEN U$ = U$ + " FLIES UPCOURT!"
	IF RN =13 THEN U$ = U$ + " STARTS THE FASTBREAK!"
	IF RN =14 THEN U$ = U$ + " ON THE MOVE!"
	IF RN =15 THEN U$ = U$ + " IN TRANSITION!"
	IF RN =16 THEN U$ = U$ + " DOWN COURT IN A HURRY!"
	IF RN =17 THEN U$ = U$ + " CHARGES ACROSS THE LINE!"
	IF RN =18 THEN U$ = U$ + " BREAKS QUICKLY!"
	IF RN =19 THEN U$ = U$ + " BREAKS DOWN COURT!"
	IF RN =20 THEN U$ = U$ + " STARTS THE RUNNING GAME!"
	IF RN =21 THEN U$ = U$ + " FLIES DOWN THE FLOOR!"
	IF RN =22 THEN U$ = U$ + " GOES RIGHT TO WORK!"
	IF RN =23 THEN U$ = U$ + " BACK THE OTHER WAY!"
	IF RN =24 THEN U$ = U$ + " QUICKLY UP THE FLOOR!"
	IF RN =25 THEN U$ = U$ + " PUSHES IT UP COURT!"
	IF RN =26 THEN U$ = U$ + " WASTES NO TIME!"
	IF RN =27 THEN U$ = U$ + " UPS THE TEMPO!"
	IF RN =28 THEN U$ = U$ + " HUSTLES DOWN COURT!"
	IF RN =29 THEN U$ = U$ + " RUSHES UP THE FLOOR!"
	IF RN =30 THEN U$ = U$ + " ON THE MOVE!"
	IF RN =31 THEN U$ = U$ + " STREAKS UP THE COURT!"
	IF RN =32 THEN U$ = U$ + " FLIES DOWN THE COURT!"
	IF RN =33 THEN U$ = U$ + " JETS DOWN COURT!"
	IF RN =34 THEN U$ = U$ + " QUICKLY GETS IT UP COURT!"
	IF RN =35 THEN U$ = U$ + " TAKES IT COAST TO COAST!"
	IF RN =36 THEN U$ = U$ + " IS RUNNING AND GUNNING!"
	IF RN =37 THEN U$ = U$ + " FLIES OVER THE TIME LINE!"
	IF RN =38 THEN U$ = U$ + " RUSHES IT UP THE FLOOR!"
	CALL SHOTSTRING
	GOTO 1495

1460 'FAST BREAK SCORE
	FB% = 0
	RN = INT(RND(1) * 39) + 1
	IF RN = 1 THEN U$ = "DIPSY-DOO DUNK-A-ROO!!!"
	IF RN = 2 THEN U$ = AA$(P, B1(P, B)) + " MAKES IT HAMMER TIME!!!"
	IF RN = 3 THEN U$ = AA$(P, B1(P, B)) + " SLAMS IT IN!!!"
	IF RN = 4 THEN U$ = AA$(P, B1(P, B)) + " WITH THE 2-HANDED SLAM!!!"
	IF RN = 5 THEN U$ = AA$(P, B1(P, B)) + " SLAMS IT HOME!!!"
	IF RN = 6 THEN U$ = AA$(P, B1(P, B)) + " JAMS IT HOME!!!"
	IF RN = 7 THEN U$ = AA$(P, B1(P, B)) + " THROWS IT DOWN!!!"
	IF RN = 8 THEN U$ = AA$(P, B1(P, B)) + " THUNDERSLAM!!!"
	IF RN = 9 THEN U$ = "RIM ROCKING JAM!!!"
	IF RN =10 THEN U$ = AA$(P, B1(P, B)) + " WITH THE MONSTER SLAM!!"
	IF RN =11 THEN U$ = AA$(P, B1(P, B)) + "POWER SLAMS IT!!!"
	IF RN =12 THEN U$ = AA$(P, B1(P, B)) + " WITH THE 2-HANDED STUFF!!!"
	IF RN =13 THEN U$ = AA$(P, B1(P, B)) + " BACKWARDS JAM!!!"
	IF RN =14 THEN U$ = AA$(P, B1(P, B)) + " WITH THE 1-HANDED SLAM!!!"
	IF RN =15 THEN U$ = AA$(P, B1(P, B)) + " WITH THE REVERSE SLAM!!!"
	IF RN =16 THEN U$ = AA$(P, B1(P, B)) + " WITH THE REVERSE JAM!!!"
	IF RN =17 THEN U$ = AA$(P, B1(P, B)) + " WITH THE WINDMILL JAM!!!"
	IF RN =18 THEN U$ = AA$(P, B1(P, B)) + " WITH THE WINDMILL SLAM!!!"
	IF RN =19 THEN U$ = AA$(P, B1(P, B)) + " WITH THE TOMAHAWK SLAM!!!"
	IF RN =20 THEN U$ = AA$(P, B1(P, B)) + " WITH THE 360 SLAM!!!"
	IF RN =21 THEN U$ = AA$(P, B1(P, B)) + " WITH THE SPINNING SLAM!!!"
	IF RN =22 THEN U$ = AA$(P, B1(P, B)) + " WITH THE LEFT HANDED DUNK!!!"
	IF RN =23 THEN U$ = "DOUBLE CLUTCH JAM!!!"
	IF RN =24 THEN U$ = AA$(P, B1(P, B)) + " GETS THE FLUSH!!!"
	IF RN =25 THEN U$ = AA$(P, B1(P, B)) + " PUNCHES IT HOME!!!"
	IF RN =26 THEN U$ = AA$(P, B1(P, B)) + "...DOUBLE PUMP SLAM!!!"
	IF RN =27 THEN U$ = AA$(P, B1(P, B)) + "...IN YOUR FACE SLAM!!!"
	IF RN =28 THEN U$ = AA$(p, B1(p, B)) + " IS UP": CALL PBP: U$ = "HE SPINS": CALL PBP: U$ = "BEHIND THE BACK SLAM!!!"
	IF RN =29 THEN U$ = "HE SLAMS IT HOME!!"
	IF RN =30 THEN U$ = "HE LAYS IT UP AND IN!!"
	IF RN =31 THEN U$ = "HE BANGS IT IN!!"
	IF RN =32 THEN U$ = "HE RAMS IT IN!!"
	IF RN =33 THEN U$ = "HE SLAMS IT IN!!!"
	IF RN =34 THEN U$ = "DIPSY-DOO DUNK-A-ROO!!!"
	IF RN =35 THEN U$ = "HE MAKES IT HAMMER TIME!!!"
	IF RN =36 THEN U$ = AA$(p, B1(p, B)) + " WITH THE 2-HANDED SLAM!!!"
	IF RN =37 THEN U$ = AA$(p, B1(p, B)) + " IS UP": CALL PBP: U$ = "HE SPINS": CALL PBP: U$ = "BEHIND THE BACK SLAM!!!"
	IF RN =38 THEN U$ = "HE JAMS IT HOME!!!"
	IF RN = 39 THEN U$ = "HE HAMMERS IT HOME!"
	GOTO 1495

1470 'MISS
	IF PZ% = 8 THEN PZ% = 0: FB% = 0: GOTO 1475
	RN = INT(RND(1) * 50) + 1
	IF RN = 1 THEN U$ = "IT RATTLES IN AND OUT...NO GOOD"
	IF RN = 2 THEN U$ = "OFF THE IRON"
	IF RN = 3 THEN U$ = "IT SPINS IN AND OUT"
	IF RN = 4 THEN U$ = "IT'S OFF THE GLASS"
	IF RN = 5 THEN U$ = "IT'S NO GOOD"
	IF RN = 6 THEN U$ = "IT'S OFF THE MARK"
	IF RN = 7 THEN U$ = "IT'S A BRICK"
	IF RN = 8 THEN U$ = "OFF THE RIM"
	IF RN = 9 THEN U$ = "NOT EVEN CLOSE!"
	IF RN =10 THEN U$ = "NO GOOD"
	IF RN =11 THEN U$ = "HE MISSES"
	IF RN =12 THEN U$ = "DOESN'T GET THE ROLL"
	IF RN =13 THEN U$ = "OFF THE GLASS"
	IF RN =14 THEN U$ = "FALLS SHORT"
	IF RN =15 THEN U$ = "NO GOOD"
	IF RN =16 THEN U$ = "NO"
	IF RN =17 THEN U$ = "HE MISSES"
	IF RN =18 THEN U$ = "IN AND OUT"
	IF RN =19 THEN U$ = "OFF THE RIM"
	IF RN =20 THEN U$ = "OFF THE IRON"
	IF RN =21 THEN U$ = "IT'S NOT THERE"
	IF RN =22 THEN U$ = "OFF TARGET"
	IF RN =23 THEN U$ = "IT RATTLES OUT"
	IF RN =24 THEN U$ = "IT DOESN'T FALL"
	IF RN =25 THEN U$ = "IT BOUNCES OFF"
	IF RN =26 THEN U$ = "IT ROLLS OFF"
	IF RN =27 THEN U$ = "SHORT"
	IF RN =28 THEN U$ = "IT DOESN'T GO DOWN"
	IF RN =29 THEN U$ = "IT'S NO GOOD"
	IF RN =30 THEN U$ = "NO GOOD"
	IF RN =31 THEN U$ = "HE MISSES"
	IF RN =32 THEN U$ = "IT'S A BRICK"
	IF RN =33 THEN U$ = "HE FAILS TO CONNECT"
	IF RN =34 THEN U$ = "OFF THE SIDE OF THE RIM"
	IF RN =35 THEN U$ = "IT COMES UP SHORT"
	IF RN =36 THEN U$ = "IT ROLLS OUT"
	IF RN =37 THEN U$ = "AROUND AND OUT"
	IF RN =38 THEN U$ = "OFF THE BACK OF THE IRON"
	IF RN =39 THEN U$ = "ON THE FRONT RIM...ROLLS OFF"
	IF RN =40 THEN U$ = "IN THE AIR...NO GOOD"
	IF RN =41 THEN U$ = "TOO SHORT"
	IF RN =42 THEN U$ = "NO GOOD"
	IF RN =43 THEN U$ = "IT COMES UP SHORT"
	IF RN =44 THEN U$ = "IT ROLLS OUT"
	IF RN =45 THEN U$ = "IN AND OUT"
	IF RN =46 THEN U$ = "OFF THE FRONT OF THE IRON"
	IF RN =47 THEN U$ = "ON THE RIM...ROLLS OFF"
	IF RN =48 THEN U$ = "OFF THE FRONT OF THE RIM"
	IF RN =49 THEN U$ = "TOO SHORT"
	IF RN =50 THEN U$ = "TOO STRONG"
	  GOTO 1495

1475 U$ = "HE "
	IF RN <= 20 THEN U$ = U$ + "MISSES THE EASY BASKET!": GOTO 1495
	IF RN <= 40 THEN U$ = U$ + "JAMS IT TOO HARD!!": GOTO 1495
	IF RN <= 60 THEN U$ = U$ + "SLAMS IT OFF THE IRON...NO GOOD!": GOTO 1495
	IF RN <= 80 THEN U$ = U$ + "CAN'T GET IT DOWN!": GOTO 1495
	U$ = U$ + "BLOWS THE EASY BASKET!!": GOTO 1495

1480 'NOPASS
	U$ = AA$(P, B1(P, B)) + " "
	RN = INT(RND(1)* 56) + 1
	  IF RN = 1 THEN U$ = U$ + "LOOKS INSIDE"
	IF RN = 2 THEN U$ = U$ + "TRIES TO WORK FREE"
	IF RN = 3 THEN U$ = U$ + "SETS UP THE PLAY"
	IF RN = 4 THEN U$ = U$ + "LOOKS FOR AN OPENING"
	IF RN = 5 THEN U$ = U$ + "DRIBBLES AROUND HIS MAN"
	IF RN = 6 THEN U$ = U$ + "SIGNALS THE PLAY"
	IF RN = 7 THEN U$ = U$ + "IS IN CONTROL"
	IF RN = 8 THEN U$ = U$ + "IS IN POSSESSION"
	IF RN = 9 THEN U$ = U$ + "TRIES TO GET OPEN"
	IF RN = 10 THEN U$ = U$ + "YO-YO'S OUT TOP"
	IF RN = 11 THEN U$ = U$ + "GOES TO WORK
	IF RN = 12 THEN U$ = U$ + "WORKS OFF THE PICK"
	IF RN = 13 THEN U$ = U$ + "ON THE DRIBBLE"
	IF RN = 14 THEN U$ = U$ + "CUTS TO THE LEFT"
	IF RN = 15 THEN U$ = U$ + "CUTS TO THE RIGHT"
	IF RN = 16 THEN U$ = U$ + "WHEELS AND DEALS"
	IF RN = 17 THEN U$ = U$ + "SETS UP ON TOP"
	IF RN = 18 THEN U$ = U$ + "SLIDES RIGHT"
	IF RN = 19 THEN U$ = U$ + "SLIDES LEFT"
	IF RN = 20 THEN U$ = U$ + "GOES TO WORK"
	IF RN = 21 THEN U$ = U$ + "MOVES IT LEFT-SIDE"
	IF RN = 22 THEN U$ = U$ + "MOVES IT RIGHT-SIDE"
	IF RN = 23 THEN U$ = U$ + "REVERSES THE DRIBBLE"
	IF RN = 24 THEN U$ = U$ + "TRIES TO GET OPEN"
	IF RN = 25 THEN U$ = U$ + "DRIBBLES TO THE MIDDLE"
	IF RN = 26 THEN U$ = U$ + "FAKES THE PASS"
	IF RN = 27 THEN U$ = U$ + "SETS UP ON TOP"
	IF RN = 28 THEN U$ = U$ + "SLIDES RIGHT"
	IF RN = 29 THEN U$ = U$ + "SLIDES LEFT"
	IF RN = 30 THEN U$ = U$ + "DRIBBLES IT BEHIND THE BACK"
	IF RN = 31 THEN U$ = U$ + "FAKES LEFT...GOES RIGHT"
	IF RN = 32 THEN U$ = U$ + "FAKES RIGHT...GOES LEFT"
	IF RN = 33 THEN U$ = U$ + "SPINS HARD TO THE LEFT"
	IF RN = 34 THEN U$ = U$ + "SPINS HARD TO THE RIGHT"
	IF RN = 35 THEN U$ = U$ + "LEANS LEFT...GOES RIGHT"
	IF RN = 36 THEN U$ = U$ + "LEANS RIGHT...GOES LEFT"
	IF RN = 37 THEN U$ = U$ + "LEANS LEFT...CUTS RIGHT"
	IF RN = 38 THEN U$ = U$ + "LEANS RIGHT...CUTS LEFT"
	IF RN = 39 THEN U$ = U$ + "DOUBLE REVERSES HIS DRIBBLE"
	IF RN = 40 THEN U$ = U$ + "BACKS IN"
	IF RN = 41 THEN U$ = U$ + "LEANS FORWARD"
	IF RN = 42 THEN U$ = U$ + "CROSSES OVER...SPINS"
	IF RN = 43 THEN U$ = U$ + "CUTS LEFT"
	IF RN = 44 THEN U$ = U$ + "CUTS RIGHT"
	IF RN = 45 THEN U$ = U$ + "WITH THE HESITATION DRIBBLE":CALL PBP:U$="HE SPINS LEFT"
	IF RN = 46 THEN U$ = U$ + "WITH THE HESITATION DRIBBLE":CALL PBP:U$="HE SPINS RIGHT"
	IF RN = 47 THEN U$ = U$ + "WITH THE HESITATION DRIBBLE":CALL PBP:U$="HE CUTS LEFT"
	IF RN = 48 THEN U$ = U$ + "WITH THE HESITATION DRIBBLE":CALL PBP:U$="HE CUTS RIGHT"
	IF RN = 49 THEN U$ = U$ + "STUTTER STEPS":CALL PBP:U$="HE MOVES LEFT"
	IF RN = 50 THEN U$ = U$ + "MAINTAINS HIS DRIBBLE"
	IF RN = 51 THEN U$ = U$ + "FAKE SPINS LEFT...GOES RIGHT"
	IF RN = 52 THEN U$ = U$ + "FAKE SPINS RIGHT...GOES LEFT"
	IF RN = 53 THEN U$ = U$ + "PALMS THE BALL":CALL PBP:U$="HE TAKES IT AND SPINS"
	IF RN = 54 THEN U$ = U$ + "SHAKES AND BAKES"
	IF RN = 55 THEN U$ = U$ + "DRIBBLES WITH THE LEFT HAND"
	IF RN = 56 THEN U$ = U$ + "DRIBBLES WITH THE RIGHT HAND"
	GOTO 1495

1490 'PASS PB$=PREV HANDLER
	V$ = AA$(P, B1(P, B))
	RN = INT(RND(1)*60) + 1
	IF RN = 1 THEN U$ = PB$ + " TO " + V$
	IF RN = 2 THEN U$ = PB$ + " KICKS IT OUT": CALL PBP: U$ = V$ + " TAKES THE PASS"
	IF RN = 3 THEN U$ = PB$ + " FEEDS " + V$
	IF RN = 4 THEN U$ = PB$ + " PASSES TO " + V$
	IF RN = 4 THEN U$ = PB$ + " DISHES TO " + V$
	IF RN = 5 THEN U$ = PB$ + " GIVES IT TO " + V$
	IF RN = 6 THEN U$ = PB$ + " WITH A NICE GIVE TO " + V$
	IF RN = 7 THEN U$ = PB$ + " LOOKS": CALL PBP: U$ = "HE GETS IT TO " + V$
	IF RN = 8 THEN U$ = PB$ + " SENDS IT TO " + V$
	IF RN = 9 THEN U$ = PB$ + " TO " + V$
	IF RN =10 THEN U$ = PB$ + " GETS IT TO " + V$
	IF RN =11 THEN U$ = PB$ + " OVER TO " + V$
	IF RN =12 THEN U$ = PB$ + " ZIPS IT TO "+ V$
	IF RN =13 THEN U$ = PB$ + " FINDS " + V$
	IF RN =14 THEN U$ = PB$ + " LOOKS FOR " + V$
	IF RN =14 THEN U$ = PB$ + " THROWS IT TO " + V$
	IF RN =15 THEN U$ = PB$ + " GOES TO " + V$
	IF RN =16 THEN U$ = PB$ + " SETS UP " + V$
	IF RN =17 THEN U$ = PB$ + " OUT TO " + V$
	IF RN =18 THEN U$ = PB$ + " FLIPS IT TO " + V$
	IF RN = 19 THEN U$ = "BOUNCE PASS TO " + V$
	IF RN =20 THEN U$ = PB$ + " LEAVES IT FOR " + V$
	IF RN = 21 THEN U$ = PB$ + " LOOPS IT TO " + V$
	IF RN =22 THEN U$ = PB$ + " SHOVELS IT OVER TO " + V$
	IF RN = 23 THEN U$ = PB$ + " GIVES IT BACK TO " + V$
	IF RN =24 THEN U$ = PB$ + " FEEDS IT TO " + V$
	IF RN = 25 THEN U$ = PB$ + " GIVES IT OFF TO " + V$
	IF RN =26 THEN U$ = "PASSES TO " + V$
	IF RN = 27 THEN U$ = "DISHES TO " + V$
	IF RN =28 THEN U$ = "GIVES TO " + V$
	IF RN = 29 THEN U$ = "OVER TO " + V$
	IF RN =30 THEN U$ = "SENDS IT BACK TO " + V$
	IF RN=31 THEN U$="NO-LOOK PASS TO "+V$
	IF RN=32 THEN U$="NO-LOOK BOUNCE PASS TO " + V$
	IF RN=33 THEN U$="BEHIND THE BACK TO " + V$
	IF RN=34 THEN U$=PB$+" SWINGS IT TO "+V$
	IF RN=35 THEN U$=PB$+" FIRES A PASS TO " + V$
	IF RN=36 THEN U$=PB$+" SNAPS A PASS TO " + V$
	IF RN=37 THEN U$=PB$+" SWINGS A PASS TO "+V$
	IF RN=38 THEN U$="TWO-HANDED PASS TO " + V$
	IF RN=39 THEN U$="WRAP AROUND PASS TO " + V$
	IF RN=40 THEN U$="OVER THE SHOULDER PASS TO "+V$
	IF RN=41 THEN U$="BACKHAND PASS TO " + V$
	IF RN=42 THEN U$="BACKHAND DISH TO " + V$
	IF RN=43 THEN U$="PASS CONNECTED TO "+V$
	IF RN=44 THEN U$=PB$+" WIRES IT TO "+V$
	IF RN=45 THEN U$=PB$+" WIRES A PASS TO " + V$
	IF RN=46 THEN U$=PB$+" SNAPS A PASS TO " + V$
	IF RN=47 THEN U$=PB$+" FAKES..PASSES TO "+V$
	IF RN=48 THEN U$=PB$+" SHUFFLES IT TO " + V$
	IF RN=49 THEN U$=PB$+" SLINGS IT TO " + V$
	IF RN=50 THEN U$=PB$+" FLIPS IT TO "+V$
	IF RN=51 THEN U$=PB$+" WHIPS IT OVER TO " + V$
	IF RN=52 THEN U$=PB$+" SLINGS A BOUNCE PASS TO " + V$
	IF RN=53 THEN U$=PB$+" SHOVELS IT TO "+V$
	IF RN=54 THEN U$=PB$+" PUMP FAKES A SHOT":CALL PBP:U$="HE SWINGS IT TO "+V$
	IF RN=55 THEN U$=PB$+" PUMP FAKES A SHOT":CALL PBP:U$="HE BOUNCES IT TO " + V$
	IF RN=56 THEN U$=PB$+" WITH A FOOT FAKE":CALL PBP:U$="HE SPINS AND DUMPS IT TO " + V$
	IF RN=57 THEN U$=PB$+" CUTS ACROSS THE LANE":CALL PBP:U$="HE DISHES INSIDE TO "+V$
	IF RN=58 THEN U$=PB$+" DRIVES THE BASELINE":CALL PBP:U$="DISHES UNDERNEATH TO " + V$
	IF RN=59 THEN U$=PB$+" FAKES RIGHT...CUTS LEFT":CALL PBP:U$="SHUFFLES IT TO " + V$
	IF RN=60 THEN U$=PB$+" HEAD FAKES":CALL PBP:U$="HE PUSHES IT TO "+V$

1495 END SUB
	

SUB PBP ()
	I$=GetKeyPress$
	IF UCASE$(I$) = "Q" THEN END

2245 IF U6 = 0 OR PB% = 1 THEN 2247
	WHILE LEN(U$)<38
		U$=U$+" "
	WEND
	U$=LEFT$(U$,38)
	LOCATE 8, 1
	IF NL% = 1 THEN A1$ = U$: vg%(1) = TR%(p, 0): vh%(1) = TR%(p, 1)
	IF NL% = 2 THEN B1$ = U$: vg%(2) = TR%(p, 0): vh%(2) = TR%(p, 1)
	IF NL% = 3 THEN C1$ = U$: vg%(3) = TR%(p, 0): vh%(3) = TR%(p, 1)
	IF NL% = 4 THEN D1$ = U$: vg%(4) = TR%(p, 0): vh%(4) = TR%(p, 1)
	IF NL% = 5 THEN E1$ = U$: vg%(5) = TR%(p, 0): vh%(5) = TR%(p, 1)
	IF NL% = 6 THEN F1$ = U$: vg%(6) = TR%(p, 0): vh%(6) = TR%(p, 1)
	IF NL% = 7 THEN G1$ = U$: vg%(7) = TR%(p, 0): vh%(7) = TR%(p, 1)
	IF NL% = 8 THEN H1$ = U$: vg%(8) = TR%(p, 0): vh%(8) = TR%(p, 1)
	IF NL% > 8 THEN
		A1$ = B1$
		B1$ = C1$
		C1$ = D1$
		D1$ = E1$
		E1$ = F1$
		F1$ = G1$
		G1$ = H1$
		H1$ = U$
		FOR I = 1 TO 7
	vg%(I) = vg%(I + 1)
	vh%(I) = vh%(I + 1)
		NEXT
		vg%(8) = TR%(p, 0)
		vh%(8) = TR%(p, 1)
	END IF
	  NL% = NL% + 1
	COLOR vg%(1), vh%(1): PRINT A1$
	COLOR vg%(2), vh%(2): PRINT B1$
	COLOR vg%(3), vh%(3): PRINT C1$
	COLOR vg%(4), vh%(4): PRINT D1$
	COLOR vg%(5), vh%(5): PRINT E1$
	COLOR vg%(6), vh%(6): PRINT F1$
	COLOR vg%(7), vh%(7): PRINT G1$
	COLOR vg%(8), vh%(8): PRINT H1$
	COLOR 15, 0
	_Delay U6

2247 REM
END SUB

SUB SHOTSTRING ()
	U$ = U$ + STR$(INT(F + .5)) + "*"
END SUB

SUB TEAMSETUP ()
'TEAM SETUP INITIALIZES THE TEAM DATA FILES, LEAGUE ADJUSTMENTS
'AND SETS UP THE PLAYER DATA
	  F5%(P9, 5) = L%(P9, 1): IF F5%(P9, 5) = 0 THEN F5%(P9, 5) = 4
	F5%(P9, 6) = L%(P9, 2): IF F5%(P9, 6) > 20 THEN F5%(P9, 6) = F5%(P9, 6) - 100
	F5%(P9, 7) = L%(P9, 3): IF F5%(P9, 7) > 20 THEN F5%(P9, 7) = F5%(P9, 7) - 100
	F5%(P9, 4) = L%(P9, 0): : IF F5%(P9, 4) > 20 THEN F5%(P9, 4) = F5%(P9, 4) - 100
	F5%(P9, 8) = L%(P9, 4)
	IF F5%(P9, 8) <> 99 THEN F5%(P9, 4) = 0: F5%(P9, 5) = 4: F5%(P9, 6) = 0: F5%(P9, 7) = 0
	FOR I = 0 TO 13
	A(P9, I, 16) = C(P9, I, 6)
	IF A(P9, I, 16) = 0 THEN A(P9, I, 16) = 6
	A(P9, I, 17) = C(P9, I, 5)
	IF A(P9, I, 17) = 0 THEN A(P9, I, 17) = 40
	A(P9, I, 19) = C(P9, I, 3)
	A(P9, I, 20) = C(P9, I, 2)
	A(P9, I, 21) = C(P9, I, 4)
	A(P9, I, 2) = A(P9, I, 2)
	NEXT I
	F5%(P9, 2) = V1%(P9)
	IF F5%(P9, 2) > 20 THEN F5%(P9, 2) = F5%(P9, 2) - 100
	F5%(P9, 3) = V2%(P9)
	IF F5%(P9, 3) > 20 THEN F5%(P9, 3) = F5%(P9, 3) - 100
END SUB

SUB TICKER ()

2850 '*** TICKER ***
	IF AP=1 AND U5=2 THEN 2884
	COLOR 14,0:CLS
	RN=INT(RND(1)*100)+1
	IF RN<=50 AND HT%=1 AND G9=0 THEN LOCATE ,23:PRINT "PRUDENTIAL AT THE HALF SCOREBOARD":GOTO 2851
	IF RN>50 AND HT%=1 AND G9=0 THEN LOCATE ,28:PRINT "RED MAN HALF TIME REPORT":GOTO 2851
	IF HT%=1 AND RN<=50 THEN LOCATE ,29:PRINT "TOYOTA HALFTIME REPORT":GOTO 2851
	IF HT%=1 AND RN>50 THEN LOCATE,29:PRINT "HONDA HALFTIME REPORT":GOTO 2851
	IF EG%=1 AND G9=0 THEN LOCATE ,27:PRINT "CHEVROLET FINAL SCOREBOARD":GOTO 2851
	IF EG%=1 AND RN<=33 THEN LOCATE ,27:PRINT "USA TODAY FINAL SCOREBOARD":GOTO 2851
	IF EG%=1 AND RN>33 AND RN<=67 THEN LOCATE ,24:PRINT "FEDERAL EXPRESS FINAL SCOREBOARD":GOTO 2851
	IF EG%=1 AND RN>67 THEN LOCATE ,23:PRINT "ESPN SPORTSCENTER FINAL SCOREBOARD":GOTO 2851
	IF HT%=0 THEN LOCATE ,30:PRINT "LANCE HAFFNER GAMES SCOREBOARD":GOTO 2851

2851  COLOR 15:IF TMT=0 THEN LOCATE 10,28:PRINT "NO OTHER GAMES SCHEDULED":GOTO 2883
	IF H=1 AND T<1200 AND T>=960 THEN TE=1
	IF H=1 AND T<960 AND T>=720 THEN TE=2
	IF H=1 AND T<720 AND T>=480 THEN TE=3
	IF H=1 AND T<480 AND T>=240 THEN TE=4
	IF H=1 AND T<240 AND T>=120 THEN TE=5
	IF H=1 AND T<120 THEN TE=6
	IF H=2 AND T<1200 AND T>=960 THEN TE=9
	IF H=2 AND T<960 AND T>=720 THEN TE=10
	IF H=2 AND T<720 AND T>=480 THEN TE=11
	IF H=2 AND T<480 AND T>=240 THEN TE=12
	IF H=2 AND T<240 AND T>=120 THEN TE=13
	IF H=2 AND T<120 THEN TE=14
	IF H=3 AND T<720 AND T>=480 THEN TE=15
	IF H=3 AND T<480 AND T>=240 THEN TE=16
	IF H=3 AND T<240 THEN TE=17
	IF HT%=1 THEN TE=8
	IF LEFT$(SX$(1,0),3)="XXX" THEN 2852
	LOCATE 2,1:X=1:GOSUB 2885:PRINT LEFT$(SX$(1,0),13);:LOCATE ,15
	PRINT USING "### ";SX%(1,0,TS%);:PRINT R$(TS%)
	PRINT LEFT$(SX$(1,1),13);:LOCATE ,15:PRINT USING "### #";SX%(1,1,TS%)

2852 IF LEFT$(SX$(2,0),3)="XXX" THEN 2853
	LOCATE 5,1:X=2:GOSUB 2885:PRINT LEFT$(SX$(2,0),13);:LOCATE ,15:PRINT USING "### ";SX%(2,0,TS%);:PRINT R$(TS%)
	PRINT LEFT$(SX$(2,1),13);:LOCATE ,15:PRINT USING "### #";SX%(2,1,TS%)

2853 IF LEFT$(SX$(3,0),3)="XXX" THEN 2854
	LOCATE 8,1:X=3:GOSUB 2885:PRINT LEFT$(SX$(3,0),13);:LOCATE ,15:PRINT USING "### ";SX%(3,0,TS%);:PRINT R$(TS%)
	PRINT LEFT$(SX$(3,1),13);:LOCATE ,15:PRINT USING "### #";SX%(3,1,TS%)

2854  IF LEFT$(SX$(4,0),3)="XXX" THEN 2855
	LOCATE 11,1:X=4:GOSUB 2885:PRINT LEFT$(SX$(4,0),13);:LOCATE ,15:PRINT USING "### ";SX%(4,0,TS%);:PRINT R$(TS%)
	PRINT LEFT$(SX$(4,1),13);:LOCATE ,15:PRINT USING "### #";SX%(4,1,TS%)

2855  IF LEFT$(SX$(5,0),3)="XXX" THEN 2856
	LOCATE 14,1:X=5:GOSUB 2885:PRINT LEFT$(SX$(5,0),13);:LOCATE ,15:PRINT USING "### ";SX%(5,0,TS%);:PRINT R$(TS%)
	PRINT LEFT$(SX$(5,1),13);:LOCATE ,15:PRINT USING "### #";SX%(5,1,TS%)

2856  IF LEFT$(SX$(6,0),3)="XXX" THEN 2857
	LOCATE 17,1:X=6:GOSUB 2885:PRINT LEFT$(SX$(6,0),13);:LOCATE ,15:PRINT USING "### ";SX%(6,0,TS%);:PRINT R$(TS%)
	PRINT LEFT$(SX$(6,1),13);:LOCATE ,15:PRINT USING "### #";SX%(6,1,TS%)

2857  IF LEFT$(SX$(7,0),3)="XXX" THEN 2858
	LOCATE 20,1:X=7:GOSUB 2885:PRINT LEFT$(SX$(7,0),13);:LOCATE ,15:PRINT USING "### ";SX%(7,0,TS%);:PRINT R$(TS%)
	PRINT LEFT$(SX$(7,1),13);:LOCATE ,15:PRINT USING "### #";SX%(7,1,TS%)

2858  IF LEFT$(SX$(8,0),3)="XXX" THEN 2859
	LOCATE 23,1:X=8:GOSUB 2885:PRINT LEFT$(SX$(8,0),13);:LOCATE ,15:PRINT USING "### ";SX%(8,0,TS%);:PRINT R$(TS%)
	PRINT LEFT$(SX$(8,1),13);:LOCATE ,15:PRINT USING "### #";SX%(8,1,TS%);

2859  IF LEFT$(SX$(9,0),3)="XXX" THEN 2860
	LOCATE 2,21:X=9:GOSUB 2885:PRINT LEFT$(SX$(9,0),13);:LOCATE ,35:PRINT USING "### ";SX%(9,0,TS%);:PRINT R$(TS%)
	LOCATE ,21:PRINT LEFT$(SX$(9,1),13);:LOCATE ,35:PRINT USING "### #";SX%(9,1,TS%)

2860  IF LEFT$(SX$(10,0),3)="XXX" THEN 2861
	LOCATE 5,21:X=10:GOSUB 2885:PRINT LEFT$(SX$(10,0),13);:LOCATE ,35:PRINT USING "### ";SX%(10,0,TS%);:PRINT R$(TS%)
	LOCATE ,21:PRINT LEFT$(SX$(10,1),13);:LOCATE ,35:PRINT USING "### #";SX%(10,1,TS%)

2861  IF LEFT$(SX$(11,0),3)="XXX" THEN 2862
	LOCATE 8,21:X=11:GOSUB 2885:PRINT LEFT$(SX$(11,0),13);:LOCATE ,35:PRINT USING "### ";SX%(11,0,TS%);:PRINT R$(TS%)
	LOCATE ,21:PRINT LEFT$(SX$(11,1),13);:LOCATE ,35:PRINT USING "### #";SX%(11,1,TS%)

2862  IF LEFT$(SX$(12,0),3)="XXX" THEN 2863
	LOCATE 11,21:X=12:GOSUB 2885:PRINT LEFT$(SX$(12,0),13);:LOCATE ,35:PRINT USING "### ";SX%(12,0,TS%);:PRINT R$(TS%)
	LOCATE ,21:PRINT LEFT$(SX$(12,1),13);:LOCATE ,35:PRINT USING "### #";SX%(12,1,TS%)

2863  IF LEFT$(SX$(13,0),3)="XXX" THEN 2864
	LOCATE 14,21:X=13:GOSUB 2885:PRINT LEFT$(SX$(13,0),13);:LOCATE ,35:PRINT USING "### ";SX%(13,0,TS%);:PRINT R$(TS%)
	LOCATE ,21:PRINT LEFT$(SX$(13,1),13);:LOCATE ,35:PRINT USING "### #";SX%(13,1,TS%)

2864  IF LEFT$(SX$(14,0),3)="XXX" THEN 2865
	LOCATE 17,21:X=14:GOSUB 2885:PRINT LEFT$(SX$(14,0),13);:LOCATE ,35:PRINT USING "### ";SX%(14,0,TS%);:PRINT R$(TS%)
	LOCATE ,21:PRINT LEFT$(SX$(14,1),13);:LOCATE ,35:PRINT USING "### #";SX%(14,1,TS%)

2865  IF LEFT$(SX$(15,0),3)="XXX" THEN 2866
	LOCATE 20,21:X=15:GOSUB 2885:PRINT LEFT$(SX$(15,0),13);:LOCATE ,35:PRINT USING "### ";SX%(15,0,TS%);:PRINT R$(TS%)
	LOCATE ,21:PRINT LEFT$(SX$(15,1),13);:LOCATE ,35:PRINT USING "### #";SX%(15,1,TS%)

2866  IF LEFT$(SX$(16,0),3)="XXX" THEN 2867
	LOCATE 23,21:X=16:GOSUB 2885:PRINT LEFT$(SX$(16,0),13);:LOCATE ,35:PRINT USING "### ";SX%(16,0,TS%);:PRINT R$(TS%)
	LOCATE ,21:PRINT LEFT$(SX$(16,1),13);:LOCATE ,35:PRINT USING "### #";SX%(16,1,TS%);

2867  IF LEFT$(SX$(17,0),3)="XXX" THEN 2868
	LOCATE 2,41:X=17:GOSUB 2885:PRINT LEFT$(SX$(17,0),13);:LOCATE ,55:PRINT USING "### ";SX%(17,0,TS%);:PRINT R$(TS%)
	LOCATE ,41:PRINT LEFT$(SX$(17,1),13);:LOCATE ,55:PRINT USING "### #";SX%(17,1,TS%)

2868  IF LEFT$(SX$(18,0),3)="XXX" THEN 2869
	LOCATE 5,41:X=18:GOSUB 2885:PRINT LEFT$(SX$(18,0),13);:LOCATE ,55:PRINT USING "### ";SX%(18,0,TS%);:PRINT R$(TS%)
	LOCATE ,41:PRINT LEFT$(SX$(18,1),13);:LOCATE ,55:PRINT USING "### #";SX%(18,1,TS%)

2869  IF LEFT$(SX$(19,0),3)="XXX" THEN 2870
	LOCATE 8,41:X=19:GOSUB 2885:PRINT LEFT$(SX$(19,0),13);:LOCATE ,55:PRINT USING "### ";SX%(19,0,TS%);:PRINT R$(TS%)
	LOCATE ,41:PRINT LEFT$(SX$(19,1),13);:LOCATE ,55:PRINT USING "### #";SX%(19,1,TS%)

2870 IF LEFT$(SX$(20,0),3)="XXX" THEN 2871
	LOCATE 11,41:X=20:GOSUB 2885:PRINT LEFT$(SX$(20,0),13);:LOCATE ,55:PRINT USING "### ";SX%(20,0,TS%);:PRINT R$(TS%)
	LOCATE ,41:PRINT LEFT$(SX$(20,1),13);:LOCATE ,55:PRINT USING "### #";SX%(20,1,TS%)

2871 IF LEFT$(SX$(21,0),3)="XXX" THEN 2872
	LOCATE 14,41:X=21:GOSUB 2885:PRINT LEFT$(SX$(21,0),13);:LOCATE ,55:PRINT USING "### ";SX%(21,0,TS%);:PRINT R$(TS%)
	LOCATE ,41:PRINT LEFT$(SX$(21,1),13);:LOCATE ,55:PRINT USING "### #";SX%(21,1,TS%)

2872 IF LEFT$(SX$(22,0),3)="XXX" THEN 2873
	LOCATE 17,41:X=22:GOSUB 2885:PRINT LEFT$(SX$(22,0),13);:LOCATE ,55:PRINT USING "### ";SX%(22,0,TS%);:PRINT R$(TS%)
	LOCATE ,41:PRINT LEFT$(SX$(22,1),13);:LOCATE ,55:PRINT USING "### #";SX%(22,1,TS%)

2873 IF LEFT$(SX$(23,0),3)="XXX" THEN 2874
	LOCATE 20,41:X=23:GOSUB 2885:PRINT LEFT$(SX$(23,0),13);:LOCATE ,55:PRINT USING "### ";SX%(23,0,TS%);:PRINT R$(TS%)
	LOCATE ,41:PRINT LEFT$(SX$(23,1),13);:LOCATE ,55:PRINT USING "### #";SX%(23,1,TS%)

2874 IF LEFT$(SX$(24,0),3)="XXX" THEN 2875
	LOCATE 23,41:X=24:GOSUB 2885:PRINT LEFT$(SX$(24,0),13);:LOCATE ,55:PRINT USING "### ";SX%(24,0,TS%);:PRINT R$(TS%)
	LOCATE ,41:PRINT LEFT$(SX$(24,1),13);:LOCATE ,55:PRINT USING "### #";SX%(24,1,TS%);

2875 IF LEFT$(SX$(25,0),3)="XXX" THEN 2876
	LOCATE 2,61:X=25:GOSUB 2885:PRINT LEFT$(SX$(25,0),13);:LOCATE ,75:PRINT USING "### ";SX%(25,0,TS%);:PRINT R$(TS%)
	LOCATE ,61:PRINT LEFT$(SX$(25,1),13);:LOCATE ,75:PRINT USING "### #";SX%(25,1,TS%)

2876 IF LEFT$(SX$(26,0),3)="XXX" THEN 2877
	LOCATE 5,61:X=26:GOSUB 2885:PRINT LEFT$(SX$(26,0),13);:LOCATE ,75:PRINT USING "### ";SX%(26,0,TS%);:PRINT R$(TS%)
	LOCATE ,61:PRINT LEFT$(SX$(26,1),13);:LOCATE ,75:PRINT USING "### #";SX%(26,1,TS%)

2877 IF LEFT$(SX$(27,0),3)="XXX" THEN 2878
	LOCATE 8,61:X=27:GOSUB 2885:PRINT LEFT$(SX$(27,0),13);:LOCATE ,75:PRINT USING "### ";SX%(27,0,TS%);:PRINT R$(TS%)
	LOCATE ,61:PRINT LEFT$(SX$(27,1),13);:LOCATE ,75:PRINT USING "### #";SX%(27,1,TS%)

2878 IF LEFT$(SX$(28,0),3)="XXX" THEN 2879
	LOCATE 11,61:X=28:GOSUB 2885:PRINT LEFT$(SX$(28,0),13);:LOCATE ,75:PRINT USING "### ";SX%(28,0,TS%);:PRINT R$(TS%)
	LOCATE ,61:PRINT LEFT$(SX$(28,1),13);:LOCATE ,75:PRINT USING "### #";SX%(28,1,TS%)

2879 IF LEFT$(SX$(29,0),3)="XXX" THEN 2880
	LOCATE 14,61:X=29:GOSUB 2885:PRINT LEFT$(SX$(29,0),13);:LOCATE ,75:PRINT USING "### ";SX%(29,0,TS%);:PRINT R$(TS%)
	LOCATE ,61:PRINT LEFT$(SX$(29,1),13);:LOCATE ,75:PRINT USING "### #";SX%(29,1,TS%)

2880 IF LEFT$(SX$(30,0),3)="XXX" THEN 2881
	LOCATE 17,61:X=30:GOSUB 2885:PRINT LEFT$(SX$(30,0),13);:LOCATE ,75:PRINT USING "### ";SX%(30,0,TS%);:PRINT R$(TS%)
	LOCATE ,61:PRINT LEFT$(SX$(30,1),13);:LOCATE ,75:PRINT USING "### #";SX%(30,1,TS%)

2881 IF LEFT$(SX$(31,0),3)="XXX" THEN 2882
	LOCATE 20,61:X=31:GOSUB 2885:PRINT LEFT$(SX$(31,0),13);:LOCATE ,75:PRINT USING "### ";SX%(31,0,TS%);:PRINT R$(TS%)
	LOCATE ,61:PRINT LEFT$(SX$(31,1),13);:LOCATE ,75:PRINT USING "### #";SX%(31,1,TS%)

2882 IF LEFT$(SX$(32,0),3)="XXX" THEN 2883
	LOCATE 23,61:X=32:GOSUB 2885:PRINT LEFT$(SX$(32,0),13);:LOCATE ,75:PRINT USING "### ";SX%(32,0,TS%);:PRINT R$(TS%)
	LOCATE ,61:PRINT LEFT$(SX$(32,1),13);:LOCATE ,75:PRINT USING "### #";SX%(32,1,TS%);
2883 I$ = GetKeyPress$
	GOTO 2884

2885 TS%=TE+(ST%-ST%(X))*3
	IF TS%<0 THEN TS%=0
	IF TS%>14 THEN TS%=14
	IF EG%=1 THEN TS%=14
	RETURN

2884 END SUB

SUB GETAKEY (I$)

4092 I$=GetKeyPress$END SUB

SUB HITKEY

4091 IF AP=1 AND U5=2 THEN 4093
	CALL GETAKEY (I$)

4093 END SUB

SUB PRINTBOX

8900 IF N<>2 THEN LPRINT "@ ";B$(N):LPRINT
	FOR I = 0 TO 1
	LPRINT B$(I); TAB(17); STR$(S(I,1)); TAB(20); STR$(S(I,2));
	IF S(0,1)+S(0,2)=S(1,1)+S(1,2) THEN LPRINT TAB(23); STR$(S(I,3));
	IF S(0,1)+S(0,2)<>S(1,1)+S(1,2) THEN LPRINT TAB(23); "- ";S(I,0):GOTO 8913
	IF S(0,1)+S(0,2)+S(0,3)=S(1,1)+S(1,2)+S(1,3) THEN LPRINT TAB(26); STR$(S(I,4));
	IF S(0,1)+S(0,2)+S(0,3)<>S(1,1)+S(1,2)+S(1,3) THEN LPRINT TAB(26); "- ";S(I,0):GOTO 8913
	IF S(0,1)+S(0,2)+S(0,3)+S(0,4)=S(1,1)+S(1,2)+S(1,3)+S(1,4) THEN LPRINT TAB(29); STR$(S(I,5));
	IF S(0,1)+S(0,2)+S(0,3)+S(0,4)<>S(1,1)+S(1,2)+S(1,3)+S(1,4) THEN LPRINT TAB(29); "- "; STR$(S(I,0)):GOTO 8913
	IF S(0,1)+S(0,2)+S(0,3)+S(0,4)+S(0,5)=S(1,1)+S(1,2)+S(1,3)+S(1,4)+S(1,5) THEN LPRINT TAB(32); STR$(S(I,6));
	IF S(0,1)+S(0,2)+S(0,3)+S(0,4)+S(0,5)<>S(1,1)+S(1,2)+S(1,3)+S(1,4)+S(1,5) THEN LPRINT TAB(32); "- ";STR$(S(I,0)):GOTO 8913
	IF S(0,1)+S(0,2)+S(0,3)+S(0,4)+S(0,5)+S(0,6)=S(1,1)+S(1,2)+S(1,3)+S(1,4)+S(1,5)+S(1,6) THEN LPRINT TAB(35); STR$(S(I,7)); TAB(38); STR$(S(I,0)):GOTO 8913
	IF S(0,1)+S(0,2)+S(0,3)+S(0,4)+S(0,5)+S(0,6)<>S(1,1)+S(1,2)+S(1,3)+S(1,4)+S(1,5)+S(1,6) THEN LPRINT TAB(35); "- ";STR$(S(I,0)):GOTO 8913

8913 NEXT I
	FOR I=0 TO 1:LPRINT:LPRINT B$(I)
	LPRINT "NAME"; TAB(14); " MIN   FG- A 3FG- A  FT- A ORB  RB  PT  F   A   B   S  TO":FOR I1=0 TO 13
	IF AA$(I,I1)="XXX" THEN 8920
	LPRINT AA$(I,I1); TAB(14);
	IF ZZ(I,I1)=0 THEN LPRINT TAB(15); "DNP";:GOTO 8918
	LPRINT USING "##";INT(ZZ(I,I1)/60);:LPRINT ":";:IF ZZ(I,I1)-INT(ZZ(I,I1)/60)*60>9 THEN LPRINT USING "##";ZZ(I,I1)-INT(ZZ(I,I1)/60)*60; ELSE LPRINT "0";:LPRINT USING "#";ZZ(I,I1)-INT(ZZ(I,I1)/60)*60;

8918 LPRINT TAB(21);:LPRINT USING "##";A(I,I1,8);:LPRINT "-";:LPRINT USING"##";A(I,I1,7);:LPRINT USING"  ##";W%(I,I1,0);:LPRINT"-";:LPRINT USING "##";W%(I,I1,1);:LPRINT USING"  ##";A(I,I1,10);:LPRINT"-";:LPRINT USING"##";A(I,I1,9);
	LPRINT USING "  ##  ## ###  #  ##  ##  ##  ##  ##  ##";A(I,I1,24),A(I,I1,11),A(I,I1,8)*2+A(I,I1,10)+W%(I,I1,0),A(I,I1,12),A(I,I1,14),A(I,I1,15),A(I,I1,13),A(I,I1,23)
	V9(0)=V9(0)+A(I,I1,8):V9(1)=V9(1)+A(I,I1,7):V9(2)=V9(2)+A(I,I1,10):V9(3)=V9(3)+A(I,I1,9):V9(4)=V9(4)+A(I,I1,11):V9(5)=V9(5)+(A(I,I1,8)*2)+A(I,I1,10)+W%(I,I1,0):V9(13)=V9(13)+W%(I,I1,0):V9(14)=V9(14)+W%(I,I1,1)
	V9(6)=V9(6)+A(I,I1,12)
	V9(7)=V9(7)+A(I,I1,14):V9(8)=V9(8)+A(I,I1,15):V9(9)=V9(9)+A(I,I1,13):V9(11)=V9(11)+A(I,I1,24):V9(12)=V9(12)+A(I,I1,23)
	V9(10)=V9(10)+ZZ(I,I1)

8920 NEXT I1:IF V9(3)=0 THEN V9(3)=1
	LPRINT:LPRINT "TOTALS"; TAB(14); INT(V9(10)/60); TAB(21);:LPRINT USING"##";V9(0);:LPRINT "-";:LPRINT USING "###";V9(1);
	LPRINT TAB(28); USING "##";V9(13);:LPRINT "-";:LPRINT USING "##";V9(14);
	LPRINT TAB(35); USING "##";V9(2);:LPRINT "-";:LPRINT USING "##";V9(3);
	LPRINT TAB(42); USING "##  ## ### ##  ##  ##  ##  ##";V9(11),V9(4),V9(5),V9(6),V9(7),V9(8),V9(9),V9(12)
	LPRINT TAB(22); INT(((V9(0)/V9(1))*100)+.5);"%";TAB(35); INT(((V9(2)/V9(3))*100)+.5);"%":LPRINT:LPRINT"TOTAL TURNOVERS -"T0(I):LPRINT"TOTAL REBOUNDS  -"R3(I):FOR I2=0 TO 14:V9(I2)=0:NEXT I2
	NEXT I
	LPRINT CHR$(12)
END SUB

SUB FILEBOX
	IF AP = 1 THEN
		NM$ = "BOX" + MID$(STR$(AP%(0) + AP%(2)), 2, LEN(STR$(AP%(0) + AP%(2))))
		GOTO 8951
	END IF
	CLS
	INPUT "ENTER FILENAME TO SAVE GAME SUMMARY UNDER "; NM$: NM$ = NM$ + ".SPC"

8951 OPEN P$(1) + NM$ FOR OUTPUT AS #2
	IF N<>2 THEN PRINT #2, "@ ";B$(N):PRINT #2,
	FOR I=0 TO 1
	PRINT #2, B$(I); TAB(17); STR$(S(I,1)); TAB(20); STR$(S(I,2));
	IF S(0,1)+S(0,2)=S(1,1)+S(1,2) THEN PRINT #2, TAB(23); STR$(S(I,3));
	IF S(0,1)+S(0,2)<>S(1,1)+S(1,2) THEN PRINT #2, TAB(23); "- ";S(I,0):GOTO 8963
	IF S(0,1)+S(0,2)+S(0,3)=S(1,1)+S(1,2)+S(1,3) THEN PRINT #2, TAB(26); STR$(S(I,4));
	IF S(0,1)+S(0,2)+S(0,3)<>S(1,1)+S(1,2)+S(1,3) THEN PRINT #2, TAB(26); "- ";S(I,0):GOTO 8963
	IF S(0,1)+S(0,2)+S(0,3)+S(0,4)=S(1,1)+S(1,2)+S(1,3)+S(1,4) THEN PRINT #2, TAB(29); STR$(S(I,5));
	IF S(0,1)+S(0,2)+S(0,3)+S(0,4)<>S(1,1)+S(1,2)+S(1,3)+S(1,4) THEN PRINT #2, TAB(29); "- "; STR$(S(I,0)):GOTO 8963
	IF S(0,1)+S(0,2)+S(0,3)+S(0,4)+S(0,5)=S(1,1)+S(1,2)+S(1,3)+S(1,4)+S(1,5) THEN PRINT #2, TAB(32); STR$(S(I,6));
	IF S(0,1)+S(0,2)+S(0,3)+S(0,4)+S(0,5)<>S(1,1)+S(1,2)+S(1,3)+S(1,4)+S(1,5) THEN PRINT #2, TAB(32); "- ";STR$(S(I,0)):GOTO 8963
	IF S(0,1)+S(0,2)+S(0,3)+S(0,4)+S(0,5)+S(0,6)=S(1,1)+S(1,2)+S(1,3)+S(1,4)+S(1,5)+S(1,6) THEN PRINT #2, TAB(35); STR$(S(I,7)); TAB(38); STR$(S(I,0)):GOTO 8963
	IF S(0,1)+S(0,2)+S(0,3)+S(0,4)+S(0,5)+S(0,6)<>S(1,1)+S(1,2)+S(1,3)+S(1,4)+S(1,5)+S(1,6) THEN PRINT #2, TAB(35); "- ";STR$(S(I,0)):GOTO 8963

8963 NEXT I
	FOR I=0 TO 1:PRINT #2,:PRINT #2, B$(I)
	PRINT #2, "NAME"; TAB(14); " MIN   FG- A 3FG- A  FT- A ORB  RB  PT  F   A   B   S  TO"
	FOR I1=0 TO 13
	IF AA$(I,I1)="XXX" THEN 8970
	PRINT #2, AA$(I,I1); TAB(14);
	IF ZZ(I,I1)=0 THEN PRINT #2, TAB(15); "DNP";:GOTO 8968
	PRINT #2, USING "##";INT(ZZ(I,I1)/60);:PRINT #2, ":";
	IF ZZ(I,I1)-INT(ZZ(I,I1)/60)*60>9 THEN PRINT #2, USING "##";ZZ(I,I1)-INT(ZZ(I,I1)/60)*60; ELSE PRINT #2, "0";:PRINT #2, USING "#";ZZ(I,I1)-INT(ZZ(I,I1)/60)*60;

8968 PRINT #2, TAB(21);:PRINT #2, USING "##";A(I,I1,8);
	PRINT #2, "-";:PRINT #2, USING"##";A(I,I1,7);:PRINT #2, USING"  ##";W%(I,I1,0);:PRINT #2,"-";:PRINT #2, USING "##";W%(I,I1,1);:PRINT #2, USING"  ##";A(I,I1,10);:PRINT #2,"-";:PRINT #2, USING"##";A(I,I1,9);
	PRINT #2, USING "  ##  ## ###  #  ##  ##  ##  ##  ##  ##";A(I,I1,24),A(I,I1,11),A(I,I1,8)*2+A(I,I1,10)+W%(I,I1,0),A(I,I1,12),A(I,I1,14),A(I,I1,15),A(I,I1,13),A(I,I1,23)
	V9(0)=V9(0)+A(I,I1,8):V9(1)=V9(1)+A(I,I1,7):V9(2)=V9(2)+A(I,I1,10):V9(3)=V9(3)+A(I,I1,9):V9(4)=V9(4)+A(I,I1,11):V9(5)=V9(5)+(A(I,I1,8)*2)+A(I,I1,10)+W%(I,I1,0):V9(13)=V9(13)+W%(I,I1,0):V9(14)=V9(14)+W%(I,I1,1)
	V9(6)=V9(6)+A(I,I1,12)
	V9(7)=V9(7)+A(I,I1,14):V9(8)=V9(8)+A(I,I1,15):V9(9)=V9(9)+A(I,I1,13):V9(11)=V9(11)+A(I,I1,24):V9(12)=V9(12)+A(I,I1,23)
	V9(10)=V9(10)+ZZ(I,I1)

8970 NEXT I1:IF V9(3)=0 THEN V9(3)=1
	PRINT #2,:PRINT #2, "TOTALS"; TAB(14); INT(V9(10)/60); TAB(21);:PRINT #2, USING"##";V9(0);:PRINT #2, "-";:PRINT #2, USING "###";V9(1);
	PRINT #2, TAB(28); USING "##";V9(13);:PRINT #2, "-";:PRINT #2, USING "##";V9(14);
	PRINT #2, TAB(35); USING "##";V9(2);:PRINT #2, "-";:PRINT #2, USING "##";V9(3);
	PRINT #2, TAB(42); USING "##  ## ### ##  ##  ##  ##  ##";V9(11),V9(4),V9(5),V9(6),V9(7),V9(8),V9(9),V9(12)
	PRINT #2, TAB(22); INT(((V9(0)/V9(1))*100)+.5);"%";TAB(35); INT(((V9(2)/V9(3))*100)+.5);"%":PRINT #2,:PRINT #2,"TOTAL TURNOVERS -"T0(I):PRINT #2,"TOTAL REBOUNDS  -"R3(I):FOR I2=0 TO 14:V9(I2)=0:NEXT I2
	NEXT I
	PRINT #2, CHR$(12):CLOSE 2
END SUB

SUB STAMINASORT

8800 M=13
	L=12

8802 S6=0:S7=0

8803 H1=0:H2=0
	IF S3(S6)<=S3(S6+1) THEN 8809
	H1=S3(S6):H2=F1(S6)
	S3(S6)=S3(S6+1):F1(S6)=F1(S6+1)
	S3(S6+1)=H1:F1(S6+1)=H2
	S7=S6

8809 S6=S6+1
	IF S6>L THEN 8812
	GOTO 8803

8812 IF S7=0 THEN 8813
	L=S7-1:GOTO 8802

8813 END SUB

SUB REBOUNDSORT

8825 M=4
	L=3

8827 S6=0:S7=0

8828 H1=0:H2=0
	IF G5(S6)<=G5(S6+1) THEN 8834
	H1=G5(S6):H2=G4(S6)
	G5(S6)=G5(S6+1):G4(S6)=G4(S6+1)
	G5(S6+1)=H1:G4(S6+1)=H2
	S7=S6

8834 S6=S6+1
	IF S6>L THEN 8837
	GOTO 8828

8837 IF S7=0 THEN 8838
	L=S7-1
	GOTO 8827

8838 END SUB

SUB COMCOACH
'COMPUTER COACH FOR SUBSTITUTIONS AND AI
	  FOR I=0 TO 13
	F1(I)=I
	S3(I)=A(P9,I,3)-A(P9,I,7)-A(P9,I,11)-A(P9,I,12)
	IF H>2 THEN S3(I)=A(P9,I,3)
	IF H=2 AND T<=120 THEN S3(I)=A(P9,I,3)
	IF A(P9,I,12)>=NF% THEN S3(I)=0
	NEXT I
	CALL STAMINASORT
	I=14
	FOR I1=0 TO 4

8794 I=I-1
	IF I<0 THEN 8700
	IF B%(P9,F1(I),18)<>0 OR AA$(P9,F1(I))="XXX" OR A(P9,F1(I),12)>=NF% OR A(P9,F1(I),12)>=NF%-2 AND H=1 OR A(P9,F1(I),12)>=NF%-1 AND H=2 AND T>720 THEN 8794
	IF H=1 AND S3(I)/A(P9,F1(I),3)<.5 THEN 8794
	IF H=1 AND T>=600 AND S3(I)/A(P9,F1(I),3)<.75 THEN 8794
	IF H=2 AND T>=600 AND S3(I)/A(P9,F1(I),3)<.25 THEN 8794
	IF H=2 AND T>=300 AND T<600 AND S3(I)/A(P9,F1(I),3)<.13 THEN 8794
	IF H=2 AND T<300 AND S3(I)/A(P9,F1(I),3)<T/2400 THEN 8794
	IF S3(I)<=0 AND H<2 OR S3(I)<=0 AND H=2 AND T>120 THEN 8794
	G4(I1)=F1(I):G5(I1)=A(P9,F1(I),2)
	NEXT I1

8798 CALL REBOUNDSORT
	FOR I=0 TO 4
	B1(P9,I)=G4(I)
	NEXT I
	CALL AICOMCOACH
	GOTO 8799

8700 I=14
	FOR I1=0 TO 4

8705 I=I-1
	IF I<0 THEN 8690
	IF B%(P9,F1(I),18)<>0 OR AA$(P9,F1(I))="XXX" OR A(P9,F1(I),12)>=NF% OR A(P9,F1(I),12)>=NF%-1 AND (H=1 OR H=2 AND T>720) THEN 8705
	G4(I1)=F1(I):G5(I1)=A(P9,F1(I),2)
	NEXT I1
	GOTO 8798

8690 I=14
	FOR I1=0 TO 4

8695 I=I-1
	IF B%(P9,F1(I),18)<>0 OR AA$(P9,F1(I))="XXX" THEN 8695
	G4(I1)=F1(I):G5(I1)=A(P9,F1(I),2)
	NEXT I1
	GOTO 8798

8799 END SUB

SUB TOURNEY
	'CHECK FOR FILLING IN TOURNEY SCHEDULE
OPEN P$(0) + FF$ + ".TOU" AS #1 LEN=90
	Y2=LOF(1)
CLOSE 1
	NT=Y2/90
	FOR I=1 TO NT
OPEN P$(0) + FF$ + ".TOU" AS #1 LEN=90
	FOR X=0 TO 14
	FIELD #1,X*2 AS X$,2 AS Q$(X+1),90-2-2*X AS X$
	NEXT
	FIELD #1,30 AS X$,2 AS Q$(16),2 AS Q$(17),15 AS Q$(18),15 AS Q$(19),26 AS X$
	FIELD #1,64 AS X$,3 AS Q$(20),3 AS Q$(21),6 AS Q$(22),8 AS Q$(23),6 AS X$
	FIELD #1,84 AS X$,2 AS Q$(24),2 AS Q$(25),2 AS Q$(26)
	GET #1,I
	VS1%=CVI(Q$(16)):HS1%=CVI(Q$(17))
	VT1$=Q$(18):W1$=Q$(19)
	FOR X=0 TO 14:NG1%(X)=CVI(Q$(X+1)):NEXT
	FOR X=0 TO 3:YN1$(X)=Q$(20+X):NEXT
	FOR X=1 TO 3:NG1%(X+14)=CVI(Q$(X+23)):NEXT
CLOSE 1
	IF NG1%(15)<>NG%(15) OR NG%(15)=17 THEN 6108
	  IF S(0,0)>S(1,0) AND NG1%(0)-900 = NG%(17) THEN NG1%(0)=NG%(0):YN1$(0)=YN$(0):VT1$=VT$:GOSUB 6105
	IF S(1,0)>S(0,0) AND NG1%(0)-900 = NG%(17) THEN NG1%(0)=NG%(1):YN1$(0)=YN$(1):VT1$=W$:GOSUB 6105
	IF S(0,0)>S(1,0) AND NG1%(1)-900 = NG%(17) THEN NG1%(1)=NG%(0):YN1$(1)=YN$(0):W1$=VT$:GOSUB 6105
	IF S(1,0)>S(0,0) AND NG1%(1)-900 = NG%(17) THEN NG1%(1)=NG%(1):YN1$(1)=YN$(1):W1$=W$:GOSUB 6105
	IF S(0,0)<S(1,0) AND NG1%(0)-800 = NG%(17) THEN NG1%(0)=NG%(0):YN1$(0)=YN$(0):VT1$=VT$:GOSUB 6105
	IF S(1,0)<S(0,0) AND NG1%(0)-800 = NG%(17) THEN NG1%(0)=NG%(1):YN1$(0)=YN$(1):VT1$=W$:GOSUB 6105
	IF S(0,0)<S(1,0) AND NG1%(1)-800 = NG%(17) THEN NG1%(1)=NG%(0):YN1$(1)=YN$(0):W1$=VT$:GOSUB 6105
	IF S(1,0)<S(0,0) AND NG1%(1)-800 = NG%(17) THEN NG1%(1)=NG%(1):YN1$(1)=YN$(1):W1$=W$:GOSUB 6105

6108 IF NG%(15)=17 THEN 6109
	IF S(0,0)>S(1,0) AND NG%(16)=89 AND NG1%(15)=17 AND NG1%(0)-900 = NG%(15) THEN NG1%(0)=NG%(0):YN1$(0)=YN$(0):VT1$=VT$:GOSUB 6105
	IF S(1,0)>S(0,0) AND NG%(16)=89 AND NG1%(15)=17 AND NG1%(0)-900 = NG%(15) THEN NG1%(0)=NG%(1):YN1$(0)=YN$(1):VT1$=W$:GOSUB 6105
	IF S(0,0)>S(1,0) AND NG%(16)=89 AND NG1%(15)=17 AND NG1%(1)-900 = NG%(15) THEN NG1%(1)=NG%(0):YN1$(1)=YN$(0):W1$=VT$:GOSUB 6105
	IF S(1,0)>S(0,0) AND NG%(16)=89 AND NG1%(15)=17 AND NG1%(1)-900 = NG%(15) THEN NG1%(1)=NG%(1):YN1$(1)=YN$(1):W1$=W$:GOSUB 6105

6109 IF S(0,0)>S(1,0) AND NG%(15)=17 AND NG1%(0)-1100 = NG%(17) THEN NG1%(0)=NG%(0):YN1$(0)=YN$(0):VT1$=VT$:GOSUB 6105
	IF S(1,0)>S(0,0) AND NG%(15)=17 AND NG1%(0)-1100 = NG%(17) THEN NG1%(0)=NG%(1):YN1$(0)=YN$(1):VT1$=W$:GOSUB 6105
	IF S(0,0)>S(1,0) AND NG%(15)=17 AND NG1%(1)-1100 = NG%(17) THEN NG1%(1)=NG%(0):YN1$(1)=YN$(0):W1$=VT$:GOSUB 6105
	IF S(1,0)>S(0,0) AND NG%(15)=17 AND NG1%(1)-1100 = NG%(17) THEN NG1%(1)=NG%(1):YN1$(1)=YN$(1):W1$=W$:GOSUB 6105
	IF S(0,0)<S(1,0) AND NG%(15)=17 AND NG1%(0)-1000 = NG%(17) THEN NG1%(0)=NG%(0):YN1$(0)=YN$(0):VT1$=VT$:GOSUB 6105
	IF S(1,0)<S(0,0) AND NG%(15)=17 AND NG1%(0)-1000 = NG%(17) THEN NG1%(0)=NG%(1):YN1$(0)=YN$(1):VT1$=W$:GOSUB 6105
	IF S(0,0)<S(1,0) AND NG%(15)=17 AND NG1%(1)-1000 = NG%(17) THEN NG1%(1)=NG%(0):YN1$(1)=YN$(0):W1$=VT$:GOSUB 6105
	IF S(1,0)<S(0,0) AND NG%(15)=17 AND NG1%(1)-1000 = NG%(17) THEN NG1%(1)=NG%(1):YN1$(1)=YN$(1):W1$=W$:GOSUB 6105
	IF S(0,0)<S(1,0) AND NG%(15)=17 AND NG1%(0)-900 = NG%(17) THEN NG1%(0)=NG%(0):YN1$(0)=YN$(0):VT1$=VT$:GOSUB 6105
	IF S(1,0)<S(0,0) AND NG%(15)=17 AND NG1%(0)-900 = NG%(17) THEN NG1%(0)=NG%(1):YN1$(0)=YN$(1):VT1$=W$:GOSUB 6105
	IF S(0,0)<S(1,0) AND NG%(15)=17 AND NG1%(1)-900 = NG%(17) THEN NG1%(1)=NG%(0):YN1$(1)=YN$(0):W1$=VT$:GOSUB 6105
	IF S(1,0)<S(0,0) AND NG%(15)=17 AND NG1%(1)-900 = NG%(17) THEN NG1%(1)=NG%(1):YN1$(1)=YN$(1):W1$=W$:GOSUB 6105
	NEXT
	GOTO 6106

6105 'UPDATE FILE
OPEN P$(0) + FF$ + ".TOU" AS #1 LEN=90
	FOR X=0 TO 14
	FIELD #1,X*2 AS X$,2 AS Q$(X+1),90-2-2*X AS X$
	NEXT
	FIELD #1,30 AS X$,2 AS Q$(16),2 AS Q$(17),15 AS Q$(18),15 AS Q$(19),26 AS X$
	FIELD #1,64 AS X$,3 AS Q$(20),3 AS Q$(21),6 AS Q$(22),8 AS Q$(23),6 AS X$
	FIELD #1,84 AS X$,2 AS Q$(24),2 AS Q$(25),2 AS Q$(26)
	FOR X=0 TO 14:LSET Q$(X+1)=MKI$(NG1%(X)):NEXT
	FOR X=0 TO 3:LSET Q$(20+X)=YN1$(X):NEXT
	FOR X=1 TO 3:LSET Q$(X+23)=MKI$(NG1%(X+14)):NEXT
	LSET Q$(16)=MKI$(0):LSET Q$(17)=MKI$(0)
	LSET Q$(18)=VT1$:LSET Q$(19)=W1$
	PUT #1,I
CLOSE 1
	RETURN

6106 END SUB

SUB STATCONVERT (Q,QQ)
	FOR XX=4 TO 11
	IF MID$(B$(Q),XX,1)=" " OR MID$(B$(Q),XX,1)="." THEN MID$(B$(Q),XX,1)="_"
	NEXT XX
	FOR XX=12 TO 14
	IF MID$(B$(Q),XX,2)="ST" THEN MID$(B$(Q),9,1)="_":MID$(B$(Q),10,2)="ST"
	NEXT XX
	QQ = 8
	FOR XX = 11 TO 4 STEP -1
	IF MID$(B$(Q),XX,1) = "_" THEN QQ = XX-4: GOTO 6615
	GOTO 6620

6615 NEXT XX

6620 END SUB

'$INCLUDE: 'KeyInput.BM'
