10 REM **************** REVISED NOVEMBER 1, 1988 ****************************
REM: THIS PROGRAM IS USED TO ADD EXTRA ACTUAL STATS TO THE COURTSIDE
REM: TEAM FILES. THESE STATS GO IN THE FILE COLBBTMS.XXX


20 DIM A$(13),A(13,6),Q$(250),X(13,6), DF(13),P$(13),RS(13,13),T1%(20)
30 DIM W$(11),N$(13),V$(500)
40 OPEN "UDEV.BAS" FOR INPUT AS #2:INPUT #2,D$(0):CLOSE 2
100 COLOR 12,0:CLS:LOCATE ,32:PRINT "TEAM EDIT/EXPORT":PRINT
    COLOR 14:PRINT "(1) ";:COLOR 15:PRINT "EDIT AN EXISTING TEAM":PRINT
    COLOR 14:PRINT "(2) ";:COLOR 15:PRINT "EXPORT A TEAM TO A NEW DISK ID":PRINT
    COLOR 14:PRINT "(3) ";:COLOR 15:PRINT "PRINT A TEAM ROSTER":PRINT
    COLOR 14:PRINT "(4) ";:COLOR 15:PRINT "RETURN TO DRAFT/TRADE MENU"
105 I$=INKEY$:IF I$="" THEN 105
    D1=VAL(I$)
    IF D1<1 OR D1>4 THEN 105
    ON D1 GOTO 56,56,56,880
56 COLOR 15,0:CLS
   JJ=6
   SN=1:LOCATE 6,8:COLOR 15,4
   PRINT " Ö"; STRING$(61,196);"· ";:FOR II=1 TO JJ:LOCATE 6+II,8
   PRINT " º"; STRING$(61,32); "º ";:NEXT
   LOCATE 7+JJ,8
   PRINT " Ó";STRING$(61,196); "½ ";:LOCATE 7,32
   LOCATE ,12:PRINT "ENTER DISK ID: ":PRINT
   LOCATE ,12:PRINT "THE DISK ID IS USUALLY THE LAST TWO DIGITS OF THE"
   LOCATE ,12:PRINT "SEASON DISK YOU ARE PLAYING FROM (IE. 89, 76, 67)."
   LOCATE 7,27:INPUT NY$
   COLOR 15,0
   GOSUB 4105
   IF NY$="" THEN GOSUB 1102:GOTO 60
   YN$=NY$
   FOR I=1 TO 500:V$(I)="":NEXT
57 GOSUB 1100
60 IF BO%=1 THEN BO%=0:GOTO 56
58 LOCATE 2,33:COLOR T%(0),T%(1):PRINT A$
   COLOR 15,4:LOCATE ,33:PRINT "ANY CHANGE (YN)";
   I$=INKEY$:IF I$="" THEN 58
59 IF UCASE$(I$)="Y" THEN 56
   COLOR 15,0
   IF D1=3 THEN GOSUB 620:GOTO 100
   IF D1=2 THEN 300
   GOTO 1600
145 CLS:COLOR 14:PRINT "CHANGE LEAGUE INFORMATION":X%=2:COLOR 15
147 LOCATE 2:INPUT " 1. TEAM NUMBER ";T1:IF C1=1 THEN 190
162 LOCATE 3:INPUT " 2. DISK ID ";YN$:IF C1=1 THEN 190
163 LOCATE 4:INPUT " 3. TEAM NAME ";A$:IF C1=1 THEN 190
148 LOCATE 5:INPUT " 4. TEAM STAMINA RATING ";SP:IF C1=1 THEN 190
149 LOCATE 6:INPUT " 5. DEF FG% ADJ ";DA:IF C1=1 THEN 190
150 LOCATE 7:INPUT " 6. DEF 3FGA/FGA ADJ ";V1%:IF C1=1 THEN 190
151 LOCATE 8:INPUT " 7. DEF 3FG% ADJ ";V2%:IF C1=1 THEN 190
152 LOCATE 9:INPUT " 8. OFF STEAL RATING ";L%(0):IF C1=1 THEN 190
153 LOCATE 10:INPUT " 9. OFF TURNOVER RATING ";L%(1):IF C1=1 THEN 190
154 LOCATE 11:INPUT "10. DEF TURNOVER ADJ ";L%(2):IF C1=1 THEN 190
155 LOCATE 12:INPUT "11. DEF FOUL ADJ ";L%(3):IF C1=1 THEN 190
156 LOCATE 13:INPUT "12. ENTER 99 IF USING 6-9 ";L%(4):IF C1=1 THEN 190
157 LOCATE 14:INPUT "13. TEXT COLOR (0-15) ";T%(0):IF C1=1 THEN 190
158 LOCATE 15:INPUT "14. BACKGROUND (0-7) ";T%(1):IF C1=1 THEN 190
159 LOCATE 16:INPUT "15. TEAM FGA/G ";T%(3):IF C1=1 THEN 190
160 LOCATE 17:INPUT "16. LEAGUE FGA/G ";T%(4):IF C1=1 THEN 190
161 LOCATE 18:INPUT "17. TEAM GAMES PLAYED ";T%(5):IF C1=1 THEN 190
164 LOCATE 19:INPUT "18. HOMECOURT FACTOR ";T%(6):IF C1=1 THEN 190
165 S$="GYM"
190 INPUT "20. NICKNAME ";A1$
167 INPUT "21. COACH ";C$
168 INPUT "22. AVG ATTENDANCE ";ATT
169 INPUT "23. WINS ";T%(7)
170 INPUT "24. LOSSES ";T%(8)
171 INPUT "25. POWER RATING ";T%(9)
    INPUT "GAMES ";T1%(0)
    INPUT "TEAM FGA ";T1%(1)
    INPUT "OPP FGA ";T1%(2)
    INPUT "FG% ";T1%(3)
    INPUT "OPP FG% ";T1%(4)
    INPUT "TEAM FTA ";T1%(5)
    INPUT "OPP FTA ";T1%(6)
    INPUT "FT% ";T1%(7)
    INPUT "OPP FT% ";T1%(8)
    INPUT "REBOUNDS ";T1%(9)
    INPUT "OPP REB ";T1%(10)
    INPUT "ASST ";T1%(11)
    INPUT "OPP ASST ";T1%(12)
    INPUT "TEAM PF ";T1%(13)
    INPUT "OPP PF ";T1%(14)
    INPUT "TO ";T1%(15)
    INPUT "OPP TO ";T1%(16)
    INPUT "TEAM STL ";T1%(17)
    INPUT "OPP STL ";T1%(18)
    INPUT "OPP 3FGA ";T1%(19)
    INPUT "OPP 3 FG% ";T1%(20)
FOR I = 0 TO 13
    DF(I) = INT(RND(1) * 9) + 1
    IF A$(I) = "XXX" THEN 250
CLS:PRINT " 1. NAME ";A$(I) TAB(40) "17. GAMES ";RS(I, 0)
     PRINT " 2. POSITION ";P$(I) TAB(40) "18. MINUTES ";RS(I, 1)
     PRINT " 3. GAMES PLAYED ";X(I,0) TAB(40) "19. FGM ";RS(I, 3)
     PRINT " 4. ADJ FG% ";A(I,0) TAB(40) "20. FGA ";RS(I, 2)
     PRINT " 5. FT% ";A(I,1) TAB(40) "21. FTM ";RS(I, 5)
     PRINT " 6. OFF RB/40 MIN X 10 ";X(I,4) TAB(40) "22. FTA ";RS(I, 4)
     PRINT " 7. DEF RB/40 MIN X 10 ";A(I,2) TAB(40) "23. OFF REB ";RS(I, 6)
     PRINT " 8. ASSIST RATING ";A(I,4) TAB(40) "24. TOTAL REB ";RS(I, 7)
     PRINT " 9. STEAL RATING ";A(I,5) TAB(40) "25. PER FOULS ";RS(I, 8)
     PRINT "10. BLOCK RATING ";A(I,6) TAB(40) "26. ASSISTS ";RS(I, 9)
     PRINT "11. FGA ";X(I,1) TAB(40) "27. BLOCKS ";RS(I, 10)
     PRINT "12. FOUL COMMIT RATING ";X(I,5) TAB(40) "28. STEALS ";RS(I,11)
     PRINT "13. FOUL DRAWING RATING ";X(I,6) TAB(40) "29. 3 FGM ";RS(I, 13)
     PRINT "14. 3FG% ";X(I,2) TAB(40) "30. 3 FGA ";RS(I, 12)
     PRINT "15. 3FGA/TOT FGA ";X(I,3)
     PRINT "16. DEFENSIVE RATING (1-9) ";DF(I)
     INPUT " 2. POSITION ";P$(I)
     INPUT "17. GAMES ";RS(I, 0)
     INPUT "18. MINUTES ";RS(I, 1)
     INPUT "19. FGM ";RS(I, 3)
     INPUT "20. FGA ";RS(I, 2)
     INPUT "21. FTM ";RS(I, 5)
     INPUT "22. FTA ";RS(I, 4)
     INPUT "23. OFF REB ";RS(I, 6)
     INPUT "24. TOTAL REB ";RS(I, 7)
     INPUT "25. PER FOULS ";RS(I, 8)
     INPUT "26. ASSISTS ";RS(I, 9)
     INPUT "27. BLOCKS ";RS(I, 10)
     INPUT "28. STEALS ";RS(I,11)
     INPUT "29. 3 FGM ";RS(I, 13)
     INPUT "30. 3 FGA ";RS(I, 12)
250    NEXT

    GOTO 800
300 COLOR 15,0:CLS
    JJ=6
    SN=1:LOCATE 6,8:COLOR 15,4
    PRINT " Ö"; STRING$(61,196);"· ";:FOR II=1 TO JJ:LOCATE 6+II,8
    PRINT " º"; STRING$(61,32); "º ";:NEXT
    LOCATE 7+JJ,8
    PRINT " Ó";STRING$(61,196); "½ ";:LOCATE 7,32
    LOCATE ,12:PRINT "ENTER NEW DISK ID: ":PRINT
    LOCATE 7,31:INPUT NY$
    LOCATE ,12:PRINT "IS THIS CORRECT (YN)"
305 I$=INKEY$:IF I$="" THEN 305
    IF UCASE$(I$)<>"N" THEN NID%=1:GOSUB 9800:GOTO 100
    GOTO 300
620 CLS:LPRINT"TEAM ROSTER FOR ";A$
630 LPRINT:LPRINT"AVG SHOTS PER GAME = ";T%(3)"      DEF FG ADJ = ";DA
640 LPRINT"OPP PCT OF 3FG ATT ADJ = ";V1%;"  OPP 3FG PCT ADJ = ";V2%:LPRINT
    LPRINT"DEF STEAL ADJ ";L%(0)
    LPRINT "OFF TURNOVER ADJ ";L%(1)
    LPRINT "DEF TURNOVER ADJ ";L%(2)
    LPRINT "OFF FOUL ADJ ";L%(3)
    LPRINT
650 LPRINT"NAME-          FG  FT ORB DRB  CX PS  D  B FC FD  3FG 3FG%":LPRINT
660 FOR I=0 TO 13
    IF A$(I)="XXX" THEN 670
    LPRINT A$(I) TAB(15);
    LPRINT USING "### ### ### ### ### ";A(I,0),A(I,1),X(I,4),A(I,2),A(I,3);
    LPRINT USING "## ## ## ## ## ### ###";A(I,4),A(I,5),A(I,6),X(I,5),X(I,6),X(I,3),X(I,2)
670 NEXT I
680 LPRINT:LPRINT"FG- FIELD GOAL %                 B- BLOCK SHOT RATING"
690 LPRINT"FT- FREE THROW %                FC- FOUL COMMIT RATING"
700 LPRINT"RB- REBOUNDING RATING           FD- FOUL DRAWING RATING"
710 LPRINT"CX- CONTRIBUTION FACTOR        3FG- 3FGA/TOTAL FGA"
720 LPRINT"PS- PASSING RATING            3FG%- THREE POINT GOAL %"
730 LPRINT" D- DEFENSIVE RATING"
760 RETURN
800 CLS:COLOR T%(0),T%(1):PRINT A$:COLOR 14,0
    PRINT "PLAYER          CONTRIBUTION"
    PRINT "                PERCENT"
    COLOR 15,0
    T3=0
    FOR I=0 TO 13
    PRINT USING "## ";I+1;:PRINT A$(I);
    LOCATE ,17:PRINT A(I,3):LOCATE,1
    T3=T3+A(I,3)
    NEXT I
    PRINT
    COLOR 14:PRINT "TOTAL CP ";:LOCATE,17:COLOR 15,0:PRINT T3
805 LOCATE 21:PRINT "SELECT PLAYER TO CHANGE 1-14 (0-NO MORE CHANGE) ";
    INPUT X9
    IF X9<1 OR X9>14 THEN 825
    X9=X9-1
    LOCATE 22,18:PRINT A$(X9):LOCATE,1
    LOCATE 23,1
    INPUT "ENTER CP: ";A(X9,3)
    GOTO 800
825 IF T3>98 AND T3<102 THEN 840
    CLS
    GOSUB 4500
    U$="TOTAL CONTRIBUTION MUST BE 100 %"
    LOCATE ,(80-LEN(U$))/2
    PRINT U$
    U$="HIT ANY KEY TO CONTINUE"
    LOCATE ,(80-LEN(U$))/2
    PRINT U$
    COLOR 15,0
830 I$=INKEY$:IF I$="" THEN 830
    GOTO 800
840 CLS
    IF UCASE$(LEFT$(D$(0),1))="C" THEN 860
    GOSUB 4500
    U$="INSERT TEAMS DISK IN DRIVE "+D$(0)
    LOCATE ,(80-LEN(U$))/2
    PRINT U$
    U$="HIT ANY KEY TO CONTINUE"
    LOCATE ,(80-LEN(U$))/2
    PRINT U$
    COLOR 15,0
850 I$=INKEY$:IF I$="" THEN 850
860 GOSUB 9800
870 GOTO 100
880 CLS
    GOSUB 4500
    U$="INSERT DRAFT/TRADE PROGRAM DISK IN DRIVE "
    LOCATE ,(80-LEN(U$))/2
    PRINT U$
    U$="HIT ANY KEY TO CONTINUE"
    LOCATE ,(80-LEN(U$))/2
    PRINT U$
    COLOR 15,0
881 I$=INKEY$:IF I$="" THEN 881
    RUN "UTIL.EXE"
    END
     END
1100 OPEN D$(0)+"BASK."+YN$ AS #1 LEN=655
     Y=LOF(1)
     FIELD #1,15 AS Q$(0),640 AS X$
     FOR I1=1 TO Y/655
     GET #1,I1
     V$(I1)=Q$(0)
    NEXT
    CLOSE 1
    NT=Y/655
TS%=INT((NT-1)/80)
1102 NS%=0
1101 COLOR ,4:CLS:LOCATE ,33:COLOR 14:PRINT "TEAM SELECTION":COLOR 15
    FOR X=1 TO 20
    LOCATE 3+X,1:PRINT V$(NS%*80+X);
    LOCATE ,21:PRINT V$(NS%*80+20+X);
    LOCATE ,41:PRINT V$(NS%*80+40+X);
    LOCATE ,61:PRINT V$(NS%*80+60+X)
    NEXT
    LOCATE 25,1:COLOR 14:PRINT "ESC";:COLOR 15:PRINT "-SELECT NEW ID  PGDN  PGUP  ";:COLOR 14:PRINT "ENTER";:COLOR 15:PRINT "-SELECTS TEAM";
    LOCATE 4,1:COLOR 0,7:PRINT V$(NS%*80+1);:COLOR 15,4
1108 X=INT((POS(X)-1)/20)+1:Y=CSRLIN
1109 I$=INKEY$:IF I$="" THEN 1109
    IF I$=CHR$(0)+"Q" THEN 1110
    IF I$=CHR$(0)+"I" THEN 1120
    IF I$=CHR$(0)+"G" THEN NS%=0:GOTO 1101
    IF I$=CHR$(0)+"O" THEN NS%=TS%:GOTO 1101
    IF I$=CHR$(0)+"H" THEN 1130
    IF I$=CHR$(0)+"M" THEN 1135
    IF I$=CHR$(0)+"P" THEN 1140
    IF I$=CHR$(0)+"K" THEN 1145
    IF I$=CHR$(27) THEN BO%=1:RETURN
    IF I$=CHR$(13) THEN 1190
1110 REM *** PAGE DOWN ***
    IF NS%=TS% THEN 1108
    NS%=NS%+1:GOTO 1101
1120 REM *** PAGE UP ***
    IF NS%=0 THEN 1108
    NS%=NS%-1:GOTO 1101
1130 REM *** CURSOR UP ***
    IF Y<4 THEN 1108
    GOSUB 1150
    Y=Y-1:IF Y<4 THEN Y=4
    GOSUB 1151
    GOTO 1108
1135 REM *** CURSOR RIGHT ***
    IF X=4 THEN 1108
    IF NS%*80+Y-3+(X)*20>NT THEN 1108
    GOSUB 1150
    X=X+1:IF X>=4 THEN X=4
    GOSUB 1151
    GOTO 1108
1140 REM *** CURSOR DOWN ***
    IF Y>=23 THEN 1108
    IF NS%*80+Y+1-3+(X-1)*20>NT THEN 1108
    GOSUB 1150
    Y=Y+1:IF Y>=23 THEN Y=23
    GOSUB 1151
    GOTO 1108
1145 REM *** CURSOR LEFT ***
    IF X=1 THEN 1108
    GOSUB 1150
    X=X-1:IF X<=1 THEN X=1
    GOSUB 1151
    GOTO 1108
1150 LOCATE Y,(X-1)*20+1:COLOR 15,4
    PRINT V$(Y-3+(X-1)*20+NS%*80);
    RETURN
1151 COLOR 0,7:LOCATE Y,(X-1)*20+1
    PRINT V$(Y-3+(X-1)*20+NS%*80);
    COLOR 15,4
    RETURN
1190 T1=NS%*80+Y-3+(X-1)*20:GOTO 9000
1600 CLS:COLOR 14
     PRINT"CHANGE LEAGUE INFORMATION":X%=2:COLOR 15
     PRINT " 1. TEAM NUMBER ";T1
     PRINT " 2. DISK ID ";YN$
     PRINT " 3. TEAM NAME ";A$  TAB (40) "20. NICKNAME ";A1$
     PRINT " 4. TEAM STAMINA RATING ";SP TAB(40) "21. COACH ";C$
     PRINT " 5. DEF FG% ADJ ";DA
     PRINT " 6. DEF 3FGA/FGA ADJ ";V1% TAB(40) "22. AVG ATTENDANCE ";ATT
     PRINT " 7. DEF 3FG% ADJ ";V2% TAB(40) "23. WINS ";T%(7)
     PRINT " 8. OFF STEAL RATING ";L%(0) TAB(40) "24. LOSSES ";T%(8)
     PRINT " 9. OFF TURNOVER RATING ";L%(1) TAB(40) "25. POWER RATING ";T%(9)
     PRINT "10. DEF TURNOVER ADJ ";L%(2)
     PRINT "11. DEF FOUL ADJ ";L%(3)
     PRINT "12. ENTER 99 IF USING 6-9 ";L%(4)
     PRINT "13. TEXT COLOR (0-15) ";T%(0)
     PRINT "14. BACKGROUND (0-7) ";T%(1)
     PRINT "15. TEAM FGA/G ";T%(3)
     PRINT "16. LEAGUE FGA/G ";T%(4)
     PRINT "17. TEAM GAMES PLAYED ";T%(5)
     PRINT "18. HOMECOURT FACTOR ";T%(6)
     PRINT "19. ARENA NAME ";S$
     GOTO 165
1835 CLS:PRINT "CHANGE PLAYERS":X%=2
    FOR I=0 TO 6
    LOCATE I+5,5:PRINT USING "##";I+1;:PRINT " "A$(I) TAB(40);:PRINT USING "##";I+8;:PRINT " "A$(I+7):NEXT
    PRINT
1855 PRINT "# TO CHANGE (1-14) (0 TO CONTINUE) ";:INPUT I
1865 I=I-1
1875 IF I<0 OR I>13 THEN X%=0:GOTO 800
4091 I$=INKEY$:IF I$="" THEN 4091
     RETURN
4105 CLS
     IF UCASE$(LEFT$(D$(0),1))="C" THEN 4115
     GOSUB 4500
     U$="INSERT TEAMS DISK IN DRIVE "+D$(0)
     LOCATE ,(80-LEN(U$))/2
     PRINT U$
     U$="HIT ANY KEY TO CONTINUE"
     LOCATE ,(80-LEN(U$))/2
     PRINT U$
     COLOR 15,0
4110 I$=INKEY$:IF I$="" THEN 4110
4115 RETURN
4500 JJ=4
     LOCATE 6,8:COLOR 15,1
     PRINT " ";CHR$(201) STRING$(61,205);CHR$(187)" ";
     FOR II=1 TO JJ:LOCATE 6+II,8
     PRINT " º"; STRING$(61,32); "º ";:NEXT
     LOCATE 7+JJ,8
     PRINT " ";CHR$(200) STRING$(61,205); CHR$(188)" " ;:LOCATE 7
     RETURN
9000 OPEN D$(0)+"BASK."+YN$ AS #1 LEN=655
FIELD #1,15 AS Q$(0),2 AS Q$(1),2 AS Q$(2),2 AS Q$(3),2 AS Q$(4),2 AS Q$(5),2 AS Q$(6),2 AS Q$(7),2 AS Q$(8),2 AS Q$(9),2 AS Q$(10),2 AS Q$(11),2 AS Q$(12),2 AS Q$(13),2 AS Q$(14),2 AS Q$(15),2 AS Q$(16),2 AS Q$(17),2 AS Q$(18),2 AS Q$(19),602 AS _
X$
FOR I=0 TO 13
FIELD #1,53+I*43 AS X$,15 AS Q$(I*15+20),2 AS Q$(I*15+21),2 AS Q$(I*15+22),2 AS Q$(I*15+23),2 AS Q$(I*15+24),2 AS Q$(I*15+25),2 AS Q$(I*15+26),2 AS Q$(I*15+27),2 AS Q$(I*15+28),2 AS Q$(I*15+29),2 AS Q$(I*15+30),2 AS Q$(I*15+31),2 AS Q$(I*15+32),2 _
AS Q$(I*15+33),2 AS Q$(I*15+34),655-53-43-I*43 AS X$
NEXT
GET #1,T1
   A$=Q$(0)
9005 IF RIGHT$(A$,1)=" " THEN A$=LEFT$(A$,LEN(A$)-1):GOTO 9005
     SP=CVI(Q$(1)):DA=CVI(Q$(2)):V1%=CVI(Q$(3)):V2%=CVI(Q$(4))
     FOR I=0 TO 4:L%(I)=CVI(Q$(I+5)):NEXT
     FOR I=0 TO 9:T%(I)=CVI(Q$(I+10)):NEXT
     FOR I=0 TO 13
     A$(I)=Q$(I*15+20)
9007 IF RIGHT$(A$(I),1)=" " THEN A$(I)=LEFT$(A$(I),LEN(A$(I))-1):GOTO 9007
     FOR I1=0 TO 6
     A(I,I1)=CVI(Q$(I*15+I1+21))
     X(I,I1)=CVI(Q$(I*15+I1+28))
     NEXT:NEXT
     CLOSE 1

OPEN D$(0)+"COLBBTMS."+YN$ AS #1 LEN=566
FIELD #1,15 AS Q$(0),40 AS Q$(1),15 AS Q$(2),4 AS Q$(3)
FOR I=0 TO 13
FIELD #1,74+I*32 AS X$,2 AS Q$(I*16+4),2 AS Q$(I*16+5),2 AS Q$(I*16+6),2 AS Q$(I*16+7),2 AS Q$(I*16+8),2 AS Q$(I*16+9),2 AS Q$(I*16+10),2 AS Q$(I*16+11),2 AS Q$(I*16+12),2 AS Q$(I*16+13),2 AS Q$(I*16+14),2 AS Q$(I*16+15),2 AS Q$(I*16+16),2 AS Q$(I_
*16+17),2 AS Q$(I*16+18),2 AS Q$(I*16+19)
FIELD #1, 522 AS X$,2 AS Q$(228),2 AS Q$(229),2 AS Q$(230),2 AS Q$(231),2 AS Q$(232),2 AS Q$(233),2 AS Q$(234),2 AS Q$(235),2 AS Q$(236),2 AS Q$(237),2 AS Q$(238),2 AS Q$(239),2 AS Q$(240),2 AS Q$(241),2 AS Q$(242),2 AS Q$(243),2 AS Q$(244),2 AS  _
Q$(245),2 AS Q$(246),2 AS Q$(247),2 AS Q$(248),2 AS Q$(249)
NEXT
GET #1, T1
     C$ = Q$(0)
     S$ = Q$(1)
     A1$ = Q$(2)
     ATT = CVL(Q$(3))

     FOR I=0 TO 13
     DF(I) = CVI(Q$(I*16+4))
     P$(I) = Q$(I*16+5)
     FOR I1=0 TO 13
     RS(I, I1) = CVI(Q$(I*16+I1+6))
     NEXT:NEXT
     FOR I = 0 TO 20
     T1%(I) = CVI(Q$(228+I))
     NEXT
     CK = CVI(Q$(249))
     CLOSE 1
IF CK <> 999 THEN
   C$="":S$="":A1$="":ATT=0
   FOR I = 0 TO 13:DF(I) = 5:P$(I) = ""
   FOR I1 = 0 TO 13:RS(I,I1)=0
   NEXT:NEXT
   FOR I=0 TO 20:T1%(I)=0:NEXT
END IF



9180 RETURN
9200 OPEN D$(0)+"BASK."+NY$ AS #1 LEN=655
     Y=LOF(1)/655
     CLOSE 1
     T1=Y+1
     RETURN
9800 IF NID%=1 THEN GOSUB 9200:YN$=NY$
     OPEN D$(0)+"BASK."+YN$ AS #1 LEN=655
FIELD #1,15 AS Q$(0),2 AS Q$(1),2 AS Q$(2),2 AS Q$(3),2 AS Q$(4),2 AS Q$(5),2 AS Q$(6),2 AS Q$(7),2 AS Q$(8),2 AS Q$(9),2 AS Q$(10),2 AS Q$(11),2 AS Q$(12),2 AS Q$(13),2 AS Q$(14),2 AS Q$(15),2 AS Q$(16),2 AS Q$(17),2 AS Q$(18),2 AS Q$(19),602 AS _
X$
FOR I=0 TO 13
FIELD #1,53+I*43 AS X$,15 AS Q$(I*15+20),2 AS Q$(I*15+21),2 AS Q$(I*15+22),2 AS Q$(I*15+23),2 AS Q$(I*15+24),2 AS Q$(I*15+25),2 AS Q$(I*15+26),2 AS Q$(I*15+27),2 AS Q$(I*15+28),2 AS Q$(I*15+29),2 AS Q$(I*15+30),2 AS Q$(I*15+31),2 AS Q$(I*15+32),2 _
AS Q$(I*15+33),2 AS Q$(I*15+34),655-53-43-I*43 AS X$
NEXT
     LSET Q$(0)=A$:LSET Q$(1)=MKI$(SP):LSET Q$(2)=MKI$(DA):LSET Q$(3)=MKI$(V1%)
     LSET Q$(4)=MKI$(V2%):FOR I=0 TO 4:LSET Q$(I+5)=MKI$(L%(I)):NEXT
     T%(2)=999
     FOR I=0 TO 9:LSET Q$(I+10)=MKI$(T%(I)):NEXT
     FOR I=0 TO 13
     LSET Q$(I*15+20)=A$(I)
     FOR I1=0 TO 6
     LSET Q$(I*15+I1+21)=MKI$(A(I,I1))
     LSET Q$(I*15+I1+28)=MKI$(X(I,I1))
     NEXT:NEXT
     PUT #1,T1:CLOSE 1

OPEN D$(0)+"COLBBTMS."+YN$ AS #1 LEN=566
FIELD #1,15 AS Q$(0),40 AS Q$(1),15 AS Q$(2),4 AS Q$(3)
FOR I=0 TO 13
FIELD #1,74+I*32 AS X$,2 AS Q$(I*16+4),2 AS Q$(I*16+5),2 AS Q$(I*16+6),2 AS Q$(I*16+7),2 AS Q$(I*16+8),2 AS Q$(I*16+9),2 AS Q$(I*16+10),2 AS Q$(I*16+11),2 AS Q$(I*16+12),2 AS Q$(I*16+13),2 AS Q$(I*16+14),2 AS Q$(I*16+15),2 AS Q$(I*16+16),2 AS Q$(I_
*16+17),2 AS Q$(I*16+18),2 AS Q$(I*16+19)
FIELD #1, 522 AS X$,2 AS Q$(228),2 AS Q$(229),2 AS Q$(230),2 AS Q$(231),2 AS Q$(232),2 AS Q$(233),2 AS Q$(234),2 AS Q$(235),2 AS Q$(236),2 AS Q$(237),2 AS Q$(238),2 AS Q$(239),2 AS Q$(240),2 AS Q$(241),2 AS Q$(242),2 AS Q$(243),2 AS Q$(244),2 AS  _
Q$(245),2 AS Q$(246),2 AS Q$(247),2 AS Q$(248),2 AS Q$(249)
NEXT
     LSET Q$(0)=C$
     LSET Q$(1)=S$
     LSET Q$(2)=A1$
     LSET Q$(3)=MKL$(ATT)

     FOR I=0 TO 13
     LSET Q$(I*16+4)=MKI$(DF(I))
     LSET Q$(I*16+5)=P$(I)
     FOR I1=0 TO 13
     LSET Q$(I*16+I1+6)=MKI$(RS(I,I1))
     NEXT:NEXT
     FOR I = 0 TO 20
     LSET Q$(228 + I) = MKI$(T1%(I))
     NEXT
     LSET Q$(249) = MKI$(999)
     PUT #1,T1:CLOSE 1
10010 RETURN
