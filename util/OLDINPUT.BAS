'$INCLUDE: 'KeyInput.BI'

2 DIM Q$(500),E0(16),XX(13),X(14,6),T%(9),L%(9),A(14,19),FGM(13)
DIM A1$(6),A2$(5),A3$(2),A4$(2),A5$(2),A6$(2),N$(14)

3 DIM B6(7),A0(6),A1(6),A2(6),A3(6),A4(5),A5(5),A6(2),A7(2)
DIM A8(2),A9(2),B(2),B1(2),B2(2),B3(2)
OPEN "DEV.BAS" FOR INPUT AS #1:INPUT #1,D$(0):CLOSE 1

300 CLS

303 PRINT "COLLEGE"
	L7=6:L3=19:L6=14
	IF H=1 THEN L7=5:L6=11:L3=16

304  LOCATE 3,1:INPUT "1. SEASON FGA/G ";L1:IF C1=1 THEN 310

305  IF L1=999 THEN 11

306  LOCATE 4,1:INPUT "2. SEASON RB/G ";L2:IF C1=1 THEN 310

307  LOCATE 5,1:INPUT "3. SEASON FG % ";L4:IF C1=1 THEN 310

308  LOCATE 6,1:INPUT "4. SEASON AVG RATING ";R:IF C1=1 THEN 310

1100 LOCATE 7,1:INPUT "5. CONF AVG RATING ";R1:IF C1=1 THEN 310

1101 LOCATE 8,1:INPUT "6. SEASON 3 FGA/FGA % ";Q7:IF C1=1 THEN 310

1102 LOCATE 9,1:INPUT "7. SEASON 3 FG % ";Q8:IF C1=1 THEN 310

310  C1=1:LOCATE 22,1:INPUT "# TO CHANGE (0 TO CONTINUE)";B9
	ON B9 GOTO 304,306,307,308,1100,1101,1102

311 C1=0
	L3=19:IF H=1 THEN L3=16

312 CLS
	PRINT X$(H)

313 LOCATE 3,1:INPUT " 1. TEAM # ";T:IF C1=1 THEN 326
	IF T = 999 THEN 300

314 LOCATE 4,1:INPUT " 2. NAME ";A$:IF C1=1 THEN 326

315 LOCATE 5,1:INPUT " 3. RATING ";R3:IF C1=1 THEN 326

316 LOCATE 6,1:INPUT " 4. TM FGA ";T1:IF C1=1 THEN 326

317 LOCATE 7,1:INPUT " 5. TM FG% ";T6:IF C1=1 THEN 326

318 LOCATE 8,1:INPUT " 6. TM FTA ";T7:IF C1=1 THEN 326

319 LOCATE 9,1:INPUT " 7. TM FT% ";T8:IF C1=1 THEN 326

320 LOCATE 10,1:INPUT " 8. TM REB ";T3:IF C1=1 THEN 326

321 LOCATE 11,1:INPUT " 9. TM STL ";T9:IF C1=1 THEN 326

322 LOCATE 12,1:INPUT "10. TM AST ";T0:IF C1=1 THEN 326

323 LOCATE 13,1:INPUT "11. OPP FGA ";T2:IF C1=1 THEN 326

327 LOCATE 14,1:INPUT "12. OPP FGM ";OFGM:IF C1=1 THEN 326

325 LOCATE 15,1:INPUT "13. OPP FTA ";BF:IF C1=1 THEN 326

324 LOCATE 16,1:INPUT "14. OPP REB ";T4:IF C1=1 THEN 326

1110 LOCATE 17,1:INPUT "15. GAMES ";L5:IF C1=1 THEN 326

1111 LOCATE 18,1:INPUT "16. OPP 3 FGA ";W0:IF C1=1 THEN 326

1112 LOCATE 19,1:INPUT "17. OPP 3 FGA % ";W1:IF C1=1 THEN 326

1113 LOCATE 20,1:INPUT "18. DISK ID (IE. 88,65,FF) ";YN$:IF C1=1 THEN 326

1114 LOCATE 21,1:INPUT "19. HOMECOURT FACTOR (0-6) ";T%(6):IF C1=1 THEN 326

326 C1=1:LOCATE 22,1:INPUT "# TO CHANGE (0 TO CONTINUE) ";B9
	ON B9 GOTO 313,314,315,316,317,318,319,320,321,322,323,327,325,324,1110,1111,1112,1113,1114

328 C1=0
	F3=40:IF H=1 THEN F3=32

330 FOR I=0 TO 13:CLS
	PRINT X$(H);" PLAYER- ";I+1

331 LOCATE 3,1:INPUT   " 1. NAME ";N$(I):IF C1=1 THEN 343
	IF N$(I)="XXX" THEN FOR I=I TO 13:N$(I)="XXX":NEXT:GOTO 347

332 LOCATE 4,1:INPUT " 2. GAMES ";A(I,7):X(I,0)=A(I,7):IF C1=1 THEN 343

333 LOCATE 5,1:INPUT " 3. MP ";A(I,8):IF C1=1 THEN 343

334 LOCATE 6,1:INPUT " 4. FGA ";A(I,9):X(I,1)=A(I,9):IF C1=1 THEN 343

342 LOCATE 7,1:INPUT " 5. FGM ";FGM(I):IF C1=1 THEN 343

335 LOCATE 8,1:INPUT " 6. FG% ";A(I,0):IF C1=1 THEN 343

336 LOCATE 9,1:INPUT " 7. FTA ";A(I,16):IF C1=1 THEN 343

337 LOCATE 10,1:INPUT " 8. FT% ";A(I,1):IF C1=1 THEN 343

338 LOCATE 11,1:INPUT " 9. REB ";A(I,10):IF C1=1 THEN 343

339 LOCATE 12,1:INPUT "10. AST ";A(I,11):IF C1=1 THEN 343

340 LOCATE 13,1:INPUT "11. PF ";A(I,12):IF C1=1 THEN 343

341 LOCATE 14,1:INPUT "12. STL ";A(I,13):IF C1=1 THEN 343

1120 LOCATE 15,1:INPUT "13. BLK ";A(I,14):IF C1=1 THEN 343

1121 LOCATE 16,1:INPUT "14. 3FGA ";A(I,17):IF C1=1 THEN 343

1122 LOCATE 17,1:INPUT "15. 3 FG % ";A(I,18):X(I,2)=A(I,18):IF C1=1 THEN 343

343 C1=1:LOCATE 22,1:INPUT "# TO CHANGE (0 TO CONTINUE) ";B9

344 ON B9 GOTO 331,332,333,334,342,335,336,337,338,339,340,341,1120,1121,1122

345 C1=0

346 NEXT I

347 X9=0
	FOR I=0 TO 13
	X9=X9+A(I,10)+A(I,9)
	NEXT I

348 FOR I=0 TO 13
	IF N$(I)="XXX" THEN 356
	IF A(I,8)<>0 AND H=0 THEN M=40/(A(I,8)/A(I,7))

349 IF A(I,8)<>0 AND H=1 THEN M=32/(A(I,8)/A(I,7))

350 IF A(I,8)=0 THEN M=(X9/5)/(A(I,9)+A(I,10))

351 IF A(I,8)=0 AND M<1 THEN M=1

352 A(I,2)=INT((((A(I,10)/A(I,7))*M)*35/L2)+.5)

353 A(I,4)=INT(((A(I,11)/A(I,7))*M)*(L6/(T0/L5))+.5)

354 A(I,5)=INT(((A(I,13)/A(I,7))*M)*(L7/(T9/L5))+.5)

355 A(I,6)=((A(I,14)/A(I,7))*M):A(I,6)=INT(A(I,6)+.5)

356 NEXT I
	X=L1+L2+L3
	Y=(T1+T2+T3+T4+(F3*L5))/(2*L5)

357 S=INT(((2*Y)-X)+.5)
	X=BF*.75-.1*OFGM-7.5*L5
	X=(X/2/(X/2+T2))-.07
	IF X<0 THEN 9015
	X=INT(X*100+.5)
	GOTO 9020

9015 X=ABS(X):X=INT(X*100+.5)*-1+100

9020 FGA=INT((T1+T2)/(2*L5)+.5)
	L%(3)=X
	L%(0)=4:L%(1)=4
	L%(2)=0:V1%=0
	V2%=0
	L%(4)=99
	T%(5)=L5
	T%(4)=L1
	T%(3)=FGA
	L%(3)=L%(3)+1
	IF L%(3)>=100 THEN L%(3)=L%(3)-100

358 J=INT((((T1+T2)/(L5*2))*T6)/100)

359 J1=J-INT(((R3-R)/2)+.5)

360 J2=INT((J1/((T1+T2)/(L5*2)))*100)
	U7=INT((46-L4)/2)

361 D=J2-L4

362 IF T8<68 THEN D=D-1

363 IF T8<64 THEN D=D-1

364 IF T8>72 THEN D=D+1

365 IF T8>76 THEN D=D+1

366 FOR I=0 TO 13
	IF N$(I)="XXX" THEN 368
	A(I,3)=(A(I,9)+A(I,10))/X9
	A(I,3)=INT((100*A(I,3))+.5)

368 NEXT I

367 X=T7/T1

386 D=D-INT(((R-R1)/2)+.5)-U7

1130 V%=INT(((W0/T2)+.005)*100)

1131 V1%=V%-Q7
	IF V1%>0 THEN S=S+(V1%/100)

1132 IF V1%<0 THEN S=S+((100+V1%)/100)

1133 V1%=W1-Q8
	IF V1%>0 AND D>=0 THEN D=D+(V1%/100)

1134 IF V1%<0 AND D>=0 THEN D=D+((100+V1%)/100)

1135 IF V1%>0 AND D<0 THEN D=D-(V1%/100)

1136 IF V1%<0 AND D<0 THEN D=D-((100+V1%)/100)

1140 FOR I=0 TO 13
	IF N$(I)="XXX" THEN 1152

1141 A(I,2)=A(I,2)+(A(I,18)/100)

1142 A(I,3)=A(I,3)+(INT((A(I,17)/A(I,9))*100)/100)

1170 IF A(I,8)<>0 AND H=0 THEN M=40/(A(I,8)/A(I,7))

1171 IF A(I,8)<>0 AND H=1 THEN M=32/(A(I,8)/A(I,7))

1172 IF A(I,8)=0 THEN M=(X9/5)/(A(I,9)+A(I,10))

1173 IF A(I,8)=0 AND M<1 THEN M=1
	B3=(A(I,12)/A(I,7))*M
	B3=INT((B3*10)+.5)

1144 A(I,5)=INT(A(I,5)+.5)
	X(I,5)=B3

1145 B3=(A(I,9)/A(I,7))*M:B3=INT(B3+.5)

1146 A(I,4)=INT(A(I,4)+.5)+(B3/100)

1149 B3=A(I,9)*(A(I,0)/100):B4=A(I,17)*(A(I,18)/100)

1150 A(I,0)=((B3-B4)/(A(I,9)-A(I,17)))+.005

1151 A(I,0)=INT((A(I,0)*100)+.5)

1152 NEXT I
	FOR I=0 TO 13
	IF N$(I)="XXX" THEN 369
	A(I,0)=A(I,0)-INT(((R-R1)/2)+.5)+U7

369  NEXT I
	FOR I=0 TO 13
	IF N$(I)="XXX" THEN 374
	X=A(I,16)*.75-.1*FGM(I)-1.5*X(I,0)*A(I,3)/20
	X=INT(X/2/(X(I,1)+X/2)*100+.5)
	IF X<=0 THEN X=0
	X(I,6)=X

374 NEXT I
	GOSUB 1700:GOSUB 1800:GOSUB 1900:GOSUB 2100:GOTO 2300

1700 CLS:PRINT "INPUT ASSIST RATINGS"
	PRINT "AA SHOULD = APPROX. 3 WHEN FINISHED"
	PRINT "FORWARDS,CENTERS ARE USUALLY 0,1,2,3 ; GUARDS ARE USUALLY 3,4,5,6"

1701 C1=0
	PRINT
	FOR I=0 TO 13

1702 LOCATE I+6,1:PRINT I;" ";N$(I);:LOCATE I+6,20:INPUT E0(I)

1703 IF C1=1 THEN 1705

1704 NEXT I

1705 C1=1:GOSUB 1715:LOCATE 21,1:PRINT "ANY CHANGE (0-13) (N=NO CHANGE) "

1706 INPUT I$

1707 IF UCASE$(I$)="N" THEN 1709

1708 I=VAL(I$):GOTO 1702

1709 FOR I=0 TO 13
	A(I,4)=A(I,4)+E0(I)
	NEXT I
	C1=0
	RETURN

1715 AA=0
	FOR I1=0 TO 13
	AA=AA+E0(I1)*INT(A(I1,3))
	NEXT I1

1716 LOCATE 20,1
	PRINT "AA = ";AA/100
	RETURN

1800 C1=0:CLS
	PRINT "DO YOU NEED TO INPUT FOUL RATINGS (YN) ";

1806 I$=GetKeyPress$
	IF UCASE$(I$)<>"Y" THEN RETURN
	PRINT "INPUT FOUL COMMITING RATINGS"
	PRINT "PF SHOULD = APPROX. 40 WHEN FINISHED"

1801 PRINT "AVG. RATING = 40 ; RANGE = 15 TO 99"
	PRINT
	FOR I = 0 TO 13

1802 LOCATE I+6,1
	PRINT I;" ";N$(I);:LOCATE I+6,20:INPUT E0(I)

1803 IF C1=1 THEN 1805

1804 NEXT I

1805 C1=1:GOSUB 1815:LOCATE 21,1:PRINT "ANY CHANGE (0-13) (N=NO CHANGE) "
	INPUT I$

1807 IF UCASE$(I$)="N" THEN 1809

1808 I=VAL(I$):GOTO 1802

1809 FOR I=0 TO 13
	X(I,5)=E0(I)
	NEXT I
	C1=0
	RETURN

1815 PF=0
	FOR I1=0 TO 13
	PF=PF+E0(I1)
	NEXT I1

1816 LOCATE 20,1
	PRINT "PF = ";PF/10
	RETURN

1900 HQ=T1-T2
	HR=T7-BF
	GOSUB 2200
	HS=HS/2:HX=INT((HR+HS-HQ)+.5):HX=INT(((HX/L5)*10)+.5)

1901 CLS
	L%(4)=99
	PRINT "(IGNORE THIS JIM....) THIS TEAMS ST SHOULD = APPROX. ";HX/10

1902 PRINT "IND. STL RATINGS: AVG=1 RANGE = 0 TO 4"

1903 PRINT "TM OFF STL ADJ: AVG=0 RANGE=-10 TO 10":C1=0

1904 PRINT "TM TURNOVR RATING: AVG=4 RANGE = 1 TO 7"

1905 PRINT "TM DEF TRNOVR ADJ: AVG=0 RANGE -4 TO 4"
	FOR I = 0 TO 13

1906 LOCATE I+6,1:PRINT I;" ";N$(I);:LOCATE I+6,20
	INPUT E0(I)
	IF C1=1 THEN 1911

1907 NEXT I

1908 LOCATE 20,1:INPUT "X-TM OFF STL ADJ   ";E0(14):IF C1=1 THEN 1911

1909 LOCATE 21,1:INPUT "Y-TM TURNOVER ADJ  ";E0(15):IF C1=1 THEN 1911

1910 LOCATE 22,1:INPUT "Z-TM DEF TURNOVR ADJ";E0(16):IF C1=1 THEN 1911

1911 C1=1:GOSUB 1925
	LOCATE 23,1:PRINT "ANY CHANGE (0-Z) (N = NO CHANGE) ";

1913 INPUT I$
	IF UCASE$(I$)="N" THEN 1930

1914 I=VAL(I$)
	IF UCASE$(I$)="X" THEN 1908

1915 IF UCASE$(I$)="Y" THEN 1909

1916 IF UCASE$(I$)="Z" THEN 1910

1917 GOTO 1906

1925 ST=0:FOR I=0 TO 13:ST=ST+E0(I)*INT(A(I,3)):NEXT I

1926 ST=ST/20:SY=7+E0(14)*.4

1927 SV=(R*E0(15))/100:SW=((4+E0(16))*R)/100

1928 ST=ST-SY-SV+SW:LOCATE 10,26:PRINT "ST = ";ST;:RETURN

1930 FOR I=0 TO 13
	A(I,5)=A(I,5)+E0(I)
	NEXT I
	IF E0(14)<0 THEN E0(14)=100+E0(14)

1933 IF E0(16)<0 THEN E0(16)=100+E0(16)
	FOR I=0 TO 2
	L%(I)=E0(I+14)
	NEXT

1935 C1=0:RETURN

2100 CLS
	PRINT "INPUT BLOCK RATINGS"
	PRINT "GUARDS ARE USUALLY 0,1 ; FORWARDS,CENTERS ARE USUALLY 0,1,2,3"
	PRINT "THE GREAT SHOT BLOCKERS ARE USUALLY 5,6,7"
	PRINT

2101 C1=0
	FOR I=0 TO 13

2102 LOCATE I+6,1:PRINT I;" ";N$(I);:LOCATE I+6,20:INPUT E0(I)

2103 IF C1=1 THEN 2105

2104 NEXT I

2105 C1=1:GOSUB 2115:LOCATE 20,1:PRINT "ANY CHANGE (0-13) (N=NO CHANGE) ";

2106 INPUT I$

2107 IF UCASE$(I$)="N" THEN 2109

2108 I=VAL(I$):GOTO 2102

2109 FOR I=0 TO 13:A(I,6)=A(I,6)+E0(I):NEXT I:C1=0:RETURN

2115 RETURN

2200 HW=HR/350:IF HW>1 THEN HW=1

2201 HW=((HW*35)+32)/100:IF HW<0 THEN HW=HW*-1

2202 HR=HR*HW:RETURN

2300 V1%=INT((S-INT(S))*100+.5):PRINT "3FGA/FGA="V1%
	W6=D:IF W6<0 THEN W6=W6*-1
	V2%=INT((W6-INT(W6))*100+.5):PRINT "3FG% ADJ="V2%
	IF D>=0 THEN D=INT(D):GOTO 9207
	IF D<0 AND D-INT(D)>.0001 THEN D=INT(D)+1:GOTO 9207
	D=INT(D)

9207 PRINT "DEF FG ADJ="D
	T%(0)=0:T%(1)=7:T%(2)=999

9211 FOR I=0 TO 13
	X(I,2)=INT((A(I,2)-INT(A(I,2)))*100+.5)
	X(I,3)=INT((A(I,3)-INT(A(I,3)))*100+.5)
	'X(I,5)=INT((A(I,5)-INT(A(I,5)))*100+.5)
	X(I,4)=INT(A(I,2))*3.5
	A(I,2)=INT(A(I,2))*6.5
	A(I,0)=INT(A(I,0))
	A(I,1)=INT(A(I,1))
	FOR I1=3 TO 6
	A(I,I1)=INT(A(I,I1))
	NEXT:NEXT

9500 OPEN D$(0)+"BASK."+YN$ AS #1 LEN=655
FIELD #1,15 AS Q$(0),2 AS Q$(1),2 AS Q$(2),2 AS Q$(3),2 AS Q$(4),2 AS Q$(5),2 AS Q$(6),2 AS Q$(7),2 AS Q$(8),2 AS Q$(9),2 AS Q$(10),2 AS Q$(11),2 AS Q$(12),2 AS Q$(13),2 AS Q$(14),2 AS Q$(15),2 AS Q$(16),2 AS Q$(17),2 AS Q$(18),2 AS Q$(19),602 AS _
X$
PRINT NT,A$
FOR I=0 TO 13
FIELD #1,53+I*43 AS X$,15 AS Q$(I*15+20),2 AS Q$(I*15+21),2 AS Q$(I*15+22),2 AS Q$(I*15+23),2 AS Q$(I*15+24),2 AS Q$(I*15+25),2 AS Q$(I*15+26),2 AS Q$(I*15+27),2 AS Q$(I*15+28),2 AS Q$(I*15+29),2 AS Q$(I*15+30),2 AS Q$(I*15+31),2 AS Q$(I*15+32),2 _
AS Q$(I*15+33),2 AS Q$(I*15+34),655-53-43-I*43 AS X$
NEXT
	LSET Q$(0)=A$:LSET Q$(1)=MKI$(S):LSET Q$(2)=MKI$(D):LSET Q$(3)=MKI$(V1%)
	LSET Q$(4)=MKI$(V2%):FOR I=0 TO 4:LSET Q$(I+5)=MKI$(L%(I)):NEXT
	T%(2)=999
	FOR I=0 TO 9:LSET Q$(I+10)=MKI$(T%(I)):NEXT
	FOR I=0 TO 13
	LSET Q$(I*15+20)=N$(I)
	FOR I1=0 TO 6
	LSET Q$(I*15+I1+21)=MKI$(A(I,I1))
	LSET Q$(I*15+I1+28)=MKI$(X(I,I1))
	NEXT:NEXT
	PUT #1,T:CLOSE 1
	FOR I=0 TO 13:N$(I)="XXX"
	FOR I1=0 TO 6
	A(I,I1)=0
	X(I,I1)=0
	NEXT
	NEXT

384 GOTO 312

'$INCLUDE: 'KeyInput.BM'
