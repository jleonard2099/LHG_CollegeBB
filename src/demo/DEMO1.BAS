'$INCLUDE: 'KeyInput.BI'
'$INCLUDE: 'QPProEqu.BI'

DEFINT A-Z

DECLARE SUB DRAWBOX ()
DECLARE SUB SHOTSTRING ()

DIM NG%(18), NG1%(18), AP%(2), HF%(1, 6), DP(2, 4), FA%(1, 13), FY%(2), OF%(1), DT%(1), TM%(1, 13)
DIM D8(4, 3), PR%(1, 1), PC%(1), CZ%(1), OB$(9), DB$(14)
DIM R$(14), p$(1), X$(3), C7$(2), TS$(1), CM$(1), U5$(3), LC$(2), TB$(1)
DIM TR%(1, 9), Y$(1), Z5(1), Z6(1), PS$(4), D2(1), S1(1), RB(9), P5(14), P4(14)
DIM vg%(8), vh%(8), V1%(1), V2%(1), L%(1, 4), P2(1), YN$(5), PB$(1), N%(16, 16, 3), N$(16, 16, 3)
DIM YN1$(3), TP%(1), TF%(1),Q$(250),O$(9),V%(500)
DIM O%(100), HT%(100), HO$(100), H$(100), SX%(32, 1, 14), ST%(32)
DIM APT%(100, 1), CRD(100) AS LONG, SITE$(100)
DIM G9%(1), F5%(1, 8), W%(1, 13, 1), IY(1), O0%(1), V$(500), Z2(13, 13) AS SINGLE
DIM F1(13), S3(13), G4(13), G5(13), D$(15), D1(1), W0(1, 13), W1(1, 13)
DIM A(1, 13, 24) AS SINGLE, AA$(1, 13), B$(1), P7(1), R3(1), T0(1), T1(1), SX$(32, 2), W2(1, 13), W3(1, 13)
DIM B1(1, 4), S(1, 9), V9(14), C(1, 13, 6), ZZ(1, 13), B%(1, 13, 18), Z(15) AS SINGLE, Z1(15) AS SINGLE
DIM C$(1),S$(1),A1$(1),ATT(1) AS LONG,DF(1,13),PO$(1,13),RS(1,13,13),T2%(1,20)
DIM E%(13), QQ(1, 8, 13, 14), QR(1, 7, 14)

COMMON SHARED APT%(), CRD() AS LONG, SITE$(), QQ(), QR()
COMMON SHARED I, TR%(), F5%(), P9, L%(), A() AS SINGLE, C(), V1%(), V2%()
COMMON SHARED p$(), B$(), S1(), D1(), AA$(), FY%(), B%(), U$, PASS%, U6 AS SINGLE, PT%, B1(), p, B, P7()
COMMON SHARED DK%, PZ%, FT%, X3%, XX%, FB%, F AS SINGLE, PB%, NL%
COMMON SHARED A1$, B1$, C1$, D1$, E1$, F1$, G1$, H1$, J$, vg%(), vh%()
COMMON SHARED AP,U5,HT%,G9,EG%,TMT,H,T AS SINGLE,TE AS SINGLE,SX$(),SX%(),R$(),TS%,ST%,ST%()
COMMON SHARED AP%(),N,S(),ZZ(),W%(),V9(),T0(),R3()
COMMON SHARED DB$(),DT%(),D2(),OB$(),OF%(),S3(),F1(),G5(),G4(),NF%
COMMON SHARED FF$,NG1%(),YN1$(),YN$(),NG%(),VT$,W$,W1$,VT1$
COMMON SHARED Z2() AS SINGLE,W2(),W0(),Z1() AS SINGLE,Z() AS SINGLE,W3(),O%(),HO$(),HT%(),H$(),Q
COMMON SHARED W1(),Y$(),Q$(),FA%(),X,P2(),T1(),D,CTO%,XM,C1
COMMON SHARED Z5(),Z6(),RB(),X8,C7,DY,S9,D$(),JJ,G9%(),XS,CM%
COMMON SHARED TB%,TF%,N7%,TOU,TF$,N$(),N%(),PA%,HF%(),S2
COMMON SHARED DP(),D8(),X$(),C7$(),O$(),TS$(),CM$(),U5$(),LC$()
COMMON SHARED TB$(),PB$(),J,MJ,P5(),P4(),PS$(),TM%(),CZ%(),PR%(),IN,M5
COMMON SHARED F3S%,J8%,F3,BO%,V$(),V%(),NT,X0%,X1%,TP%(),LC%,FO,PB$
COMMON SHARED BU%,YN$,y2 as long,R0 AS SINGLE,CT
COMMON SHARED C$(),S$(),A1$(),ATT() AS LONG,DF(),PO$(),RS(),T2%()
COMMON SHARED E%(), Y3 AS LONG

CLEAR

RANDOMIZE TIMER

CALL INITIALIZE
	IF AP = 1 THEN CALL AUTOSETUP
	IF AP = 1 AND TOU = 0 THEN 51

24 CLS : COLOR 2: PRINT TAB(29); "SELECT OPENING OPTIONS": PRINT

25 LOCATE 2, 2: COLOR 14: PRINT "(1) "; : COLOR 15: PRINT U5$(U5)
	LOCATE 3, 2: COLOR 14: PRINT "(2) "; : COLOR 15: PRINT "VISITING TEAM: "; : COLOR TR%(0, 0), TR%(0, 1): PRINT B$(0): COLOR , 0
	LOCATE 4, 2: COLOR 14: PRINT "(3) "; : COLOR 15: PRINT "HOME TEAM: "; : COLOR TR%(1, 0), TR%(1, 1): PRINT B$(1): COLOR , 0

28 LOCATE 5, 2: COLOR 14: PRINT "(4) "; : COLOR 15: PRINT "3-POINT SHOT: "; TS$(X3%)

29 LOCATE 6, 2: COLOR 14: PRINT "(5) "; : COLOR 15: PRINT C7$(C7)

30 LOCATE 7, 2: COLOR 14: PRINT "(6) "; : COLOR 15: PRINT "LOCATION: "; LC$(N)
	LOCATE 8, 2: COLOR 14: PRINT "(7) "; : COLOR 15: PRINT USING "DISPLAY PAUSE IN SECONDS: ##.#"; U6

32 LOCATE 9, 2: COLOR 14: PRINT "(8) "; : COLOR 15: PRINT "START GAME"
	LOCATE 10, 2: COLOR 14: PRINT "(9) "; : COLOR 15: PRINT "FOULS TO DISQUALIFY: "; NF%
	LOCATE 11, 2: COLOR 14: PRINT "(0) "; : COLOR 15: PRINT "SAVE SETTINGS"
	LOCATE 12, 2: COLOR 14: PRINT "(A) "; : COLOR 15: PRINT "FREE THROWS ON 10TH FOUL: "; TB$(TB%)
	LOCATE 13, 2: COLOR 14: PRINT "(B) "; : COLOR 15: PRINT "HUMAN COACHES WILL: "; CM$(CM%); : LOCATE 1, 1
	LOCATE 14, 2: COLOR 14: PRINT "(C) "; : COLOR 15: PRINT "3 FT WHEN FOULED ON 3-PT ATT: "; TS$(TF%)
	LOCATE 15, 2: COLOR 14: PRINT "(D) "; : COLOR 15: PRINT "1 FT ON 1ST 6 FLOOR FOULS : "; TS$(N7%)
	LOCATE 16, 2: COLOR 14: PRINT "(E) "; : COLOR 15: PRINT "PLAY BY PLAY: "; PB$(PB%)
	LOCATE 17, 2: PRINT "NOTE:: 1 FT ON 1ST 6 FLOOR FOULS THROUGH 1972-73 SEASON"
	LOCATE , 2: PRINT "       45 SEC SHOT CLOCK WAS ADOPTED IN 1984-85, BUT NOT USED IN"
	LOCATE , 2: PRINT "       84-85 POST SEASON TOURNAMENTS"
	LOCATE , 2: PRINT "       3 PT SHOT WAS ADOPTED IN 1986-87"
	LOCATE , 2: PRINT "       2 FT INSTEAD OF 1+1 AFTER 10TH FOUL ADOPTED IN 1990-91"
	LOCATE , 2: PRINT "       3 FT WHEN FOULED ON A 3 PT ATT ADOPTED IN 1990-91"
	LOCATE , 2: PRINT "       35 SEC SHOT CLOCK WAS ADOPTED IN 1993-94"

35 COLOR 7: I$=GetKeyPress$
	IF I$=CHR$(27) THEN RUN "HELLO.EXE"
	I = VAL(I$)
	IF UCASE$(I$) = "A" THEN I = 11
	IF UCASE$(I$) = "B" THEN I = 12
	IF UCASE$(I$) = "C" THEN I = 13
	IF UCASE$(I$) = "D" THEN I = 14
	IF UCASE$(I$) = "E" THEN I = 15
	IF I < 0 OR I > 15 THEN 35
	IF I = 0 THEN I = 10
	ON I GOTO 38, 40, 41, 42, 44, 46, 48, 50, 45, 43, 47, 33, 34, 39, 22

22 PB% = 1 - PB%: GOTO 32

33 CM% = 1 - CM%: GOTO 32

34 TF% = 1 - TF%: GOTO 32

38 U5 = U5 + 1: IF U5 > 3 THEN U5 = 0
	GOTO 25

39 N7% = 1 - N7%: GOTO 32

40 P9 = 0: CALL SELECTID: GOTO 24

41 P9 = 1: CALL SELECTID: GOTO 24

42 X3% = 1 - X3%: GOTO 28

43 OPEN "DEFAULT" FOR OUTPUT AS #1
	PRINT #1, U5: PRINT #1, X3%: PRINT #1, C7: PRINT #1, N: PRINT #1, NF%: PRINT #1, U6: PRINT #1, CM%: PRINT #1, TB%: PRINT #1, TF%: PRINT #1, N7%: PRINT #1, PB%
CLOSE 1: GOTO 32

44 C7 = C7 + 1: IF C7 > 2 THEN C7 = 0
	GOTO 29

45 NF% = NF% + 1: IF NF% > 6 THEN NF% = 5
	GOTO 32

46 N = N + 1: IF N > 2 THEN N = 1
	GOTO 30

47 TB% = 1 - TB%: GOTO 32

48 LOCATE 8, 32: INPUT U6: IF U6 < 0 THEN 48
	GOTO 24

50 IF B$(0) = "" OR B$(1) = "" THEN 24
	CLS : COLOR 3: JJ = 6
	SN = 1: LOCATE 6, 8: COLOR TR%(1, 0), TR%(1, 1)
	PRINT " Ö"; STRING$(61, 196); "· "; : FOR II = 1 TO JJ: LOCATE 6 + II, 8
	PRINT " º"; STRING$(61, 32); "º "; : NEXT
	LOCATE 7 + JJ, 8
	PRINT " Ó"; STRING$(61, 196); "½ "; : LOCATE 7, 11
	PRINT "IF YOU ARE USING THE 10 MINUTE TICKER OPTION FOR THIS GAME,"
	LOCATE , 11: PRINT "ENTER STARTING TIME FOR GAME IN THIS FORMAT"
	LOCATE , 11: PRINT "(EXAMPLES: 1:00P, 11:30A). OTHERWISE, JUST HIT ENTER": PRINT
	LOCATE , 11: INPUT "START TIME: "; ST$
	L = LEN(ST$)
	IF L = 5 THEN HR = VAL(LEFT$(ST$, 1)): MIN = VAL(MID$(ST$, 3, 2))
	IF L = 6 THEN HR = VAL(LEFT$(ST$, 2)): MIN = VAL(MID$(ST$, 4, 2))
	TT$ = RIGHT$(ST$, 1)
	IF UCASE$(TT$) = "P" AND LEFT$(ST$, 2) <> "12" THEN HR = HR + 12
	TM = HR * 60 + MIN
	ST% = INT(TM / 30 - 18)
	CALL EDITCX

51 FY%(2) = INT(((FY%(1) + FY%(0)) / 2) + .5)
	FOR I = 0 TO 1: FOR I1 = 0 TO 13: TM%(I, I1) = 1200: NEXT: NEXT
	IF U5 = 1 THEN CT = 0: GOTO 55
	IF U5 = 2 THEN U5 = 1: CT = 1: GOTO 55
	IF U5 = 3 THEN U5 = 2

55 CALL LOADSTATS
	GOTO 900

159 CALL CLOCKOVER
	CALL SCOREBOARD
	RETURN

170 FOR I = 0 TO 1
	DT%(I) = 0
	D2(I) = 0
	P7(I) = 0
	NEXT
	T = 0
	CALL QUARTERTOTAL
	H = H + 1
	T = 600
	XS = 1
	X = 0
	IF H = 2 THEN U$ = "END OF HALF"
	IF H = 2 AND PB% = 0 THEN CALL PBP
	IF H = 2 AND PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT U$
	IF H > 3 THEN U$ = "END OF OVERTIME" + STR$(H - 3)
	IF H > 3 AND PB% = 0 THEN CALL PBP
	IF H > 3 AND PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT U$
	GOSUB 178: IF H < 3 AND U5 <> 0 THEN GOSUB 175
	IF H < 3 THEN P2(0) = 0: P2(1) = 0: GOSUB 159: PRINT : B = -1: CALL DEADBALLOPTIONS: T = 600: CALL MAINSCREEN: FOR I = 0 TO 1: FOR I1 = 0 TO 13: TM%(I, I1) = 1200: FA%(I, I1) = 0: NEXT: NEXT: GOTO 250
	GOSUB 159
	IF H = 3 THEN U$ = "END OF REGULATION"
	IF H = 3 AND PB% = 0 THEN CALL PBP
	IF H = 3 AND PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT U$
	LOCATE 2, 31: PRINT "END OF REGULATION"
	IF S(0, 0) = S(1, 0) AND PB% = 0 THEN U$ = "OVERTIME !!!": CALL PBP
	IF S(0, 0) = S(1, 0) AND PB% = 1 THEN CALL WINDEX: PRINT "OVERTIME !!!": CALL DELAY
	IF S(0, 0) = S(1, 0) THEN 190
	CALL HITKEY: GOTO 8400

175 IF U5 = 1 THEN P9 = CT: CALL COMCOACH
	IF U5 = 2 THEN P9 = 0: CALL COMCOACH: P9 = 1: CALL COMCOACH
	RETURN

178 IF H = 2 AND PB% = 0 THEN U$ = "HALFTIME!": CALL PBP: GOSUB 8515
	IF H = 2 AND PB% = 1 THEN CALL WINDEX: PRINT "HALFTIME!": CALL DELAY: GOSUB 8515
	RETURN

190 T1(0) = T1(0) + 1: T1(1) = T1(1) + 1: T = 300: CALL MAINSCREEN
	FOR I = 0 TO 1
	FOR I1 = 0 TO 13: TM%(I, I1) = 300: FA%(I, I1) = 0
	NEXT: NEXT: B = -1
	CALL DEADBALLOPTIONS
	CALL SCOREBOARD
	GOTO 250

240 S9 = (S1(0) + S1(1)) / 2
	FOR P9 = 0 TO 1: IF U5 = 1 AND P9 = CT OR U5 = 2 THEN CALL SETSTAMINA: CALL COMCOACH: GOTO 243
	CALL SETSTAMINA: CALL LINEUPS: CALL FOULSAFE

243 GOSUB 819: NEXT P9
	GOSUB 159: CALL STEALADJ

250 P = INT(RND(1) * 2): IF P = 0 THEN D = 1
	IF P = 1 THEN D = 0
	GOSUB 3000: CALL LASTSHOT: IF T <= 0 THEN 170
	GOSUB 1033
	IF U6 = 0 AND (H = 1 OR H = 3) THEN PA% = D: GOTO 300
	IF U6 = 0 AND (H <> 1 OR H > 3) THEN P = PA%: D = 1 - P: PA% = 1 - PA%: GOTO 300
	IF (H = 1 OR H = 3) AND PB% = 0 THEN U$ = B$(P) + " GETS THE JUMP": PA% = D: CALL PBP
	IF (H = 1 OR H = 3) AND PB% = 1 THEN CALL WINDEX: PRINT B$(P) + " GETS THE JUMP": PA% = D: CALL DELAY
	IF (H <> 1 AND H<>3 OR H > 3) AND PB% = 0 THEN P = PA%: D = 1 - P: PA% = 1 - PA%: U$ = B$(P) + " INBOUNDS THE BALL": CALL PBP
	IF (H <> 1 AND H<>3 OR H > 3) AND PB% = 1 THEN P = PA%: D = 1 - P: PA% = 1 - PA%: CALL WINDEX: PRINT B$(P) + " INBOUNDS THE BALL": CALL DELAY
	GOTO 300

COMPFIVE:
	RN = INT(RND(1) * 100) + 1
	R0 = S(P, 0) - S(D, 0)
	IF T >= 3 AND T <= 5 AND X3% = 0 AND R0 < 3 THEN I1% = 5
	IF T >= 3 AND T <= 5 AND X3% = 1 AND R0 = 3 THEN I1% = 4
	IF T >= 3 AND T <= 5 AND X3% = 1 AND R0 = 2 AND RN <= 50 THEN I1% = 5
	IF T >= 3 AND T <= 5 AND X3% = 1 AND R0 = 2 AND RN > 50 THEN I1% = 4
	IF T < 3 AND X3% = 0 AND R0 < 3 THEN I1% = 0
	IF T < 3 AND X3% = 1 AND R0 = 3 THEN I1% = 1
	IF T < 3 AND X3% = 1 AND R0 = 2 AND RN <= 50 THEN I1% = 0
	IF T < 3 AND X3% = 1 AND R0 = 2 AND RN > 50 THEN I1% = 1
	GOTO 281

LASTFIVE:
	IF U5 = 2 OR U5 = 1 AND P = CT THEN GOTO COMPFIVE
	CALL LASTFIVEMENU

280  I$=GetKeyPress$
	I1% = VAL(I$): IF I1% < 0 OR I1% > 5 THEN 280
	IF I1% = 3 AND T1(P9) <= 0 THEN 280
	IF (I1% = 1 OR I1% = 4) AND X3% = 0 THEN 280
	COLOR 15, 0
	CALL SCOREBOARD

281  B = INT(RND(1) * 5)
	RN = INT(RND(1) * 100) + 1
	IF I1% = 0 AND RN <= 50 OR I1% = 1 AND RN <= 33 THEN U$ = "LONG PASS DOWN COURT": CALL PBP: CALL DELAY: U$ = "IT'S INTERCEPTED...GAME OVER!!": CALL PBP: GOTO TIMEEXP
	IF I1% = 2 THEN I3% = INT(RND(1) * 45) + 45: U$ = AA$(P, B1(P, B)) + " HAS THE BALL": CALL PBP: U$ = "HE PUTS IT UP FROM" + STR$(I3%) + " FEET": CALL PBP: CALL DELAY: IF RN = 61 THEN U$ = "GOOD!!": CALL PBP: GOSUB BASKET: GOTO TIMEEXP
	IF I1% = 2 THEN U$ = "SHOT MISSES...GAME OVER": CALL PBP: GOSUB MBASKET: GOTO TIMEEXP
	IF I1% >= 3 AND RN <= 8 THEN U$ = "BALL LOST O.B.  GAME OVER": CALL PBP: GOTO TIMEEXP
	IF I1% >= 3 AND RN > 8 AND RN <= 18 THEN U$ = "PASS INTERCEPTED": CALL PBP: GOTO TIMEEXP
	IF I1% = 3 AND T < 1.5 OR I1% >= 4 AND T < 3 THEN U$ = "INBOUND PASS TO " + AA$(P, B1(P, B)): CALL PBP: U$ = "TIME EXPIRES": CALL PBP: GOTO TIMEEXP
	IF I1% = 3 THEN TE = (RND(1) + 1.5): T = T - TE: CALL PLAYINGTIME: GOSUB SHTCLK: U$ = B$(P) + " GETS THE BALL TO HALF COURT": CALL PBP: U$ = "THEY QUICKLY CALL FOR A TIMEOUT": CALL PBP: T1(P) = T1(P) - 1: CALL DEADBALLOPTIONS: CALL SCOREBOARD:  _
GOSUB HALFCT
	IF I1% = 0 OR I1% = 4 OR (I1% = 3 AND I2% = 1) THEN GOTO TAKE3
	RN = INT(RND(1) * 100) + 1
	IF T <= .5 THEN XX% = 3
	IF T > .5 AND T <= 1.8 THEN XX% = 16
	IF T > 1.8 THEN XX% = 29
	IF RN > XX% THEN U$ = AA$(P, B1(P, B)) + " MISSES": CALL PBP: A(P, B1(P, B), 7) = A(P, B1(P, B), 7) + 1: GOTO TIMEEXP
	U$ = "BASKET BY " + AA$(P, B1(P, B)) + "!!": CALL PBP: A(P, B1(P, B), 7) = A(P, B1(P, B), 7) + 1: A(P, B1(P, B), 8) = A(P, B1(P, B), 8) + 1: S(P, H) = S(P, H) + 2: S(P, 0) = S(P, 0) + 2: GOSUB 1054: CALL MAINSCREEN: GOTO TIMEEXP

SHTCLK:
	IF C7 >= 1 THEN X8 = X8 - TE
	IF X8 < 0 THEN X8 = X8 - X8: T = T - X8: TE = X8: CALL PLAYINGTIME
	RETURN

TAKE3:
	RN = INT(RND(1) * 100) + 1
	IF T <= .5 THEN XX% = 2
	IF T > .5 AND T <= 1.8 THEN XX% = 12
	IF T > 1.8 THEN XX% = 20
	IF RN > XX% THEN U$ = AA$(P, B1(P, B)) + " MISSES": CALL PBP: A(P, B1(P, B), 7) = A(P, B1(P, B), 7) + 1: W%(P, B1(P, B), 1) = W%(P, B1(P, B), 1) + 1: GOTO TIMEEXP
	U$ = "BASKET BY " + AA$(P, B1(P, B)) + "!!": CALL PBP: A(P, B1(P, B), 7) = A(P, B1(P, B), 7) + 1: A(P, B1(P, B), 8) = A(P, B1(P, B), 8) + 1: S(P, H) = S(P, H) + 3: S(P, 0) = S(P, 0) + 3: W%(P, B1(P, B), 1) = W%(P, B1(P, B), 1) + 1: W%(P, B1(P, B _
), 0) = W%(P, B1(P, B), 0) + 1: GOSUB 1054: CALL MAINSCREEN: GOTO TIMEEXP

HALFCT:
	JJ = 8
	LOCATE 8, 8: COLOR TR%(P, 0), TR%(P, 1)
	PRINT " Ö"; STRING$(61, 196); "· "; : FOR II = 1 TO JJ: LOCATE 8 + II, 8
	PRINT " º"; STRING$(61, 32); "º "; : NEXT
	LOCATE 9 + JJ, 8
	PRINT " Ó"; STRING$(61, 196); "½ "; : LOCATE 10, 15
	PRINT B$(P); " HALF COURT OPTION"
	LOCATE 12, 14
	LOCATE , 14: PRINT USING "TIME REMAINING #.#"; T
	LOCATE , 14: PRINT "0 - SHOOT A 2"
	LOCATE , 14: PRINT "1 - SHOOT A 3"

290  I$=GetKeyPress$
	I2% = VAL(I$): IF I2% < 0 OR I2% > 1 THEN 290
	IF I2% = 1 AND X3% = 0 THEN I2% = 0
	COLOR 15, 0
	CALL SCOREBOARD
	RETURN

BASKET:
	S(P, H) = S(P, H) + 2: S(P, 0) = S(P, 0) + 2: GOSUB 1054
	A(P, B1(P, B), 8) = A(P, B1(P, B), 8) + 1: A(P, B1(P, B), 7) = A(P, B1(P, B), 7) + 1
	IF X3% = 0 THEN CALL MAINSCREEN: RETURN
	S(P, H) = S(P, H) + 1: S(P, 0) = S(P, 0) + 1
	W%(P, B1(P, B), 1) = W%(P, B1(P, B), 1) + 1
	W%(P, B1(P, B), 0) = W%(P, B1(P, B), 0) + 1
	CALL MAINSCREEN
	RETURN

MBASKET:
	A(P, B1(P, B), 7) = A(P, B1(P, B), 7) + 1
	IF X3% = 0 THEN RETURN
	W%(P, B1(P, B), 1) = W%(P, B1(P, B), 1) + 1
	RETURN

TIMEEXP:
	TE = T: CALL PLAYINGTIME: T = 0: CALL ZEROCHECK: GOTO 170

300 IF T <= 5 AND T1(D) <= 0 AND S(P, 0) > S(D, 0) THEN TE = T: CALL PLAYINGTIME: T = 0: CALL ZEROCHECK: CALL WINDEX: PRINT B$(P); " RUNS THE CLOCK OUT!": CALL DELAY: CALL DELAY: GOTO 170
	IF T <= 5 AND (X3% = 1 AND S(D, 0) - S(P, 0) <= 3 OR X3% = 0 AND S(D, 0) - S(P, 0) <= 2) AND S(D, 0) - S(P, 0) >= 0 AND H >= 2 THEN GOTO LASTFIVE
	ST = 0: FO = 0: LS = 0: XS = 0
	X8 = 45
	IF C7 = 2 THEN X8 = 35
	LS = 0
	IF T < 6 AND LT <> 4 THEN LS = 4
	P6 = 0: D6 = 0: PASS% = 1: A4 = 0: A6 = 0: F = 0: IF X <> 90 THEN X = 0
	IF (D2(D) = 1 OR D2(D) = 3) AND P7(D) = 0 THEN X0% = 50: X1% = -1: CALL PRDFAT
	IF D2(D) = 2 AND P7(D) = 0 THEN X0% = 100: X1% = 1: CALL PRDFAT: CALL PRPFAT
	IF D2(D) = 1 AND P7(D) = 0 THEN X0% = 25: X1% = -1: CALL PRPFAT
	GOTO 400

350 PASS% = PASS% + 1: P6 = 0: A4 = 0: D6 = 0: A6 = 1: F = 0: X = 0
	IF (D2(D) = 1 OR D2(D) = 3) AND PASS% = 2 AND P7(D) > 0 THEN X0% = 50: X1% = -1: CALL PRDFAT
	IF D2(D) = 2 AND P7(D) > 0 AND PASS% = 2 THEN X0% = 100: X1% = 1: CALL PRDFAT: CALL PRPFAT
	IF D2(D) = 1 AND P7(D) > 0 AND PASS% = 2 THEN X0% = 25: X1% = -1: CALL PRPFAT
	GOTO 400

359 J8% = 0: IF X3% = 0 THEN P3 = 1: P6 = 1: GOTO 537
	S = INT(RND(1) * 100) + 1: W%(P, B1(P, B), 1) = W%(P, B1(P, B), 1) + 1: A(P, B1(P, B), 7) = A(P, B1(P, B), 7) + 1
	PT% = 3: CALL MAKEPBP: CALL PBP
	GOTO 9030

361 IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT "3 PT FG MISSED BY "; AA$(P, B1(P, B)): CALL DELAY
	IF PB% = 0 THEN PT% = 5: TP% = 1: CALL MAKEPBP: CALL PBP
	GOSUB 1033: T = T - 4: TE = 4: CALL PLAYINGTIME: GOSUB SHTCLK
	IF T <= 0 THEN TE = T: CALL PLAYINGTIME: TP% = 0: GOTO 170
	CALL MAINSCREEN: GOTO 670

363 IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT "3 PT FG GOOD BY "; AA$(P, B1(P, B)); " !!!": CALL DELAY
	IF PB% = 0 THEN PT% = 4: CALL MAKEPBP: CALL PBP

369 IF XX% = 1 THEN XX% = 0: S(P, H) = S(P, H) + 2: S(P, 0) = S(P, 0) + 2: W%(P, B1(P, B), 1) = W%(P, B1(P, B), 1) - 1: GOTO 364
	S(P, H) = S(P, H) + 3: S(P, 0) = S(P, 0) + 3: W%(P, B1(P, B), 0) = W%(P, B1(P, B), 0) + 1

364 A(P, B1(P, B), 8) = A(P, B1(P, B), 8) + 1
	GOSUB 1054: CALL MAINSCREEN: GOTO 562
	

400 A4 = 0: D6 = 0: P3 = 0: B = INT(RND(1) * 5)
	CALL BALLDISTRIBUTE
	IF P7(D) > 0 AND PASS% = 1 THEN 428
	R0 = INT(RND(1) * 100) + 1
	GOTO 461

448 T = T - 4: TE = 4: CALL PLAYINGTIME: GOSUB SHTCLK: GOSUB WHOLAY
	IF PASS% <> 1 THEN U$ = AA$(P, B1(P, B)) + " HAS THE BALL"
	IF PASS% = 1 THEN U$ = AA$(P, B1(P, B)) + " GETS THE INBOUND PASS"
	CALL PBP
	U$ = "HE IS STREAKING DOWN THE FLOOR!"
	CALL PBP: GOTO LAYUP

DENIAL:
	IF INT(RND(1) * 100) + 1 <= 10 THEN 448
	RN = INT(RND(1) * 100) + 1
	R0 = INT(RND(1) * 100) + 1
	IN = 99
	C1 = 2: P9 = D
	U$ = "DESIGNATED FOULER (0-4)"
	CALL SELECTPBP
	IF U5 = 1 AND D = CT OR U5 = 2 THEN DF% = INT(RND(1) * 5): GOTO 431
430 I$ = GetKeyPress$
	DF% = VAL(I$): IF DF% < 0 OR DF% > 4 THEN 430
	IF PASS% > 1 THEN 434

431 IF RN <= 4 AND T1(P) > 0 THEN U$ = B$(P) + " CAN'T INBOUND THE BALL": CALL SELECTPBP: U$ = B$(P) + " CALLS A TIME OUT": GOSUB 729: PASS% = 0: GOTO 640
	IF RN <= 4 AND T1(P) = 0 OR RN > 4 AND RN <= 7 THEN U$ = B$(P) + " CAN'T INBOUND THE BALL": CALL SELECTPBP: U$ = "5 SECOND VIOLATION...TURNOVER": SV% = 1: GOTO 517
	CY = 7 + DP(0, 4)
	IF RN <= CY THEN GOSUB ADJ: GOTO 515
	CY = CY + F5%(P, 4) + DP(1, 4)
	IF RN <= CY THEN GOSUB ADJ: GOTO 435

432 U$ = "PASS TO " + AA$(P, B1(P, B)): CALL SELECTPBP

434 IF INT(RND(1) * 100) + 1 <= 5 THEN IN% = 1
	RN = INT(RND(1) * 100) + 1
	IF RN <= 80 THEN TE = INT(RND(1) * 3) + 1: T = T - TE: CALL PLAYINGTIME: GOSUB SHTCLK
	IF RN > 80 AND RN <= 90 THEN TE = INT(RND(1) * 3) + 8: T = T - TE: CALL PLAYINGTIME: GOSUB SHTCLK
	IF RN > 90 THEN TE = INT(RND(1) * 3) + 5: T = T - TE: CALL PLAYINGTIME: GOSUB SHTCLK
	RN = INT(RND(1) * 100) + 1
	IF RN <= 80 THEN W5 = DF%: GOTO 439
	IF RN > 80 THEN GOSUB 630: GOTO 566

439 GOSUB 631: GOTO 566
	

428 '*** FULL COURT PRESS ***
	IF P7(D) = 1 THEN X0% = 50: X1% = -1: CALL PRDFAT
	IF P7(D) = 2 OR P7(D) = 4 THEN X0% = 50: X1% = -1: CALL PRDFAT
	IF P7(D) = 3 THEN X0% = 25: X1% = -1: CALL PRDFAT
	IF H >= 2 AND T <= 180 AND P7(D) = 5 THEN GOTO DENIAL
	IF P7(D) = 1 THEN X0% = 25: X1% = -1: FA%(P, B1(P, BU%)) = FA%(P, B1(P, BU%)) - 1: CALL PRPFAT
	IF P7(D) > 1 THEN X0% = 25: X1% = -1: CALL PRPFAT
	R0 = INT(RND(1) * 100) + 1
	IF P7(D) = 1 OR P7(D) = 3 THEN T = T - 2: TE = 2
	IF P7(D) = 2 AND R0 <= 75 THEN T = T - 2: TE = 2
	IF P7(D) = 2 AND R0 > 75 THEN T = T + 2: TE = -2
	IF P7(D) = 4 AND R0 <= 50 THEN T = T - 2: TE = 2
	IF P7(D) = 4 AND R0 > 50 THEN T = T + 2: TE = -2
	CALL PLAYINGTIME: GOSUB SHTCLK
	R0 = INT(RND(1) * 100) + 1
	IF R0 <= DP(2, P7(D)) THEN 512
	IF R0 <= DP(2, P7(D)) + 1 THEN 511
	CY = DP(2, P7(D)) + 1 + F5%(P, 5) + F5%(D, 6) + DP(0, P7(D)) - PR%(D, 0)
	IF R0 <= CY THEN 515
	CY = CY + F5%(P, 4) + DP(1, P7(D)) - PR%(D, 1)
	PC%(D) = PC%(D) + 1
	IF PC%(D) > 3 THEN PR%(D, 0) = 0: PR%(D, 1) = 0
	IF R0 <= CY THEN 435
	GOTO 465

ADJ:
	IF R0 <= 80 THEN T = T + 4: TE = -4: CALL PLAYINGTIME: GOSUB SHTCLK
	IF R0 > 80 AND R0 <= 90 THEN T = T - 3: TE = 3: CALL PLAYINGTIME: GOSUB SHTCLK
	RETURN

435 P9 = INT(RND(1) * 5)
	IF INT(RND(1) * 5) + 1 <= A(D, B1(D, P9), 5) THEN A(D, B1(D, P9), 18) = A(D, B1(D, P9), 18) + 1: GOTO 513
	R0 = INT(RND(1) * 100) + 1
	IF P7(D) = 1 AND PASS% = 1 AND R0 <= A(P, B1(P, BU%), 4) THEN GOTO LAYUP
	IF P7(D) = 2 AND PASS% = 1 AND R0 <= A(P, B1(P, BU%), 4) * 2 THEN GOTO LAYUP
	IF P7(D) = 3 AND PASS% = 1 AND R0 <= 7 THEN GOTO LAYUP
	IF P7(D) = 4 AND PASS% = 1 AND R0 <= 15 THEN GOTO LAYUP
	IF P7(D) = 1 AND PASS% = 1 AND R0 <= A(P, B1(P, BU%), 4) * 2 THEN GOTO GDSHOT
	IF P7(D) = 2 AND PASS% = 1 AND R0 <= A(P, B1(P, BU%), 4) * 4 THEN GOTO GDSHOT
	IF P7(D) = 3 AND PASS% = 1 AND R0 <= 14 THEN GOTO GDSHOT
	IF P7(D) = 4 AND PASS% = 1 AND R0 <= 30 THEN GOTO GDSHOT
	IF P7(D) = 5 THEN 432

437 P6 = 0: R0 = INT(RND(1) * 3) + 1: J8% = 0: F3S% = INT(RND(1) * 7) + 3
	IF A(P, B1(P, B), 0) > 60 AND R0 = 1 THEN F = 24
	IF A(P, B1(P, B), 0) > 60 AND R0 = 2 THEN F = 30
	IF A(P, B1(P, B), 0) > 60 AND R0 = 3 THEN F = 36
	IF A(P, B1(P, B), 0) <= 60 AND R0 = 1 THEN F = INT(A(P, B1(P, B), 0) * .4 + .5)
	IF A(P, B1(P, B), 0) <= 60 AND R0 = 2 THEN F = INT(A(P, B1(P, B), 0) * .5 + .5)
	IF A(P, B1(P, B), 0) <= 60 AND R0 = 3 THEN F = INT(A(P, B1(P, B), 0) * .6 + .5)
	PZ% = 1
	IF INT(RND(1) * 150) + 1 = 40 THEN GOTO TIEUP

444 X = 0
	IF PZ% = 2 AND INT(RND(1) * 100) + 1 <= 50 THEN PZ% = 3: P6 = 1
	GOTO 520

445 IF OF%(P) = 4 THEN 437
	IF H <= 2 THEN 450

446 P6 = 1: CALL SHOTPERCENT

447 PZ% = INT(RND(1) * 3) + 5
	GOTO 444

450 IF H = 2 AND T <= 120 OR H > 2 THEN 446
	IF A(P, B1(P, B), 3) - A(P, B1(P, B), 7) - A(P, B1(P, B), 11) - A(P, B1(P, B), 12) <= 0 THEN 437
	GOTO 446

453 A4 = 0: IF H = 2 AND T <= 120 OR H > 2 THEN 456
	IF H > 2 THEN 456
	IF A(P, B1(P, B), 3) - A(P, B1(P, B), 7) - A(P, B1(P, B), 11) - A(P, B1(P, B), 12) <= 0 THEN 437

456 CALL SHOTPERCENT: A4 = INT(RND(1) * 28) + 1
	R0 = INT(RND(1) * 9) + 1
	I2 = INT(RND(1) * 5)
	IF FA%(P, B1(P, B)) <= -5 THEN 460
	IF R0 <= A(P, B1(P, I2), 4) THEN F = A(P, B1(P, B), 0) + D1(D) + A4 + TF%(P) + TF%(D): TF%(P) = 0: TF%(D) = 0: PZ% = 2: P6 = 1: GOTO 444

460 GOTO 445

461 IF (OF%(P) = 8 OR OF%(P) = 7) AND D2(D) = 2 THEN 465
	IF R0 <= D8(4, D2(D)) THEN 512
	IF R0 <= D8(4, D2(D)) + 1 THEN 511
	OY% = 0
	IF OF%(P) = 4 OR OF%(P) = 7 THEN OY% = INT((D8(2, D2(D)) / 2) + .5) * -1
	CY = D8(4, D2(D)) + 1 + F5%(P, 5) + F5%(D, 6) + D8(2, D2(D)) + OY% + 1
	IF R0 <= CY THEN 515
	CY = CY + F5%(P, 4) + D8(3, D2(D))
	OY% = 0
	IF OF%(P) = 4 OR OF%(P) = 7 THEN OY% = INT((D8(3, D2(D)) / 2) + .5) * -1
	IF OF%(P) = 1 THEN OY% = 7
	IF OF%(P) = 2 THEN OY% = -7
	IF R0 <= CY + OY% THEN 435

465 R0 = INT(RND(1) * 100) + 1
	IF C7 = 2 THEN GS% = 39 + INT(((FY%(2) - 58) * .8) + .5)
	IF C7 = 1 THEN GS% = 39 + INT(((FY%(2) - 52) * .8) + .5)
	IF C7 = 0 THEN GS% = 39 + INT(((FY%(2) - 52) * .8) + .5)

'' THE NO SHOT CLOCK CASE WAS PREVIOUSLY - 40
	 IF D2(D) = 1 OR D2(D) = 2 THEN GS% = GS% + 7
	IF D2(D) = 3 THEN GS% = GS% - 7
	IF OF%(P) = 3 THEN GS% = GS% + 21
	IF OF%(P) = 4 THEN GS% = GS% - 21
	IF OF%(P) = 7 OR OF%(P) = 8 THEN 437
	IF OF%(P) = 5 AND X8 > 15 AND C7 >= 1 THEN 437
	IF R0 > GS% THEN 437
	R0 = INT(RND(1) * 100)
	IF R0 <= D8(1, D2(D)) THEN 453
	GOTO 445

511 X = 0: GOTO 580

512 CALL LASTSHOT: GOSUB 1033: CALL MAINSCREEN: X = 88: GOTO 565

513 IF P7(D) > 0 AND PASS% = 1 THEN 508
	CALL LASTSHOT

508 GOSUB 1033: A(P, B1(P, B), 23) = A(P, B1(P, B), 23) + 1
	IF U6 = 0 THEN 505
	U$ = "BALL STOLEN BY " + AA$(D, B1(D, P9)) + "!"
	IF PB% = 1 THEN CALL WINDEX: PRINT U$: CALL DELAY: GOTO 505
	RN = INT(RND(1) * 100) + 1
	IF RN<=3 THEN U$ = AA$(D, B1(D, P9)) + " QUICKLY REACHES IN!":CALL PBP
	IF RN>3 AND RN<=6 THEN U$ = AA$(D, B1(D, P9)) + " SNEAKS IN FROM BEHIND!":CALL PBP
	IF RN>6 AND RN<=10 THEN U$ = AA$(D, B1(D, P9)) + " GETS A HAND ON THE BALL!":CALL PBP
	 RN = INT(RND(1) * 20) + 1
	 IF RN = 1 THEN U$ = "PASS INTERCEPTED BY " + AA$(D, B1(D, P9)) + "!"
	IF RN = 2 THEN U$ = "PASS IS PICKED OFF BY " + AA$(D, B1(D, P9)) + "!"
	IF RN = 3 THEN U$ = "BALL IS STOLEN BY " + AA$(D, B1(D, P9)) + "!"
	IF RN = 4 THEN U$ = AA$(D, B1(D, P9)) + " WITH THE STEAL!"
	IF RN = 5 THEN U$ = AA$(D, B1(D, P9)) + " TAKES IT AWAY!"
	IF RN = 6 THEN U$ = AA$(D, B1(D, P9)) + " STEALS IT!"
	IF RN = 7 THEN U$ = AA$(D, B1(D, P9)) + " RIPS IT LOOSE!"
	IF RN = 8 THEN U$ = AA$(D, B1(D, P9)) + " TAKES THE BALL AWAY!"
	IF RN = 9 THEN U$ = AA$(D, B1(D, P9)) + " STEALS THE BALL!"
	IF RN =10 THEN U$ = AA$(D, B1(D, P9)) + " PICKS IT OFF!"
	IF RN =11 THEN U$ = AA$(D, B1(D, P9)) + " SWIPES THE BALL!"
	IF RN =12 THEN U$ = AA$(D, B1(D, P9)) + " WITH THE STOLEN BALL!"
	IF RN =13 THEN U$ = AA$(D, B1(D, P9)) + " STRIPS IT AWAY!"
	IF RN =14 THEN U$ = AA$(D, B1(D, P9)) + " WITH THE STEAL!"
	IF RN =15 THEN U$ = AA$(D, B1(D, P9)) + " SWIPES AND STEALS IT!"
	IF RN =16 THEN U$ = AA$(D, B1(D, P9)) + " SNATCHES IT AWAY!"
	IF RN =17 THEN U$ = AA$(D, B1(D, P9)) + " QUICKLY REACHES IN!"
	IF RN =18 THEN U$ = AA$(D, B1(D, P9)) + " TAKES IT THE OTHER WAY!"
	IF RN =19 THEN U$ = AA$(D, B1(D, P9)) + " POKES IT LOOSE!"
	IF RN =20 THEN U$ = AA$(D, B1(D, P9)) + " STRIPS IT CLEAN!"
	 CALL PBP

505 A(D, B1(D, P9), 13) = A(D, B1(D, P9), 13) + 1: T0(P) = T0(P) + 1: CALL MAINSCREEN
	C1 = 2: P9 = D: IF T <= 0 THEN 170
	GOSUB 3000: FB% = 1
	RN = INT(RND(1) * 100) + 1
	IF RN <= 38 THEN B = 0
	IF RN > 38 AND RN <= 75 THEN B = 1
	IF RN > 75 AND RN <= 83 THEN B = 2
	IF RN > 83 AND RN <= 91 THEN B = 3
	IF RN > 91 THEN B = 4
	RN = INT(RND(1) * 100) + 1
	IF PASS% > 1 AND (D2(P9) = 0 OR D2(P9) = 1 OR D2(P9) = 3) AND RN <= 15 THEN GOTO LAYUP
	IF PASS% > 1 AND D2(P9) = 2 AND RN <= 5 THEN GOTO LAYUP
	IF PASS% = 1 AND P7(P) > 0 AND RN <= 33 THEN GOTO LAYUP
	IF PASS% = 1 AND P7(P) > 0 AND P7(P) <> 3 AND RN <= 40 THEN GOTO LAYUP
	GOTO 300

515 CALL LASTSHOT

517 GOSUB 1033
	R0 = INT(RND(1) * 25) + 1
	IF R0 = 13 THEN GOTO TIEUP
	A(P, B1(P, B), 23) = A(P, B1(P, B), 23) + 1: T0(P) = T0(P) + 1
	IF SV% <> 1 THEN PT% = 1: CALL MAKEPBP
	SV% = 0
	IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT "TURNOVER BY "; B$(P): CALL DELAY
	IF PB% = 0 THEN CALL PBP
	U$ = "BALL OUT OF BOUNDS TO " + B$(D)
	GOSUB 729
	CALL DELAY: CALL MAINSCREEN: LOCATE 10, 1: IF T <= 0 THEN 170
	GOSUB 3000: CALL DEADBALLOPTIONS: GOSUB BADPR: GOTO 300
LAYUP:
	FB% = 1: F = 98: P6 = 1: GOTO 520
GDSHOT:
	FX% = A(P, B1(P, B), 0)
	IF FA%(P, B1(P, B)) <= -5 THEN FX% = FX% - 10
	F = FX% + INT(RND(20)) + 11 + TF%(D) + TF%(P): TF%(P) = 0: TF%(D) = 0
	PZ% = 10
	GOTO 447

GDSHOTDES:
	IF U6 = 0 THEN 529
	RN = INT(RND(1) * 100) + 1
	IF RN <= 25 THEN U$ = AA$(P, B1(P, B)) + " BREAKS IN TO FRONT COURT"
	IF RN > 25 AND RN <= 50 THEN U$ = AA$(P, B1(P, B)) + " GETS THE PASS IN FRONT COURT"
	IF RN > 50 AND RN <= 75 THEN U$ = AA$(P, B1(P, B)) + " BREAKS THE PRESS"
	IF RN > 75 THEN U$ = AA$(P, B1(P, B)) + " DEFEATS THE PRESS"
	CALL PBP
	RN = INT(RND(1) * 100) + 1
	IF RN <= 33 THEN U$ = "HE HAS AN OPEN JUMPER AT THE FT LINE"
	IF RN > 33 AND RN <= 66 THEN U$ = "HE'S OPEN ON THE BASELINE"
	IF RN > 66 THEN U$ = "HE'S OPEN FROM THE WING"
	CALL SHOTSTRING: CALL PBP
	GOTO 529

520 IF J8% = 1 THEN PZ% = 4
	CALL LASTSHOT: IF T <= 0 THEN 170
	IF PZ% = 4 AND F3S% <= 0 THEN F3S% = 3
	IF U6 = 0 THEN 529
	IF PZ% = 10 THEN GOTO GDSHOTDES
	IF F > 70 AND FB% = 1 AND PASS% = 1 THEN PT% = 6: PZ% = 8: CALL MAKEPBP: CALL PBP: GOTO 529
	IF AA$(P, B1(P, B)) <> PB$ AND PB$ = "" THEN U$ = "PASS TO " + AA$(P, B1(P, B)): CALL PBP
	IF AA$(P, B1(P, B)) <> PB$ AND PB$ <> "" THEN PT% = 10: CALL MAKEPBP: CALL PBP
	IF AA$(P, B1(P, B)) = PB$ THEN PT% = 9: CALL MAKEPBP: CALL PBP
	IF X8 <= 0 THEN U$ = "SHOT CLOCK HAS EXPIRED!": SV% = 1: GOTO 515
	PB$ = AA$(P, B1(P, B))
	YY$ = "HE"
	ON PZ% GOTO 521, 522, 523, 524, 525, 526, 527

521 IF U6 = 0 THEN 601
	RN = INT(RND(1) * 12) + 1
	IF RN = 1 THEN U$ = YY$ + "'S HEAVILY GUARDED"
	IF RN = 2 THEN U$ = YY$ + "'S GUARDED"
	IF RN = 3 THEN U$ = YY$ + "'S GUARDED BY "+AA$(D, B1(D, B))
	IF RN = 4 THEN U$ = YY$ + " HAS A MAN ON HIM"
	IF RN = 5 THEN U$ = YY$ + " HAS A DEFENDER ON HIM"
	IF RN = 6 THEN U$ = YY$ + "'S COVERED"
	IF RN = 7 THEN U$ = YY$ + " CAN'T GET AROUND THE DEFENDER"
	IF RN = 8 THEN U$ = YY$ + "'S PRESSURED"
	IF RN = 9 THEN U$ = YY$ + " HAS NOWHERE TO GO"
	IF RN = 10 THEN U$ = YY$ + " HAS A HAND IN HIS FACE"
	IF RN = 11 THEN U$ = YY$ + "'S WATCHED BY "+AA$(D, B1(D, B))
	IF RN = 12 THEN U$ = YY$ + "'S WORKING ON "+AA$(D, B1(D, B))

601 CALL PBP: GOTO 529

522 U$ = YY$ + " WORKS FREE INSIDE": CALL PBP: U$ = "HE HAS AN OPEN SHOT": CALL SHOTSTRING: CALL PBP: P6 = 1: GOTO 529

523 IF U6 = 0 THEN 529
	P6 = 1
	RN = INT(RND(1) * 100) + 1
	IF B = 4 AND RN <= 25 THEN U$ = YY$ + " MAKES A MOVE DOWN LOW": CALL PBP: GOTO 602
	IF B = 4 AND RN <= 50 THEN U$ = YY$ + " POSITIONS HIMSELF DOWN LOW": CALL PBP: GOTO 602
	IF B = 4 AND RN <= 75 THEN U$ = YY$ + " POSTS UP UNDERNEATH": CALL PBP: GOTO 602
	IF B = 4 THEN U$ = YY$ + " BACKS IN AGAINST " + AA$(D, B1(D, 4)): CALL PBP

602 IF B = 4 THEN U$ = "HE HAS A GOOD SHOT INSIDE": CALL SHOTSTRING: CALL PBP: GOTO 529
	IF (B = 3 OR B = 2) AND RN <= 17 THEN U$ = YY$ + " DRIVES THE BASELINE": CALL PBP: GOTO 603
	IF (B = 3 OR B = 2) AND RN <= 34 THEN U$ = YY$ + " PENETRATES THE LANE": CALL PBP: GOTO 603
	IF (B = 3 OR B = 2) AND RN <= 50 THEN U$ = YY$ + " MOVES INSIDE": CALL PBP: GOTO 603
	IF (B = 3 OR B = 2) AND RN <= 67 THEN U$ = YY$ + " DRIVES THE LANE": CALL PBP: GOTO 603
	IF (B = 3 OR B = 2) AND RN <= 84 THEN U$ = YY$ + " MOVES INTO THE PAINT": CALL PBP: GOTO 603
	IF (B = 3 OR B = 2) THEN U$ = YY$ + " DRIVES UNDERNEATH": CALL PBP

603 IF (B = 3 OR B = 2) THEN U$ = "HE'S GOT A GOOD SHOT UNDERNEATH": CALL SHOTSTRING: CALL PBP: GOTO 529
	IF (B = 0 OR B = 1) AND RN <= 25 THEN U$ = YY$ + " DRIVES THE LANE": CALL PBP: GOTO 604
	IF (B = 0 OR B = 1) AND RN <= 50 THEN U$ = YY$ + " DRIVES THROUGH THE KEY": CALL PBP: U$ = "HE'S INTO THE LANE": CALL PBP: GOTO 604
	IF (B = 0 OR B = 1) AND RN <= 75 THEN U$ = YY$ + " DRIVES TO THE BASKET": CALL PBP: GOTO 604
	U$ = YY$ + " DRIVES THROUGH AN OPENING": CALL PBP

604 U$ = "HE HAS A GOOD SHOT CLOSE IN": CALL SHOTSTRING: CALL PBP
	GOTO 529

524 U$ = "HE'S OPEN FROM 3-POINT RANGE!": U$ = U$ + STR$(F3S%) + "*": CALL PBP: P6 = 1: GOTO 529

525 U$ = "HE'S OPEN FROM MEDIUM RANGE": CALL SHOTSTRING: CALL PBP: P6 = 1: GOTO 529

526 U$ = "HE'S OPEN FROM MEDIUM RANGE": CALL SHOTSTRING: CALL PBP: P6 = 1: GOTO 529

527 U$ = "HE'S OPEN FROM MEDIUM RANGE": CALL SHOTSTRING: CALL PBP: P6 = 1: GOTO 529

529 IF F <= 0 THEN F = 1
	IF F >= 100 THEN F = 99
	IF U6 = 0 THEN 607
	IF PB% = 1 THEN CALL WINDEX: PRINT "PASS TO "; AA$(P, B1(P, B)); " OF "; B$(P)
	IF PB% = 1 AND PZ% <> 4 THEN LOCATE 10: PRINT "SHOT % "; F;
	IF PB% = 1 AND PZ% = 4 THEN LOCATE 10: PRINT "3 PT SHOT % "; F3S%; : PRINT " *"; : GOTO 528
	IF PB% = 1 AND PZ% >= 2 AND PZ% <= 8 THEN PRINT "*";

607 IF U6 = 0 OR PB% = 1 THEN 528
	IF PZ% <> 4 THEN LOCATE 8, 41: PRINT USING "SHOT % ###   "; F;
	IF PZ% = 4 THEN LOCATE 8, 41: PRINT USING "SHOT % ###"; F3S%; : PRINT " *"; : GOTO 528
	IF PZ% >= 2 AND PZ% <= 8 THEN LOCATE , 52: PRINT "*";

528 PRINT : IF PB% = 1 AND U6 <> 0 THEN CALL DELAY
	IF U5 <> 0 OR CM% = 1 THEN 949
530 I$ = GetKeyPress$
	IF UCASE$(I$) = "T" THEN CALL TICKER: CALL SCOREBOARD: GOTO 529
	IF UCASE$(I$) = "D" THEN CALL ZONECHANGE: CALL SCOREBOARD: GOTO 529
	P6 = VAL(I$): IF P6 < 1 OR P6 > 4 THEN P6 = 0
	IF P6 = 4 THEN FT% = 1

532 IF VAL(I$) = 3 AND (U5 = 0 OR U5 = 1 AND P = CT) AND H >= 4 AND T < 240 THEN P6 = 3
	IF VAL(I$) = 2 AND (U5 = 0 OR U5 = 1 AND D = CT) AND T1(P) > 0 THEN P6 = 2
	P3 = P6: IF P6 = 2 AND T1(P) = 0 THEN 530
	IF P6 = 3 AND H = 1 OR P6 = 3 AND U5 = 1 AND D = CT THEN 530
	IF P6 = 3 AND H = 2 AND T > 240 THEN 530
	'
	IF U5 = 1 AND P = CT AND J8% = 1 OR U5 = 2 AND J8% = 1 THEN P6 = 4
	IF U5 = 1 AND P = CT AND H >= 2 AND T < 30 AND S(D, 0) - S(P, 0) = 3 OR U5 = 2 AND H >= 2 AND T < 30 AND S(D, 0) - S(P, 0) = 3 THEN P6 = 4
	IF (P6 = 1 OR P6 = 4) AND PZ% = 4 THEN P6 = 4
	ON P6 + 1 GOTO 350, 537, 640, 584, 359

537 ' *** SHOOT !!! ***
	PT% = 3: CALL MAKEPBP: CALL PBP
	S = 0: SS = 0: R0 = INT(RND(1) * 100) + 1: A(P, B1(P, B), 7) = A(P, B1(P, B), 7) + 1
	GG = S(D, 0) - S(P, 0): IF H > 1 AND T <= 30 AND GG = 2 OR H > 1 AND T <= 30 AND GG = 0 OR H > 1 AND T <= 30 AND GG = -2 THEN 540
	IF R0 <= A(P, B1(P, B), 16) + F5%(D, 7) THEN A(P, B1(P, B), 7) = A(P, B1(P, B), 7) - 1: GOSUB 1033: LT = 0: GOTO 589

540 S = INT(RND(1) * 100) + 1
	R0 = F * ((DY / 100) + (.03 * X3%))
	IF H > 1 AND T < 30 AND GG = 2 OR H > 1 AND T < 30 AND GG = 0 OR H > 1 AND T < 30 AND GG = -2 THEN 542
	IF S <= R0 THEN GOSUB 1033: LT = 0: GOTO 610

542 IF S <= F THEN LT = 0: GOTO 553
	R0 = INT(RND(1) * 100) + 1
	LT = 0: GOTO 548

545 IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT "SHOT MISSED BY "; AA$(P, B1(P, B)): CALL DELAY
	IF PB% = 0 THEN PT% = 8: CALL MAKEPBP: CALL PBP

546 GOSUB 1033: T = T - 4: TE = 4: CALL PLAYINGTIME: GOSUB SHTCLK
	IF T <= 0 THEN TE = T: CALL PLAYINGTIME: GOTO 170
	CALL MAINSCREEN: LT = 0: GOTO 670

548 I2 = INT(RND(1) * 5) + 1
	I3 = INT(RND(1) * 5)
	IF I2 > A(D, B1(D, I3), 6) THEN 545
	IF U6 = 0 THEN 554
	IF PB% = 1 THEN CALL WINDEX: PRINT "SHOT BLOCKED BY "; AA$(D, B1(D, I3)): CALL DELAY: GOTO 554
	 RN = INT(RND(1) * 100) + 1
	IF RN <= 10 THEN U$ = AA$(D, B1(D, I3))+" STUFFS THE SHOT!!":GOTO 549
	IF RN <= 15 THEN U$ = "DENIED BY "+ AA$(D, B1(D, I3))+"!!":GOTO 549
	IF RN <= 20 THEN U$ = "ERASED BY "+ AA$(D, B1(D, I3))+"!!":GOTO 549
	IF RN <= 25 THEN U$ = "EXPUNGED BY "+ AA$(D, B1(D, I3))+"!!":GOTO 549
	IF RN <= 30 THEN U$ = "REBUKED BY "+ AA$(D, B1(D, I3))+"!!":GOTO 549
	IF RN <= 35 THEN U$ = "SHOT BLOCKED CLEANLY BY "+ AA$(D, B1(D, I3))+"!!":GOTO 549
	IF RN <= 70 THEN U$ = "SHOT BLOCKED BY "+ AA$(D, B1(D, I3))+"!!":GOTO 549
	IF RN <= 90 THEN U$ = "SHOT REJECTED BY "+ AA$(D, B1(D, I3))+"!!":GOTO 549
	U$ = "SHOT SWATTED OUT BY "+ AA$(D, B1(D, I3))+"!!":GOTO 549

549 CALL PBP

554 A(D, B1(D, I3), 15) = A(D, B1(D, I3), 15) + 1: X = 98: GOTO 546

553 IF DK% = 1 AND PB% = 0 THEN PT% = 2: CALL MAKEPBP: U$ = "STUFF BY ": DK% = 0: GOTO 559
	IF DK% = 1 AND PB% = 1 THEN U$ = "STUFF BY ": DK% = 0: GOTO 559
	IF PB% = 0 AND PZ% = 8 THEN PT% = 7: CALL MAKEPBP: CALL PBP: PZ% = 0: GOTO 560
	U$ = "BASKET BY "

559 U$ = U$ + AA$(P, B1(P, B)) + " !!!"
	IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT U$: CALL DELAY: GOTO 560
	RN = INT(RND(1) * 100) + 1
	IF RN<=50 THEN 561
	RN = INT(RND(1)*22)+1
	IF RN = 1 THEN U$ = "NOTHING BUT THE BOTTOM OF THE NET!"
	IF RN = 2 THEN U$ = "COUNT IT!"
	IF RN = 3 THEN U$ = AA$(P, B1(P, B)) + " TICKLES THE TWINE!"
	IF RN = 4 THEN U$ = "NO RIM, NO BOARD, JUST CORD!"
	IF RN = 5 THEN U$ = "GOOD!"
	IF RN = 6 THEN U$ = "YES!"
	IF RN = 7 THEN U$ = "COUNT IT!
	IF RN = 8 THEN U$ = "IT'S GOOD!"
	IF RN = 9 THEN U$ = "BINGO!"
	IF RN = 10 THEN U$ = "IT FALLS!"
	IF RN = 11 THEN U$ = "HE DRAINS IT!"
	IF RN = 12 THEN U$ = "SWISH!"
	IF RN = 13 THEN U$ = "ALL NET!"
	IF RN = 14 THEN U$ = "IT'S THERE!"
	IF RN = 15 THEN U$ = "HE BURIES IT!"
	IF RN = 16 THEN U$ = "IT GOES IN!"
	IF RN = 17 THEN U$ = "RING IT UP!"
	IF RN = 18 THEN U$ = "IT GOES DOWN!"
	IF RN = 19 THEN U$ = "BULLSEYE!"
	IF RN = 20 THEN U$ = "HE SCORES!"
	IF RN = 21 THEN U$ = "HE HAS IT!"
	IF RN = 22 THEN U$ = "HE CONNECTS!"

561 IF PB% = 0 THEN CALL PBP

560 S(P, H) = S(P, H) + 2: S(P, 0) = S(P, 0) + 2: GOSUB 1054: CALL MAINSCREEN
	A(P, B1(P, B), 8) = A(P, B1(P, B), 8) + 1

562 U$ = B$(D) + " BALL O.B. AFTER SCORE"
	IF PB% = 1 AND U6 <> 0 THEN LOCATE 9, 1: PRINT U$
	IF PB% = 0 THEN GOSUB 871: CALL PBP
	CALL DELAY: GOSUB 1033: T = T - 4: TE = 4: CALL PLAYINGTIME: GOSUB SHTCLK
	IF T <= 0 THEN TE = T: CALL PLAYINGTIME: GOTO 170
	CALL MAINSCREEN: GOSUB 3000: CALL STOPPAGE: CALL PRESSGUARD: GOTO 300

565 GOSUB 630: LT = 4

566 GOTO 9065

567 IF T <= 0 THEN 170
	CALL DEADBALLOPTIONS: GOSUB BADPR
	IF N7% = 0 AND PB% = 0 OR N7% = 0 AND U6 = 0 THEN CALL WINDEX: U$ = B$(P) + " BALL O.B. AFTER FOUL": CALL PBP: GOSUB 871: GOTO 350
	IF N7% = 0 AND PB% = 1 THEN CALL WINDEX: PRINT B$(P) + " BALL O.B. AFTER FOUL": CALL DELAY: GOSUB 871: GOTO 350
	GOTO 8000

570 IF U6 = 0 THEN 571
	IF PB% = 0 THEN U$ = "1+1 FT: " + AA$(P, B1(P, B)) + STR$(A(P, B1(P, B), 1)) + " %": CALL PBP: GOTO 571
	CALL WINDEX: PRINT B$(P)
	PRINT "1+1 FT: "; AA$(P, B1(P, B)); " "; A(P, B1(P, B), 1); " %"

571 X = 50: CALL DEADBALLOPTIONS: GOSUB BADPR: X = 0
	IF U6 = 0 THEN 572
	IF PB% = 0 THEN U$ = "1+1 FT: " + AA$(P, B1(P, B)) + STR$(A(P, B1(P, B), 1)) + " %": CALL PBP: GOTO 572
	CALL WINDEX: PRINT B$(P): PRINT "1+1 FT: "; AA$(P, B1(P, B)); "   "; A(P, B1(P, B), 1); " %"

572 FOR F3 = 1 TO 2
	A(P, B1(P, B), 9) = A(P, B1(P, B), 9) + 1
	S = INT(RND(1) * 100) + 1
	FX% = A(P, B1(P, B), 1)
	IF FA%(P, B1(P, B)) <= -5 THEN FX% = INT(FX% * .9 + .5)
	IF S <= FX% AND PB% = 0 THEN CALL THREEFT
	IF S <= FX% AND PB% = 1 THEN CALL MADEFT
	IF S > FX% AND PB% = 0 THEN CALL BADFT
	IF S > FX% AND PB% = 1 THEN CALL MISSFT
	IF F3 = 1 AND S > A(P, B1(P, B), 1) THEN 575
	NEXT F3

575 IF T <= 0 THEN 170
	IF S > FX% THEN 650
	GOSUB 3000: X = 0
	U$ = B$(P) + " BALL O.B. AFTER SCORE"
	CALL SELECTPBP
	GOSUB 871: CALL DELAY
	CALL STOPPAGE: CALL PRESSGUARD: GOTO 300

580 CALL LASTSHOT: GOSUB 1033: GOSUB 3000: GOSUB 630: B = W5: IF P2(D) > 6 THEN 570
	IF T <= 0 THEN 170
	U$ = "OFFENSIVE FOUL"
	IF PB% = 0 THEN CALL PBP
	IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT U$: CALL DELAY
	U$ = B$(P) + " BALL O.B. AFTER FOUL"
	GOSUB 729
	GOSUB 871: B = 6: CALL DELAY
	T0(D) = T0(D) + 1: CALL MAINSCREEN: CALL DEADBALLOPTIONS: GOSUB BADPR: CALL PRESSGUARD: GOTO 300

584 IN = 99: CALL LASTSHOT: IF T <= 0 THEN 170
	C1 = 2: P9 = D
	U$ = "DESIGNATED FOULER (0-4)"
	CALL SELECTPBP
	IF U5 = 1 AND D = CT OR U5 = 2 THEN W5 = INT(RND(1) * 5): GOTO 588
586 I$ = GetKeyPress$
	W5 = VAL(I$): IF W5 < 0 OR W5 > 4 THEN 586

588 GOSUB 631: GOTO 566

589 T = T - 4: TE = 4: CALL PLAYINGTIME: GOSUB SHTCLK: CALL MAINSCREEN: GOSUB 630
	IF U6 = 0 THEN 591
	IF PB% = 0 THEN U$ = "2 FT: " + AA$(P, B1(P, B)) + STR$(A(P, B1(P, B), 1)) + " %": CALL PBP: CALL DELAY: GOTO 591
	CALL WINDEX: PRINT B$(P): PRINT "2 FT: "; AA$(P, B1(P, B)); "   "; A(P, B1(P, B), 1); " %"

591 X = 50: CALL DEADBALLOPTIONS: GOSUB BADPR: X = 0: A(P, B1(P, B), 9) = A(P, B1(P, B), 9) + 2
	IF U6 = 0 THEN 592
	IF PB% = 0 THEN U$ = "2 FT: " + AA$(P, B1(P, B)) + STR$(A(P, B1(P, B), 1)) + " %": CALL PBP: GOTO 592
	CALL WINDEX: PRINT B$(P)
	PRINT "2 FT: "; AA$(P, B1(P, B)); "   "; A(P, B1(P, B), 1); " %"

592 FOR F3 = 1 TO 2: S = INT(RND(1) * 100) + 1
	FX% = A(P, B1(P, B), 1)
	IF FA%(P, B1(P, B)) <= -5 THEN FX% = INT(FX% * .9 + .5)
	IF S <= FX% AND PB% = 0 THEN CALL THREEFT
	IF S <= FX% AND PB% = 1 THEN CALL MADEFT
	IF S > FX% AND PB% = 0 THEN CALL BADFT
	IF S > FX% AND PB% = 1 THEN CALL MISSFT
	NEXT F3: LT = 0
	IF T <= 0 THEN TE = T: CALL PLAYINGTIME: GOTO 170
	IF S > FX% THEN 650

598 GOSUB 3000
	U$ = B$(P) + " BALL O.B. AFTER SCORE"
	CALL SELECTPBP
	GOSUB 871: CALL DELAY
	CALL STOPPAGE: B = 6: X = 0: CALL PRESSGUARD: GOTO 300

599 A(P, B1(P, B), 10) = A(P, B1(P, B), 10) + 1
	IF U6 <> 0 THEN U$ = "FREE THROW IS GOOD": CALL PBP
	S(P, H) = S(P, H) + 1: S(P, 0) = S(P, 0) + 1: CALL MAINSCREEN
	RETURN

600 IF U6 <> 0 THEN U$ = "FREE THROW IS MISSED": CALL PBP
	RETURN

610 T = T - 4: TE = 4: CALL PLAYINGTIME: GOSUB SHTCLK: CALL MAINSCREEN: GOSUB 1054
	IF DK% = 1 AND PB% = 0 THEN PT% = 2: CALL MAKEPBP: U$ = "STUFF BY " + AA$(P, B1(P, B)): CALL PBP: DK% = 0: GOTO 617
	IF DK% = 1 AND PB% = 1 THEN CALL WINDEX: PRINT "STUFF BY " + AA$(P, B1(P, B)): CALL DELAY: DK% = 0: GOTO 617
	IF PZ% = 8 THEN PT% = 7: CALL MAKEPBP: PZ% = 0: CALL PBP: GOTO 617
	F3 = 1
	IF PB% = 0 THEN U$ = "BASKET GOOD BY " + AA$(P, B1(P, B)): CALL PBP
	IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT "BASKET GOOD BY " + AA$(P, B1(P, B)): CALL DELAY

617 U$ = "... AND HE'S FOULED !!!": GOSUB 729: CALL DELAY: F3 = 1
	S(P, H) = S(P, H) + 2: S(P, 0) = S(P, 0) + 2: A(P, B1(P, B), 8) = A(P, B1(P, B), 8) + 1: CALL MAINSCREEN: GOSUB 630

619 IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT B$(P): PRINT "1 FT: "; AA$(P, B1(P, B)); "   "; A(P, B1(P, B), 1); " %"
	IF PB% = 0 THEN U$ = AA$(P, B1(P, B)) + " WILL SHOOT 1": CALL PBP
	X = 50: CALL DEADBALLOPTIONS: GOSUB BADPR: X = 0
	A(P, B1(P, B), 9) = A(P, B1(P, B), 9) + 1: S = INT(RND(1) * 100) + 1
	IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT B$(P): PRINT "1 FT: "; AA$(P, B1(P, B)); "   "; A(P, B1(P, B), 1); " %"
	FX% = A(P, B1(P, B), 1)
	IF FA%(P, B1(P, B)) <= -5 THEN FX% = INT(FX% * .9 + .5)
	IF S <= FX% AND PB% = 0 THEN GOSUB 599
	IF S <= FX% AND PB% = 1 THEN CALL MADEFT
	IF S > FX% AND PB% = 0 THEN GOSUB 600
	IF S > FX% AND PB% = 1 THEN CALL MISSFT
	IF T <= 0 THEN TE = T: CALL PLAYINGTIME: GOTO 170
	X = 99: IF S > FX% THEN 670
	GOSUB 3000
	U$ = B$(P) + " BALL O.B. AFTER SCORE"
	CALL SELECTPBP
	GOSUB 871: CALL DELAY
	CALL STOPPAGE: B = 6
	X = 0: CALL PRESSGUARD: GOTO 300

630 GOSUB 1065

631 A(D, B1(D, W5), 12) = A(D, B1(D, W5), 12) + 1: P2(D) = P2(D) + 1: CALL MAINSCREEN
	IF A(D, B1(D, W5), 3) - A(D, B1(D, W5), 7) - A(D, B1(D, W5), 11) - A(D, B1(D, W5), 12) = 0 THEN A(D, B1(D, W5), 3) = A(D, B1(D, W5), 3) + 1
	IF A(D, B1(D, W5), 12) < NF% THEN GOSUB 638
	IF A(D, B1(D, W5), 12) >= NF% THEN GOSUB 1000: GOSUB 635
	RETURN

635 IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT "FOUL ON "; AA$(D, B1(D, W5)): CALL DELAY
	IF PB% = 0 THEN U$ = "FOUL CALLED ON " + AA$(D, B1(D, W5)): CALL PBP
	IF IN% = 1 THEN U$ = "FOUL IS RULED INTENTIONAL!": GOSUB 729: CALL DELAY
	U$ = "AND HE HAS JUST FOULED OUT !!!"
	GOSUB 729
	CALL DELAY
	IF P2(D) > 6 THEN X = 50
	IF U5 = 0 OR U5 = 1 AND D <> CT THEN P9 = D: C1 = 1: CALL LINEUPS: CALL FOULSAFE: CALL DEADBALLOPTIONS: GOSUB BADPR: CALL SCOREBOARD
	CALL CLOCKOVER: X = 0: RETURN

638 IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT "FOUL ON "; AA$(D, B1(D, W5)): CALL DELAY: PRINT "HE HAS "; A(D, B1(D, W5), 12): CALL DELAY
	IF PB% = 0 THEN U$ = "FOUL NUMBER" + STR$(A(D, B1(D, W5), 12)) + " CALLED ON " + AA$(D, B1(D, W5)): CALL PBP
	CALL DELAY
	RETURN

640 PB$ = "": IF T1(P) <= 0 THEN 648
	T1(P) = T1(P) - 1
	CALL SCOREBOARD
	RN = INT(RND(1) * 100)
	IF RN <= 8 THEN TF%(P) = 10
	IF RN > 8 AND RN <= 16 THEN TF%(P) = 5
	RN = INT(RND(1) * 100)
	IF RN <= 8 THEN TF%(D) = -10
	IF RN > 8 AND RN <= 16 THEN TF%(D) = -5
	T = T + M5: TE = -M5: CALL PLAYINGTIME
	IF C7 >= 1 THEN X8 = X8 + M5
	'
	FOR I = 0 TO 1: FOR I1 = 0 TO 1
	PR%(I, I1) = 0
	NEXT: NEXT
	U$ = "TIME OUT " + B$(P)
	CALL SELECTPBP
	CALL DELAY: CALL DEADBALLOPTIONS
	FOR I = 0 TO 1: FOR I1 = 0 TO 13: FA%(I, I1) = FA%(I, I1) + 1
	IF FA%(I, I1) > 0 THEN FA%(I, I1) = 0
	NEXT: NEXT

648 IF A6 = 0 THEN CALL PRESSGUARD: GOTO 300
	GOTO 350
WHOLAY:
	RN = INT(RND(1) * 100) + 1
	IF RN <= 38 THEN B = 0
	IF RN > 38 AND RN <= 75 THEN B = 1
	IF RN > 75 AND RN <= 83 THEN B = 2
	IF RN > 83 AND RN <= 91 THEN B = 3
	IF RN > 91 THEN B = 4
	RETURN
BADPR:
	FOR I = 0 TO 1
	IF P7(I) = 0 THEN PR%(I, 0) = 1: PR%(I, 1) = 7: PC%(I) = 0
	NEXT
	RETURN

650 A6 = 1: P6 = 0: A4 = 0: D6 = 0: GOSUB 1033: S = 0
	R0 = INT(RND(1) * 100) + 1
	IF H > 1 AND T < 30 AND S(D, 0) - S(P, 0) = 2 AND R0 <= 12 OR H > 1 AND T < 30 AND S(P, 0) - S(D, 0) = 0 AND R0 <= 12 THEN CALL OFFREBOUND: GOTO 760
	R0 = INT(RND(1) * 100) + 1
	IF R0 <= 11 THEN FF% = 1: GOTO 707
	IF R0 <= 19 THEN CALL OFFREBOUND: GOTO 760
	CALL DEFREBOUND: GOTO 800

670 A6 = 1: P6 = 0: A4 = 0: D6 = 0: GOSUB 1033: GOTO 700

700 S = 0: A4 = 0: D6 = 0: R0 = INT(RND(1) * 100) + 1
	GG = S(D, 0) - S(P, 0)
	IF H > 1 AND T < 30 AND (GG = 2 OR GG = 0 OR GG = -2) AND R0 <= 12 THEN 700
	IF TP% = 1 AND R0 <= 19 THEN TP% = 0
	IF R0 <= 1 THEN 725
	IF R0 <= DY THEN FF% = 1: GOTO 707
	IF R0 <= 17 THEN 750
	IF R0 <= 19 THEN 730
	IF R0 <= 20 THEN 740

707 TP% = 0
	GOTO 770

710 IF U6 = 0 THEN 713
	IF PB% = 1 THEN CALL WINDEX: PRINT AA$(D, B1(D, B)); " HAS THE DEF RB FOR": PRINT B$(D); " AND IS FOULED !!!": CALL DELAY: GOTO 713
	U$ = AA$(D, B1(D, B)) + " HAS THE DEF RB": CALL PBP
	U$ = "HE'S FOULED !!!": CALL PBP

713 R3(D) = R3(D) + 1: A(D, B1(D, B), 11) = A(D, B1(D, B), 11) + 1: CALL MAINSCREEN: GOSUB 3000: GOTO 565

720 U$ = AA$(P, B1(P, B)) + " HAS THE OFF RB"
	IF PB% = 0 THEN CALL PBP
	IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT U$: PRINT "FOR "; B$(P): CALL DELAY
	U$ = "HE'S FOULED !!!"
	GOSUB 729
	A(P, B1(P, B), 11) = A(P, B1(P, B), 11) + 1: A(P, B1(P, B), 24) = A(P, B1(P, B), 24) + 1
	R3(P) = R3(P) + 1: CALL MAINSCREEN: GOTO 565

725 IF X = 98 THEN 700
	T0(P) = T0(P) + 1
	U$ = "OFFENSIVE GOAL TENDING"
	IF PB% = 0 THEN CALL PBP
	IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT U$: CALL DELAY
	U$ = "BALL O.B. TO " + B$(D)
	GOSUB 729
	CALL DELAY
	GOSUB 3000: CALL DEADBALLOPTIONS: GOSUB BADPR: GOTO 300

729 IF PB% = 0 THEN CALL PBP
	IF PB% = 1 AND U6 <> 0 THEN PRINT U$: CALL DELAY
	RETURN

730 IF X = 99 THEN 700
	CALL OFFREBOUND
	A(P, B1(P, B), 7) = A(P, B1(P, B), 7) + 1: A(P, B1(P, B), 8) = A(P, B1(P, B), 8) + 1
	A(P, B1(P, B), 11) = A(P, B1(P, B), 11) + 1: R3(P) = R3(P) + 1: S(P, H) = S(P, H) + 2
	S(P, 0) = S(P, 0) + 2: CALL MAINSCREEN
	IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT "TIPPED IN BY "; AA$(P, B1(P, B)): PRINT "   BASKET GOOD !!!": CALL DELAY
	IF PB% = 0 THEN U$ = AA$(P, B1(P, B)) + " TIPS IT IN!!": CALL PBP
	GOSUB 3000
	U$ = B$(P) + " BALL O.B. AFTER SCORE": GOSUB 871
	GOSUB 729: CALL DELAY
	CALL STOPPAGE: CALL PRESSGUARD
	GOTO 300

740 IF X = 99 THEN 700
	U$ = "DEFENSIVE GOAL TENDING"
	IF PB% = 0 THEN CALL PBP
	IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT U$: CALL DELAY
	IF TP% = 1 THEN TP% = 0: GOTO 369
	GOTO 560

750 R0 = INT(RND(1) * 100) + 1: IF R0 <= 35 THEN 752
	R3(D) = R3(D) + 1: CALL MAINSCREEN
	U$ = "RB KNOCKED O.B. TO " + B$(D)
	IF PB% = 0 THEN CALL PBP
	IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT U$: CALL DELAY
	CALL DELAY: CALL DEADBALLOPTIONS: GOSUB BADPR: GOSUB 3000: C1 = 2: P9 = P: GOTO 300

752 R3(P) = R3(P) + 1: CALL MAINSCREEN
	U$ = "RB KNOCKED O.B. TO " + B$(P)
	IF PB% = 0 THEN CALL PBP
	IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT U$: CALL DELAY
	CALL DELAY: CALL DEADBALLOPTIONS: GOSUB BADPR: LT = 4: GOTO 520

760 IF FF% = 1 THEN FF% = 0: GOTO 720
	A(P, B1(P, B), 24) = A(P, B1(P, B), 24) + 1: A(P, B1(P, B), 11) = A(P, B1(P, B), 11) + 1: R3(P) = R3(P) + 1: CALL MAINSCREEN
	U$ = AA$(P, B1(P, B)) + " HAS THE OFF RB"
	IF PB% = 0 AND U6 <> 0 THEN CALL PBP
	IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT U$: PRINT "FOR " + B$(P): CALL DELAY
	IF T <= 0 THEN 170
	R0 = INT(RND(1) * 130) + 1
	PB$ = AA$(P, B1(P, B))
	IF R0 = 32 THEN GOTO RBTIEUP
	R0 = INT(RND(1) * 10) + 1: CALL SHOTPERCENT
	IF H > 2 OR H = 2 AND T <= 120 THEN 765
	IF A(P, B1(P, B), 3) - A(P, B1(P, B), 7) - A(P, B1(P, B), 11) - A(P, B1(P, B), 12) <= 0 THEN F = INT(F * .6 + .5)

765 IF R0 <= 8 THEN PZ% = 9: P6 = 1: GOTO 537
	GOTO 520

770 RB = 0
	FOR I = 0 TO 9: RB(I) = 0: NEXT
	FOR I = 0 TO 4
	XZ = A(P, B1(P, I), 21)
	IF H > 2 OR H = 2 AND T <= 120 THEN 773
	IF A(P, B1(P, I), 3) - A(P, B1(P, I), 7) - A(P, B1(P, I), 11) - A(P, B1(P, I), 12) <= 0 THEN XZ = INT(XZ * .5 + .5)

773 IF FA%(P, B1(P, I)) <= -5 THEN XZ = INT(XZ * .9 + .5)
	RB(I) = RB(I) + XZ: RB = RB + XZ
	NEXT
	ORB = RB
	FOR I = 0 TO 4
	XZ = A(1 - P, B1(1 - P, I), 2)
	IF H > 2 OR H = 2 AND T <= 120 THEN 778
	IF A(1 - P, B1(1 - P, I), 3) - A(1 - P, B1(1 - P, I), 7) - A(1 - P, B1(1 - P, I), 11) - A(1 - P, B1(1 - P, I), 12) <= 0 THEN XZ = INT(XZ * .5 + .5)

778 IF FA%(1 - P, B1(1 - P, I)) <= -5 THEN XZ = INT(XZ * .9 + .5)
	RB(I + 5) = RB(I + 5) + XZ: RB = RB + XZ
	NEXT
	DRB = RB - ORB
	IF D2(D) = 0 THEN XQ = INT((RB * .06) + .5)
	IF D2(D) = 1 THEN XQ = INT((RB * .12) + .5)
	IF D2(D) = 2 THEN XQ = INT((RB * .1) + .5)
	IF D2(D) = 3 THEN XQ = INT((RB * .14) + .5)
	IF CZ%(P) = 1 THEN XQ = INT((RB * .17) + .5)
	RN = RND(1) * RB
	IF RN <= ORB + XQ THEN GOTO OREB
	RN = RND(1) * DRB
	FOR B = 5 TO 9
	IF RN <= RB(B) THEN B = B - 5: GOTO 800
	RB(B + 1) = RB(B + 1) + RB(B)
	NEXT
	B = INT(RND(1) * 5): GOTO 800
OREB:
	RN = RND(1) * ORB
	FOR B = 0 TO 4
	IF RN <= RB(B) THEN 760
	RB(B + 1) = RB(B + 1) + RB(B)
	NEXT
	B = INT(RND(1) * 5)
	GOTO 760

800 IF FF% = 1 THEN FF% = 0: GOTO 710
	A(D, B1(D, B), 11) = A(D, B1(D, B), 11) + 1: R3(D) = R3(D) + 1: CALL MAINSCREEN
	U$ = AA$(D, B1(D, B)) + " HAS THE DEF RB"
	IF PB% = 0 AND U6 <> 0 THEN CALL PBP
	IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT U$: PRINT "FOR " + B$(D): CALL DELAY
	PB$ = AA$(D, B1(D, B))
	C1 = 2: P9 = D: GOSUB 3000: FB% = 1
	PB$ = AA$(P, B1(P, B))
	R0 = INT(RND(1) * 130) + 1
	IF R0 = 15 THEN FB% = 0: GOTO RBTIEUP
	IF CZ%(D) = 1 AND INT(RND(1) * 100) + 1 <= 50 THEN T = T - 4: TE = 4: CALL PLAYINGTIME: GOSUB SHTCLK: GOSUB WHOLAY: GOTO LAYUP
	GOTO 300

819 IF X3% = 0 THEN 822
	FOR I = 0 TO 13
	M8 = 100 - A(P9, I, 19)
	IF M8 = 0 THEN 821
	M9 = 100 / M8

821 A(P9, I, 16) = INT((A(P9, I, 16) * M9) + .5): NEXT I

822 RETURN

871 LOCATE 8, 41: PRINT "            ": RETURN

900 IF AP = 1 THEN N = NG%(2)
	IF C7 = 1 THEN X8 = 45
	IF C7 = 2 THEN X8 = 35
	GOTO 240

949 IF H >= 2 AND T <= 240 AND S(P, 0) - S(D, 0) > 0 AND U5 = 1 AND P = CT THEN 951
	IF U5 = 2 OR U5 = 1 AND D = CT THEN 980

951 IF T <= 1 OR C7 >= 1 AND X8 <= 7 THEN P6 = 1: GOTO 532
	IF T <= 8 AND S(P, 0) - S(D, 0) <= -3 AND H >= 2 THEN P6 = 1: GOTO 532
	IF T <= 20 AND S(P, 0) - S(D, 0) <= -5 AND H >= 2 THEN P6 = 1: GOTO 532
	FX% = A(P, B1(P, B), 0)
	IF FA%(P, B1(P, B)) <= -5 THEN FX% = FX% - 10
	IF P6 = 1 THEN 532
	IF (U5 = 0 AND CM% = 1 OR U5 = 1 AND D = CT AND CM% = 1 OR U5 = 1 AND P = CT OR U5 = 2) AND T <= 660 AND T >= 540 AND H = 1 AND T1(P) >= 5 THEN P6 = 2: CTO% = 1: GOTO 532
	IF (U5 = 0 AND CM% = 1 OR U5 = 1 AND D = CT AND CM% = 1 OR U5 = 1 AND P = CT OR U5 = 2) AND T <= 240 AND T >= 120 AND H = 1 AND T1(P) >= 4 THEN P6 = 2: CTO% = 1: GOTO 532
	IF (U5 = 0 AND CM% = 1 OR U5 = 1 AND D = CT AND CM% = 1 OR U5 = 1 AND P = CT OR U5 = 2) AND T <= 840 AND T >= 720 AND H = 2 AND T1(P) >= 3 THEN P6 = 2: CTO% = 1: GOTO 532
	IF (U5 = 0 AND CM% = 1 OR U5 = 1 AND D = CT AND CM% = 1 OR U5 = 1 AND P = CT OR U5 = 2) AND T <= 300 AND T >= 180 AND H = 2 AND T1(P) >= 2 THEN P6 = 2: CTO% = 1: GOTO 532
	GOTO 532

980 IF (U5 = 1 OR U5 = 0) AND CM% <> 1 THEN 530
	GOTO 951

1000 M9 = 0
	FOR I3 = 0 TO 13
	IF I3 = B1(D, W5) OR AA$(D, I3) = "XXX" OR B%(D, I3, 18) <> 0 THEN 1002
	M9 = M9 + 1

1002 NEXT
	FOR I3 = 0 TO 13
	IF I3 = B1(D, W5) OR AA$(D, I3) = "XXX" OR B%(D, I3, 18) <> 0 THEN 1003
	IF A(D, I3, 0) <= A(D, B1(D, W5), 0) THEN A(D, I3, 3) = A(D, I3, 3) + INT((A(D, B1(D, W5), 3) / M9) + .5)

1003 NEXT I3
	RETURN

1033 IF C7 = 0 THEN 1034
	X8 = 45
	IF C7 = 2 THEN X8 = 35
	LS = 4
	IF T < 46 AND X8 >= T OR H > 2 AND T = 300 THEN LOCATE 5, 5: PRINT "     "
	IF T < 6 AND LS = 4 AND LT <> 4 THEN F = 5

1034 RETURN

1054 R0 = INT(RND(1) * 3) + 1: I2 = INT(RND(1) * 5)
	IF R0 <= A(P, B1(P, I2), 4) AND AA$(P, B1(P, B)) <> AA$(P, B1(P, I2)) THEN 1060
	IF A(P, B1(P, I2), 4) > 3 AND R0 < A(P, B1(P, I2), 4) - 3 AND AA$(P, B1(P, B)) <> AA$(P, B1(P, I2)) THEN 1060

1058 RETURN

1060 W5 = 0
	FOR M8 = 0 TO 4
	W5 = W5 + A(P, B1(P, M8), 4)
	NEXT
	R0 = INT(RND(1) * W5) + 1
	W5 = 0
	FOR M8 = 0 TO 4
	W5 = W5 + A(P, B1(P, M8), 4)
	IF R0 <= W5 THEN 1062
	NEXT

1062 I2 = M8
	IF AA$(P, B1(P, B)) = AA$(P, B1(P, I2)) THEN 1060
	A(P, B1(P, I2), 14) = A(P, B1(P, I2), 14) + 1
	GOTO 1058

1065 W5 = 0: M9 = INT(RND(1) * F5%(D, 0)) + 1
	FOR M8 = 0 TO 4: W5 = W5 + A(D, B1(D, M8), 17)
	IF M9 <= W5 THEN 1069
	NEXT M8

1069 IF M8 < 0 OR M8 > 4 THEN M8 = INT(RND(1) * 5)
	W5 = M8: RETURN

3000 PB$ = "": IF P = 1 THEN P = 0: D = 1: P9 = 0: C1 = 2: RETURN
	IF P = 0 THEN P = 1: D = 0: P9 = 1: C1 = 2: RETURN

TIEUP:
	IF PB% = 1 THEN GOTO RBTIEUP
	R0 = INT(RND(1) * 100) + 1
	IF R0 <= 20 THEN U$ = "BALL IS SLAPPED AWAY"
	IF R0 > 20 AND R0 <= 40 THEN U$ = "BALL IS LOOSE ON THE FLOOR"
	IF R0 > 40 AND R0 <= 60 THEN U$ = AA$(P, B1(P, B)) + " IS TRAPPED"
	IF R0 > 60 AND R0 <= 80 THEN U$ = "TRIES TO WORK LOOSE"
	IF R0 > 80 THEN U$ = AA$(P, B1(P, B)) + " IS PINNED ON THE LINE"
	CALL PBP
RBTIEUP:
	R0 = INT(RND(1) * 100) + 1
	P9 = INT(RND(1) * 5)
	IF PB% = 1 AND U6 <> 0 THEN CALL WINDEX: PRINT "JUMP BALL!": CALL DELAY: GOTO 5005
	IF R0 <= 25 THEN U$ = AA$(P, B1(P, B)) + " IS TIED UP BY " + AA$(D, B1(D, P9))
	IF R0 > 25 AND R0 <= 50 THEN U$ = AA$(D, B1(D, P9)) + " TIES UP " + AA$(P, B1(P, B))
	IF R0 > 50 AND R0 <= 75 THEN U$ = "HELD BALL!"
	IF R0 > 75 THEN U$ = "JUMP BALL!"
	CALL PBP

5005 U$ = "POSSESSION ARROW TO " + B$(PA%)
	GOSUB 729
	CALL DELAY
	IF PA% = D THEN T0(P) = T0(P) + 1: CALL DEADBALLOPTIONS: GOSUB BADPR: GOSUB 3000: C1 = 2: P9 = P: PA% = 1 - PA%: GOTO 300
	PA% = 1 - PA%: CALL DEADBALLOPTIONS: GOSUB BADPR: LT = 4: GOTO 350

8000 CALL MAINSCREEN
	U$ = "1 FT: " + AA$(P, B1(P, B)) + STR$(A(P, B1(P, B), 1)) + " %": CALL PBP
	X = 50: CALL DEADBALLOPTIONS: GOSUB BADPR: X = 0: A(P, B1(P, B), 9) = A(P, B1(P, B), 9) + 1
	U$ = "1 FT: " + AA$(P, B1(P, B)) + STR$(A(P, B1(P, B), 1)) + " %": CALL PBP
	F3 = 1: S = INT(RND(1) * 100) + 1
	FX% = A(P, B1(P, B), 1)
	IF FA%(P, B1(P, B)) <= -5 THEN FX% = INT(FX% * .9 + .5)
	IF S <= FX% THEN CALL THREEFT
	IF S > FX% THEN CALL BADFT
	LT = 0
	IF T <= 0 THEN TE = T: CALL PLAYINGTIME: GOTO 170
	IF S > FX% THEN 650
	GOSUB 3000: U$ = B$(P) + " BALL O.B. AFTER SCORE": GOSUB 871: CALL PBP: CALL DELAY: CALL STOPPAGE: B = 6: X = 0: CALL PRESSGUARD
	GOTO 300

8400 'CHECK SPECIAL EVENTS
	IF N = 2 OR ATT(1) = 0 THEN
		Y3 = INT(RND(1)* 2000) + 9000
	ELSE
		Y3 = INT(RND(1)* 2000) + ATT(1) - 1000
	END IF
	CALL RECORDSCHECK
	CALL EVENTS (COUNT, SPECIAL)
	 IF SPECIAL = 1 THEN
		NM$ = "BOX" + MID$(STR$(COUNT), 2, LEN(STR$(COUNT))) + ".SPC"
		CALL BOX2SPC(NM$)
	END IF

8500 GOSUB 8650
	CLS
	IF X = 1 THEN 8532
	CALL BOXTOP

8515 GOSUB 8670: GOSUB 8660
	CALL BOXSCREEN
	IF H > 2 THEN EG% = 1
	CALL TICKER: EG% = 0
	IF H = 2 THEN CALL FOULHARD: RETURN

8532 GOSUB 8655
	COLOR 15, 0
	CLS : I = 1: CALL DRAWBOX
	U$ = "DISPLAY STATS AGAIN (YN)"
	LOCATE , (80 - LEN(U$)) / 2
	PRINT U$
	COLOR 15, 0
	IF AP = 1 AND U5 = 2 THEN 8535
8533 I$ = GetKeyPress$
	IF UCASE$(I$) = "Y" THEN 8500

8535 COLOR 15, 0
	CLS : I = 1: CALL DRAWBOX
	U$ = "SAVE STATS (YN)"
	LOCATE , (80 - LEN(U$)) / 2
	PRINT U$
	COLOR 15, 0
	IF AP = 1 THEN 9506
	I$ = GetKeyPress$
	IF UCASE$(I$) <> "Y" THEN 9507

9506 CALL SAVESTATS

9507 COLOR 15, 0:
	CLS : I = 1: CALL DRAWBOX
	U$ = "PLAY ANOTHER GAME (YN)"
	LOCATE , (80 - LEN(U$)) / 2
	PRINT U$
	IF AP = 1 THEN 8637
	I$ = GetKeyPress$
	IF UCASE$(I$) <> "Y" THEN RUN "HELLO.EXE"

8637 COLOR 15, 0: CLS
	RUN "COLHOOP.EXE"

8650 CLS
	COLOR 14: PRINT "(0) "; : COLOR 15: PRINT "STATS TO SCREEN": PRINT
	COLOR 14: PRINT "(1) "; : COLOR 15: PRINT "STATS TO PRINTER": PRINT
	COLOR 14: PRINT "(2) "; : COLOR 15: PRINT "STATS TO TEXT FILE"
	IF AP = 1 AND U5 = 2 THEN X = 2: CALL FILEBOX: RETURN
8651 I$ = GetKeyPress$
	X = VAL(I$)
	IF X = 1 THEN CALL PRINTBOX
	IF X = 2 THEN CALL FILEBOX

8655 IF X >= 1 THEN X = 0
	RETURN

8660 IF X = 0 THEN CLS
	RETURN

8670 IF X = 0 THEN CALL HITKEY
	RETURN

9030 I2 = INT(RND(1) * 50) + 1: IF I2 = 43 AND TF% = 1 AND S > F3S% THEN A(P, B1(P, B), 7) = A(P, B1(P, B), 7) - 1: W%(P, B1(P, B), 1) = W%(P, B1(P, B), 1) - 1: GOSUB 1033: GOTO 9055
	IF I2 = 43 AND TF% = 1 AND S <= F3S% THEN 9040
	IF S > F3S% THEN 361
	GOTO 363

9040 T = T - 4: TE = 4: CALL PLAYINGTIME: GOSUB SHTCLK: CALL MAINSCREEN: GOSUB 1054
	U$ = "3 PT BASKET GOOD BY " + AA$(P, B1(P, B))
	CALL SELECTPBP
	GOSUB 1054
	U$ = "AND HE WAS FOULED !!!"
	GOSUB 729
	F3 = 1
	S(P, H) = S(P, H) + 3: S(P, 0) = S(P, 0) + 3: A(P, B1(P, B), 8) = A(P, B1(P, B), 8) + 1: W%(P, B1(P, B), 0) = W%(P, B1(P, B), 0) + 1: CALL MAINSCREEN: GOSUB 630
	GOTO 619

9055 T = T - 4: TE = 4: CALL PLAYINGTIME: GOSUB SHTCLK: CALL MAINSCREEN: GOSUB 630
	IF U6 = 0 THEN 9056
	IF PB% = 0 THEN U$ = "3 FT: " + AA$(P, B1(P, B)) + STR$(A(P, B1(P, B), 1)) + " %": CALL PBP: CALL DELAY: GOTO 9056
	CALL WINDEX: PRINT B$(P): PRINT "3 FT: "; AA$(P, B1(P, B)); "   "; A(P, B1(P, B), 1); " %"

9056 X = 50: CALL DEADBALLOPTIONS: GOSUB BADPR: X = 0: A(P, B1(P, B), 9) = A(P, B1(P, B), 9) + 3
	IF U6 = 0 THEN 9057
	IF PB% = 0 THEN U$ = "3 FT: " + AA$(P, B1(P, B)) + STR$(A(P, B1(P, B), 1)) + " %": CALL PBP: GOTO 9057
	CALL WINDEX: PRINT B$(P)
	PRINT "3 FT: "; AA$(P, B1(P, B)); "   "; A(P, B1(P, B), 1); " %"

9057 FOR F3 = 1 TO 3: S = INT(RND(1) * 100) + 1
	FX% = A(P, B1(P, B), 1)
	IF FA%(P, B1(P, B)) <= -5 THEN FX% = INT (FX% * .9 + .5)
	IF S <= FX% AND PB% = 0 THEN CALL THREEFT
	IF S <= FX% AND PB% = 1 THEN CALL MADEFT
	IF S > FX% AND PB% = 0 THEN CALL BADFT
	IF S > FX% AND PB% = 1 THEN CALL MISSFT
	NEXT F3: LT = 0
	IF T <= 0 THEN TE = T: CALL PLAYINGTIME: GOTO 170
	IF S > FX% THEN 650
	GOTO 598

9065 IF IN% = 1 THEN 9070
	IF TB% = 1 AND P2(D) >= 10 THEN 9070
	IF P2(D) > 6 THEN 570
	GOTO 567

9070 IF U6 = 0 THEN 9071
	IF PB% = 0 THEN U$ = "2 FT: " + AA$(P, B1(P, B)) + STR$(A(P, B1(P, B), 1)) + " %": CALL PBP: CALL DELAY: GOTO 9071
	CALL WINDEX: PRINT B$(P): PRINT "2 FT: "; AA$(P, B1(P, B)); "   "; A(P, B1(P, B), 1); " %"

9071 X = 50: CALL DEADBALLOPTIONS: GOSUB BADPR: X = 0
	IF U6 = 0 THEN 9072
	IF PB% = 0 THEN U$ = "2 FT: " + AA$(P, B1(P, B)) + STR$(A(P, B1(P, B), 1)) + " %": CALL PBP: GOTO 9072
	CALL WINDEX: PRINT B$(P)
	PRINT "2 FT: "; AA$(P, B1(P, B)); "   "; A(P, B1(P, B), 1); " %"

9072 FOR F3 = 1 TO 2: A(P, B1(P, B), 9) = A(P, B1(P, B), 9) + 1: S = INT(RND(1) * 100) + 1
	FX% = A(P, B1(P, B), 1)
	IF FA%(P, B1(P, B)) <= -5 THEN FX% = INT(FX% * .9 + .5)
	IF S <= FX% AND PB% = 0 THEN CALL THREEFT
	IF S <= FX% AND PB% = 1 THEN CALL MADEFT
	IF S > FX% AND PB% = 0 THEN CALL BADFT
	IF S > FX% AND PB% = 1 THEN CALL MISSFT
	NEXT F3
	IF T <= 0 THEN 170
	CALL CLEARPBPBOX: IF S > FX% AND IN% <> 1 THEN 650
	IF IN% = 1 THEN PASS% = 1: IN% = 0: X = 0: U$ = B$(P) + " BALL AFTER INT. FOUL": CALL SELECTPBP: GOSUB 871: CALL DELAY: CALL STOPPAGE: CALL PRESSGUARD: GOTO 300
	GOSUB 3000
	X = 0
	U$ = B$(P) + " BALL O.B. AFTER SCORE"
	GOSUB 871
	CALL SELECTPBP
	CALL DELAY
	CALL STOPPAGE
	CALL PRESSGUARD
	GOTO 300

'$INCLUDE: 'KeyInput.BM'
'$INCLUDE: 'QPProEqu.BM'
