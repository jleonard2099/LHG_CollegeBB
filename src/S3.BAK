DEFINT A-Z
DECLARE FUNCTION EXIST% (FILENAME$)
DECLARE SUB DRAWBOX ()
DECLARE SUB SHOTSTRING ()
DECLARE SUB MAMenu (BYVAL Address%, SELECTION%, Start%, Count%, EXITCODE%, FileColr%, HiLiteColr%, Rows%, Columns%, Spacing%, Row%, Column%)
  DIM NG%(18), NG1%(18), AP%(2), HF%(1, 6), DP(2, 4), FA%(1, 13), FY%(2), OF%(1), DT%(1), TM%(1, 13)
  DIM D8(4, 3), PR%(1, 1), PC%(1), CZ%(1), OB$(9), DB$(14)
  DIM R$(14), p$(1), X$(3), C7$(2), TS$(1), CM$(1), U5$(3), LC$(2), TB$(1)
  DIM TR%(1, 9), Y$(1), Z5(1), Z6(1), PS$(4), D2(1), S1(1), RB(9), P5(14), P4(14)
  DIM vg%(8), vh%(8), V1%(1), V2%(1), L%(1, 4), P2(1), YN$(5), PB$(1), N%(16, 16, 3), N$(16, 16, 3)
  DIM YN1$(3), TP%(1), TF%(1),Q$(250),O$(9),V%(500)
  DIM O%(100), HT%(100), HO$(100), H$(100), SX%(32, 1, 14), ST%(32)
  DIM APT%(100, 1), CRD(100) AS LONG, SITE$(100)
  DIM G9%(1), F5%(1, 8), W%(1, 13, 1), IY(1), O0%(1), V$(500), Z2(13, 13) AS SINGLE
  DIM F1(13), S3(13), G4(13), G5(13), D$(15), D1(1), W0(1, 13), W1(1, 13)
  DIM A(1, 13, 24) AS SINGLE, AA$(1, 13), B$(1), P7(1), R3(1), T0(1), T1(1), SX$(32, 2), W2(1, 13), W3(1, 13)
  DIM B1(1, 4), S(1, 9), V9(14), C(1, 13, 6), ZZ(1, 13), B%(1, 13, 18), Z(15) AS SINGLE, Z1(15) AS SINGLE
  DIM C$(1),S$(1),A1$(1),ATT(1) AS LONG,DF(1,13),PO$(1,13),RS(1,13,13),T2%(1,20)
  DIM E%(13), QQ(1, 8, 13, 14), QR(1, 7, 14)
COMMON SHARED APT%(), CRD() AS LONG, SITE$(), QQ(), QR()
COMMON SHARED I, TR%(), F5%(), P9, L%(), A() AS SINGLE, C(), V1%(), V2%()
COMMON SHARED p$(), B$(), S1(), D1(), AA$(), FY%(), B%(), U$, PASS%, U6 AS SINGLE, PT%, B1(), p, B, P7()
COMMON SHARED DK%, PZ%, FT%, X3%, XX%, FB%, F AS SINGLE, PB%, NL%
COMMON SHARED A1$, B1$, C1$, D1$, E1$, F1$, G1$, H1$, J$, vg%(), vh%()
COMMON SHARED AP,U5,HT%,G9,EG%,TMT,H,T AS SINGLE,TE AS SINGLE,SX$(),SX%(),R$(),TS%,ST%,ST%()
COMMON SHARED AP%(),N,S(),ZZ(),W%(),V9(),T0(),R3()
COMMON SHARED DB$(),DT%(),D2(),OB$(),OF%(),S3(),F1(),G5(),G4(),NF%
COMMON SHARED FF$,NG1%(),YN1$(),YN$(),NG%(),VT$,W$,W1$,VT1$
COMMON SHARED Z2() AS SINGLE,W2(),W0(),Z1() AS SINGLE,Z() AS SINGLE,W3(),O%(),HO$(),HT%(),H$(),Q
COMMON SHARED W1(),Y$(),Q$(),FA%(),X,P2(),T1(),D,CTO%,XM,C1
COMMON SHARED Z5(),Z6(),RB(),X8,C7,DY,S9,D$(),JJ,G9%(),XS,CM%
COMMON SHARED TB%,TF%,N7%,TOU,TF$,N$(),N%(),PA%,HF%(),S2
COMMON SHARED DP(),D8(),X$(),C7$(),O$(),TS$(),CM$(),U5$(),LC$()
COMMON SHARED TB$(),PB$(),J,MJ,P5(),P4(),PS$(),TM%(),CZ%(),PR%(),IN,M5
COMMON SHARED F3S%,J8%,F3,BO%,V$(),V%(),NT,X0%,X1%,TP%(),LC%,FO,PB$
COMMON SHARED BU%,YN$,y2 as long,R0 AS SINGLE,CT
COMMON SHARED C$(),S$(),A1$(),ATT() AS LONG,DF(),PO$(),RS(),T2%()
COMMON SHARED E%(), Y3 AS LONG

SUB TICKERCHECK ()
     IF AP<>1 OR AP%(2)>31 THEN 2581
     IF H=1 AND T<=960 AND SX%(AP%(2)+1,0,1)=-1 THEN SX%(AP%(2)+1,0,1)=S(0,0):SX%(AP%(2)+1,1,1)=S(1,0):GOTO 2581
     IF H=1 AND T<=720 AND SX%(AP%(2)+1,0,2)=-1 THEN SX%(AP%(2)+1,0,2)=S(0,0):SX%(AP%(2)+1,1,2)=S(1,0):GOTO 2581
     IF H=1 AND T<=480 AND SX%(AP%(2)+1,0,3)=-1 THEN SX%(AP%(2)+1,0,3)=S(0,1):SX%(AP%(2)+1,1,3)=S(1,1):GOTO 2581
     IF H=1 AND T<=240 AND SX%(AP%(2)+1,0,4)=-1 THEN SX%(AP%(2)+1,0,4)=S(0,0):SX%(AP%(2)+1,1,4)=S(1,0):GOTO 2581
     IF H=1 AND T<=120 AND SX%(AP%(2)+1,0,5)=-1 THEN SX%(AP%(2)+1,0,5)=S(0,0):SX%(AP%(2)+1,1,5)=S(1,0):GOTO 2581
     IF H>1 AND SX%(AP%(2)+1,0,6)=-1 THEN FOR I2=6 TO 8:SX%(AP%(2)+1,0,I2)=S(0,2)+S(0,1):SX%(AP%(2)+1,1,I2)=S(1,2)+S(1,1):NEXT:GOTO 2581
     IF H=2 AND T<=960 AND SX%(AP%(2)+1,0,9)=-1 THEN SX%(AP%(2)+1,0,9)=S(0,0):SX%(AP%(2)+1,1,9)=S(1,0):GOTO 2581
     IF H=2 AND T<=720 AND SX%(AP%(2)+1,0,10)=-1 THEN SX%(AP%(2)+1,0,10)=S(0,0):SX%(AP%(2)+1,1,10)=S(1,0):GOTO 2581
     IF H=2 AND T<=480 AND SX%(AP%(2)+1,0,11)=-1 THEN SX%(AP%(2)+1,0,11)=S(0,3)+S(0,2)+S(0,1):SX%(AP%(2)+1,1,11)=S(1,3)+S(1,2)+S(1,1):GOTO 2581
     IF H=2 AND T<=240 AND SX%(AP%(2)+1,0,12)=-1 THEN SX%(AP%(2)+1,0,12)=S(0,0):SX%(AP%(2)+1,1,12)=S(1,0):GOTO 2581
     IF H=2 AND T<=120 AND SX%(AP%(2)+1,0,13)=-1 THEN SX%(AP%(2)+1,0,13)=S(0,0):SX%(AP%(2)+1,1,13)=S(1,0):GOTO 2581
     SX%(AP%(2)+1,0,14)=S(0,0):SX%(AP%(2)+1,1,14)=S(1,0)
2581 REM
END SUB

SUB MAINSCREEN ()
     'M A I N   S C R E E N
     CALL TICKERCHECK
     LOCATE 2,1:LOCATE ,9:COLOR TR%(0,0),TR%(0,1):PRINT B$(0);
     LOCATE 1,37:COLOR 15,0:PRINT USING "##";INT(T/60);:PRINT ":";
     IF T<=5 THEN PRINT "0";:PRINT USING "#.#";T-INT(T/60)*60;:GOTO 2171
     IF T-INT(T/60)*60<10 THEN PRINT"0";:PRINT USING "#";T-INT(T/60)*60;:GOTO 2171
     PRINT USING "##";T-INT(T/60)*60;
2171 LOCATE 2,56:COLOR TR%(1,0),TR%(1,1):PRINT B$(1)
     LOCATE 4,13:COLOR 14,0:PRINT USING "###";S(0,0);
     LOCATE 2,33:PRINT " ";:IF PA%=0 THEN LOCATE ,33:PRINT CHR$(17);
     LOCATE 2,35:PRINT USING "  HALF #";H;:LOCATE ,44:PRINT " ";
     IF PA%=1 THEN LOCATE ,44:PRINT CHR$(16);
     IF H>2 THEN LOCATE ,35:PRINT USING "OVERTIME #";H-2;:LOCATE ,46:PRINT " ";:IF PA%=1 THEN LOCATE ,46:PRINT CHR$(16)
     LOCATE 4,60:COLOR 14,0:PRINT USING "###";S(1,0)
     COLOR 7:LOCATE 3,35:PRINT USING "##  ";T0(0);:COLOR 12:PRINT "TO  ";:COLOR 7:PRINT USING "##";T0(1)
     LOCATE ,35:PRINT USING "##  ";R3(0);:COLOR 12:PRINT "RB  ";:COLOR 7:PRINT USING "##";R3(1)
     LOCATE ,35:PRINT USING "##  ";P2(0);:COLOR 12:PRINT "TF  ";:COLOR 7:PRINT USING "##";P2(1);
     IF P2(0)>5 THEN LOCATE ,46:COLOR 0,2:PRINT "BONUS";:COLOR 7,0
     IF P2(1)>5 THEN LOCATE ,29:COLOR 0,2:PRINT "BONUS":COLOR 7,0
     LOCATE 6,9:PRINT "TIMEOUTS:"T1(0);:LOCATE ,56:PRINT "TIMEOUTS:"T1(1)
     COLOR 14,0:LOCATE 6,37:PRINT USING " :##";X8
     IF C7=0 OR T<45 AND X8>=T AND C7=1 OR T<35 AND X8>=T AND C7=2 OR (C7=1 OR C7=2) AND H>2 AND T=300 THEN LOCATE 6,37:PRINT " :  "
     IF U6=0 THEN 2172
     LOCATE 9,41
     COLOR TR%(D,0),TR%(D,1):PRINT "DEF-"DB$(DT%(D))
     LOCATE ,41:COLOR TR%(P,0),TR%(P,1):PRINT "OFF-"OB$(OF%(P))
     COLOR 15,0
     LOCATE 11,41:COLOR 14:PRINT "ENTER ";:COLOR 15:PRINT "PASS"
     LOCATE ,41:COLOR 14:PRINT "(1)  ";:COLOR 15:PRINT "SHOOT"
     LOCATE ,41:COLOR 14:PRINT "(2)  ";:COLOR 15:PRINT B$(P)" CALL TIMEOUT     "
     LOCATE ,41:COLOR 14:PRINT "(T)  ";:COLOR 15:PRINT "10 MIN TICKER"
     LOCATE ,41:COLOR 14:PRINT "(D)  ";:COLOR 15:PRINT "CHANGE DEFENSE FROM 2-3 ZONE"
     COLOR 15,0
     LOCATE 19,1
     FOR I1=0 TO 4:COLOR 2,0:PRINT USING "# ";I1;
     COLOR 3
     COLOR 15:PRINT LEFT$(AA$(0,B1(0,I1)),12) TAB(15);
     IF A(0,B1(0,I1),19)>=7 THEN PRINT "*";
     PRINT TAB(16);
     J=(A(0,B1(0,I1),3))-A(0,B1(0,I1),7)-A(0,B1(0,I1),11)-A(0,B1(0,I1),12):IF J<=0 THEN J=0
     PRINT USING "## ## ";A(0,B1(0,I1),0),A(0,B1(0,I1),1);
     IF P=0 THEN PRINT USING "##";A(0,B1(0,I1),21)*2/10; ELSE PRINT USING "##";A(0,B1(0,I1),2)*2/10;
     IF J<=0 AND (H=1 OR H=2 AND T>120) THEN COLOR 12
     PRINT USING "### ";J;
     COLOR 15
     IF FA%(0,B1(0,I1))*-1>=5 AND (H=1 OR H=2 AND T>120) THEN COLOR 12
     PRINT USING "## ";FA%(0,B1(0,I1))*-1;
     COLOR 15
     PRINT USING "##";A(0,B1(0,I1),4);
     PRINT USING "###  ";A(0,B1(0,I1),8)*2+A(0,B1(0,I1),10)+W%(0,B1(0,I1),0);
     IF A(0,B1(0,I1),12)>=4 THEN COLOR 12
     PRINT USING "#";A(0,B1(0,I1),12)
     COLOR 15
     NEXT I1
     LOCATE 19,40
     FOR I1=0 TO 4:LOCATE ,40:COLOR 2,0:PRINT USING "# ";I1;
     COLOR 15:PRINT LEFT$(AA$(1,B1(1,I1)),12) TAB(55);
     IF A(1,B1(1,I1),19)>=7 THEN PRINT "*";
     PRINT TAB(56);
     J=(A(1,B1(1,I1),3))-A(1,B1(1,I1),7)-A(1,B1(1,I1),11)-A(1,B1(1,I1),12):IF J<=0 THEN J=0
     PRINT USING "## ## ";A(1,B1(1,I1),0),A(1,B1(1,I1),1);
     IF P=1 THEN PRINT USING "##";A(1,B1(1,I1),21)*2/10; ELSE PRINT USING "##";A(1,B1(1,I1),2)*2/10;
     IF J<=0 AND (H=1 OR H=2 AND T>120) THEN COLOR 12
     PRINT USING "### ";J;
     COLOR 15
     IF FA%(1,B1(1,I1))*-1>=5 AND (H=1 OR H=2 AND T>120) THEN COLOR 12
     PRINT USING "## ";FA%(1,B1(1,I1))*-1;
     COLOR 15
     PRINT USING "##";A(1,B1(1,I1),4);
     PRINT USING "###  ";A(1,B1(1,I1),8)*2+A(1,B1(1,I1),10)+W%(1,B1(1,I1),0);
     IF A(1,B1(1,I1),12)>=4 THEN COLOR 12
     PRINT USING "#";A(1,B1(1,I1),12)
     COLOR 15
     NEXT I1
2172 REM
END SUB

SUB SCOREBOARD ()
     REM:*** SCREEN UPDATING ***
     CLS
     CALL TICKERCHECK
     COLOR 9,0
     LOCATE 3,11:PRINT CHR$(218);STRING$(5,196);CHR$(191)
     LOCATE ,11:PRINT CHR$(179);:LOCATE ,17:PRINT CHR$(179)
     LOCATE ,11:PRINT CHR$(192);STRING$(5,196);CHR$(217)
     LOCATE 3,58:PRINT CHR$(218);STRING$(5,196);CHR$(191)
     LOCATE ,58:PRINT CHR$(179);:LOCATE ,64:PRINT CHR$(179)
     LOCATE ,58:PRINT CHR$(192);STRING$(5,196);CHR$(217)
     LOCATE 2,1:LOCATE ,9:COLOR TR%(0,0),TR%(0,1):PRINT B$(0);
     LOCATE 1,37:COLOR 15,0:PRINT USING "##";INT(T/60);:PRINT ":";
     IF T-INT(T/60)*60<10 THEN PRINT"0";:PRINT USING "#";T-INT(T/60)*60;:GOTO 2505
     PRINT USING "##";T-INT(T/60)*60;
2505 LOCATE 2,56:COLOR TR%(1,0),TR%(1,1):PRINT B$(1)
     LOCATE 4,13:COLOR 14,0:PRINT USING "###";S(0,0);
     LOCATE 2,35:PRINT USING "  HALF #";H;
     IF H>2 THEN LOCATE ,35:PRINT USING "OVERTIME #";H-2
     LOCATE 4,60:COLOR 14,0:PRINT USING "###";S(1,0)
     COLOR 7:LOCATE 3,35:PRINT USING "##  ";T0(0);:COLOR 12:PRINT "TO  ";:COLOR 7:PRINT USING "##";T0(1)
     LOCATE ,35:PRINT USING "##  ";R3(0);:COLOR 12:PRINT "RB  ";:COLOR 7:PRINT USING "##";R3(1)
     LOCATE ,35:PRINT USING "##  ";P2(0);:COLOR 12:PRINT "TF  ";:COLOR 7:PRINT USING "##";P2(1);
     IF P2(0)>5 THEN LOCATE ,46:COLOR 0,2:PRINT "BONUS";:COLOR 7,0
     IF P2(1)>5 THEN LOCATE ,29:COLOR 0,2:PRINT "BONUS":COLOR 7,0
     LOCATE 6,9:PRINT "TIMEOUTS:"T1(0);:LOCATE ,56:PRINT "TIMEOUTS:"T1(1)
     LOCATE 9,41
     COLOR TR%(D,0),TR%(D,1):PRINT "DEF-"DB$(DT%(D))
     LOCATE ,41:COLOR TR%(P,0),TR%(P,1):PRINT "OFF-"OB$(OF%(P))
     COLOR 15,0
     LOCATE 11,41:COLOR 14:PRINT "ENTER";:COLOR 14:PRINT "-PASS"
     LOCATE ,41:COLOR 14:PRINT "(1)  ";:COLOR 15:PRINT "SHOOT"
     LOCATE ,41:COLOR 14:PRINT "(2)  ";:COLOR 15:PRINT B$(P)" CALL TIMEOUT     "
     LOCATE ,41:COLOR 14:PRINT "(T)  ";:COLOR 15:PRINT "10 MIN TICKER"
     LOCATE ,41:COLOR 14:PRINT "(D)  ";:COLOR 15:PRINT "CHANGE DEFENSE FROM 2-3 ZONE"
     LOCATE 7,1
     COLOR 9,0:PRINT STRING$(38,205);CHR$(203);STRING$(38,205)
     LOCATE 8,1:FOR I=1 TO 8:LOCATE ,39:PRINT CHR$(186):NEXT
     LOCATE 17,1:COLOR TR%(0,0),TR%(0,1):PRINT B$(0);
     PRINT USING " [##";Z5(0);:PRINT "-";:PRINT USING "##]";Z6(0)
     COLOR 14,0:PRINT "# NAME         FG FT RB CX EF PA PT  F"
     FOR I1=0 TO 4
     COLOR 2:PRINT USING "# ";I1;
     COLOR 3
     COLOR 15:PRINT LEFT$(AA$(0,B1(0,I1)),12);:LOCATE ,15
     IF A(0,B1(0,I1),19)>=7 THEN PRINT "*";
     LOCATE ,16
     J=(A(0,B1(0,I1),3))-A(0,B1(0,I1),7)-A(0,B1(0,I1),11)-A(0,B1(0,I1),12):IF J<=0 THEN J=0
     PRINT USING "##";A(0,B1(0,I1),0);
     PRINT USING "### ";A(0,B1(0,I1),1);
     IF P=0 THEN PRINT USING "##";A(0,B1(0,I1),21)*2/10; ELSE PRINT USING "##";A(0,B1(0,I1),2)*2/10;
     IF J<=0 AND (H=1 OR H=2 AND T>120) THEN COLOR 12
     PRINT USING "### ";J;
     COLOR 15
     IF FA%(0,B1(0,I1))*-1>=5 AND (H=1 OR H=2 AND T>120) THEN COLOR 12
     PRINT USING "## ";FA%(0,B1(0,I1))*-1;
     COLOR 15
     PRINT USING "##";A(0,B1(0,I1),4);
     PRINT USING "###  ";A(0,B1(0,I1),8)*2+A(0,B1(0,I1),10)+W%(0,B1(0,I1),0);
     IF A(0,B1(0,I1),12)>=4 THEN COLOR 12
     PRINT USING "#";A(0,B1(0,I1),12)
     COLOR 15
     NEXT I1
     LOCATE 17,40:COLOR TR%(1,0),TR%(1,1):PRINT B$(1);:PRINT USING " [##";Z5(1);:PRINT "-";:PRINT USING "##]";Z6(1)
     COLOR 14,0:LOCATE ,40:PRINT "# NAME          FG FT RB CX EF PA PT  F"
     FOR I1=0 TO 4:LOCATE ,40:COLOR 2:PRINT USING "# ";I1;
     COLOR 15:PRINT LEFT$(AA$(1,B1(1,I1)),12);:LOCATE ,55
     IF A(1,B1(1,I1),19)>=7 THEN PRINT "*";
     LOCATE ,56
     J=(A(1,B1(1,I1),3))-A(1,B1(1,I1),7)-A(1,B1(1,I1),11)-A(1,B1(1,I1),12):IF J<=0 THEN J=0
     PRINT USING "##";A(1,B1(1,I1),0);
     PRINT USING "### ";A(1,B1(1,I1),1);
     IF P=1 THEN PRINT USING "##";A(1,B1(1,I1),21)*2/10; ELSE PRINT USING "##";A(1,B1(1,I1),2)*2/10;
     IF J<=0 AND (H=1 OR H=2 AND T>120) THEN COLOR 12
     PRINT USING "### ";J;
     COLOR 15
     IF FA%(1,B1(1,I1))*-1>=5 AND (H=1 OR H=2 AND T>120) THEN COLOR 12
     PRINT USING "## ";FA%(1,B1(1,I1))*-1;
     COLOR 15
     PRINT USING "##";A(1,B1(1,I1),4);
     PRINT USING "###  ";A(1,B1(1,I1),8)*2+A(1,B1(1,I1),10)+W%(1,B1(1,I1),0);
     IF A(1,B1(1,I1),12)>=4 THEN COLOR 12
     PRINT USING "#";A(1,B1(1,I1),12)
     COLOR 15
     NEXT I1
     COLOR 9,0:FOR I=1 TO 9:LOCATE 14+I,39:PRINT CHR$(186):NEXT
     COLOR 9,0
     LOCATE 16,1:PRINT STRING$(79,205)
     LOCATE 16,39:PRINT CHR$(206):COLOR 7,0
END SUB

SUB COLCNG ()
   IF TR%(1,0)=15 AND TR%(1,1)=4 THEN TR%(1,0)=4:TR%(1,1)=7
   IF TR%(1,0)=15 AND TR%(1,1)=1 THEN TR%(1,0)=1:TR%(1,1)=7
   IF TR%(1,0)=0 AND TR%(1,1)=4 THEN TR%(1,0)=12:TR%(1,1)=0
   IF TR%(1,0)=1 AND TR%(1,1)=7 THEN TR%(1,0)=15:TR%(1,1)=1
   IF TR%(1,0)=4 AND TR%(1,1)=7 THEN TR%(1,0)=15:TR%(1,1)=4
END SUB

SUB LOADSTATS
   IF TR%(1,0)=TR%(0,0) AND TR%(1,1)=TR%(0,1) THEN CALL COLCNG
   COLOR 15,0
   FOR I=0 TO 1
   CLS
   CALL DRAWBOX
   U$="ENTER STATS DISK FOR "+B$(I)
   LOCATE ,(80-LEN(U$))/2
   PRINT U$
   PRINT
   IF UCASE$(LEFT$(P$(1),1))<>"A" AND UCASE$(LEFT$(P$(1),1))<>"B" THEN 64
   LOCATE ,12:PRINT "HIT ANY KEY TO CONTINUE";
63 I$=INKEY$:IF I$="" THEN 63
64 COLOR 15,0
   Y$(I)=B$(I)
   Q=I
   CALL STATCONVERT (Q,QQ)
   M$=MID$(B$(I),4,QQ)
   R$=M$+"."+LEFT$(B$(I),2)
   R$=R$+"S"
   IF NOT EXIST%(P$(1)+R$) THEN 66
   OPEN P$(1)+R$ FOR INPUT AS #2
   INPUT #2,YY%
   FOR I1=1 TO 100:INPUT #2,O%(I1):NEXT
   FOR I1=1 TO 100:INPUT #2,HO$(I1):NEXT
   FOR I1=1 TO 100:INPUT #2,HT%(I1):NEXT
   FOR I1=1 TO 100:INPUT #2,HO$(I1):NEXT
   FOR I1 = 1 TO 100
    FOR I2 = 0 TO 1: INPUT #2, APT%(I1, I2): NEXT: NEXT
    FOR I1 = 1 TO 100: INPUT #2, CRD(I1): NEXT I1
    FOR I1 = 1 TO 100: INPUT #2, SITE$(I1): NEXT I1
   CLOSE 2
   FOR I1=1 TO YY%
   IF O%(I1)>HT%(I1) THEN Z5(I)=Z5(I)+1
   IF O%(I1)<HT%(I1) THEN Z6(I)=Z6(I)+1
   NEXT
66 B$(I)=Y$(I)
   NEXT
END SUB

SUB OFFREBOUND ()
    RB=0:FOR I=0 TO 4:RB(I)=0
    XZ=A(P,B1(P,I),21)
    IF H>2 OR H=2 AND T<=120 THEN 793
    IF A(P,B1(P,I),3)-A(P,B1(P,I),7)-A(P,B1(P,I),11)-A(P,B1(P,I),12)<=0 THEN XZ=INT(XZ*.5 + .5)
793 IF FA%(P,B1(P,I))<=-5 THEN XZ=INT(XZ*.9 + .5)
    RB(I)=RB(I)+XZ:RB=RB+XZ
    NEXT
    RN=RND(1)*RB
    FOR B=0 TO 4
    IF RN<=RB(B) THEN 794
    RB(B+1)=RB(B+1)+RB(B)
    NEXT
    B=INT(RND(1)*5)
794 END SUB

SUB DEFREBOUND ()
    RB=0:FOR I=0 TO 4:RB(I)=0
    XZ=A(1-P,B1(1-P,I),2)
    IF H>2 OR H=2 AND T<=120 THEN 798
    IF A(1-P,B1(1-P,I),3)-A(1-P,B1(1-P,I),7)-A(1-P,B1(1-P,I),11)-A(1-P,B1(1-P,I),12)<=0 THEN XZ=INT(XZ*.5+.5)
798 IF FA%(1-P,B1(1-P,I))<=-5 THEN XZ=INT(XZ*.9 + .5)
    RB(I)=RB(I)+XZ:RB=RB+XZ
    NEXT
    RN=RND(1)*RB
    FOR B=0 TO 4
    IF RN<=RB(B) THEN 799
    RB(B+1)=RB(B+1)+RB(B)
    NEXT
    B=INT(RND(1)*5)
799 END SUB

SUB EDITCX()
9300 IF AP=1 AND U5=2 THEN 9499
     COLOR 15,0:CLS
     PRINT "EDIT CONTRIBUTION PERCENTAGES OF PLAYERS FROM:"
     PRINT
     COLOR 14:PRINT"(0) - ";:COLOR TR%(0,0),TR%(0,1):PRINT B$(0):COLOR ,0
     PRINT
     COLOR 14:PRINT"(1) - ";:COLOR TR%(1,0),TR%(1,1):PRINT B$(1):COLOR ,0
     PRINT
     COLOR 14:PRINT "(2) - ";:COLOR 3:PRINT "PROCEED TO GAME":COLOR 15,0
     PRINT
     PRINT "NOTE:: THE CONTRIBUTION RATING CONSISTS OF THE PLAYER'S"
     PRINT "       FREQUENCY TO SHOOT, REBOUND, AND COMMIT FOULS.
9301 I$=INKEY$:IF I$="" THEN 9301
     I=VAL(I$):IF I<0 OR I>2 THEN 9301
     IF I=2 THEN 9499
     CLS
     TX=0:FOR I1=0 TO 13:TX=TX+A(I,I1,3):NEXT
     FOR I1=0 TO 13:A(I,I1,3)=A(I,I1,3)/TX*100:NEXT
9305 LOCATE 2,1:PRINT "CONTRIBUTION RATINGS FOR ";:COLOR TR%(I,0),TR%(I,1):PRINT B$(I):COLOR 15,0
     PRINT:PRINT " #  PLAYER             CX"
     TY%=0:FOR I1=0 TO 13:TY%=TY%+A(I,I1,3)
     IF B%(I,I1,18)=-1 THEN COLOR TR%(I,0),TR%(I,1)
     PRINT USING "## ";I1+1;:PRINT AA$(I,I1);:LOCATE ,24:PRINT USING "##";A(I,I1,3)
     COLOR 15,0
     NEXT
     LOCATE ,23:PRINT USING "###";TY%
     INPUT "SELECT PLAYER TO CHANGE (0 TO CONTINUE)";I1:I1=I1-1
     IF I1>13 OR I1<0 THEN 9310
     LOCATE 22,1:PRINT "ENTER NEW CX RATING FOR "AA$(I,I1)" ";:INPUT A(I,I1,3)
9306 LOCATE 22,1:PRINT "                                                    ":GOTO 9305
9310 IF TY%=100 THEN 9320
     LOCATE 22,1:PRINT "TOTAL MUST ADD UP TO 100%! PRESS ANY KEY"
9311 I$=INKEY$:IF I$="" THEN 9311
     GOTO 9306
9320 FOR I1=0 TO 13:A(I,I1,3)=A(I,I1,3)/100*TX:NEXT
     GOTO 9300
9499 X=0
END SUB

SUB DELAY ()
     IF U6=0 THEN 2300
     U!=TIMER:WHILE TIMER<U!+U6:WEND
2300 REM
END SUB

SUB CLEARPBP ()
     IF U6=0 OR PB%=1 THEN 9750
     NL%=1:A1$="":B1$="":C1$="":D1$="":E1$="":F1$="":G1$="":H1$="":J$=""
9750 REM
END SUB

SUB ZONECHANGE ()
     IF U5=1 AND CT=D OR U5=2 THEN 8155
     IF DT%(D)<>2 OR DT%(D)<>7 OR DT%(D)<>12 THEN 8155
     IF OF%(P)>8 OR OF%(P)<4 THEN 8155
     JJ=8:CALL FRAME
     PRINT B$(D)" SELECT STRATEGY:"
     LOCATE 12,14
     LOCATE ,14:PRINT "0 - SOLID MAN TO MAN"
     LOCATE ,14:PRINT "1 - PRESSURE MAN TO MAN"
     LOCATE ,14:PRINT "2 - 1-3-1 TRAPPING ZONE"
8103 I$=INKEY$:IF I$="" THEN 8103
     I1=VAL(I$):IF I1<0 OR I1>2 THEN 8103
     IF I1=2 THEN I1=3
     IF DT%(D)<=3 THEN DT%(D)=I1
     IF DT%(D)=7 THEN DT%(D)=I+8
     IF DT%(D)=10 THEN DT%(D)=3
     IF DT%(D)=12 THEN DT%(D)=I+10
     IF DT%(D)=12 THEN DT%(D)=13
     P9=D
     IF DT%(P9)<=3 THEN P7(P9)=0
     IF DT%(P9)=4 THEN P7(P9)=1
     IF DT%(P9)=5 OR DT%(P9)=6 THEN P7(P9)=2
     IF DT%(P9)>6 AND DT%(P9)<=10 THEN P7(P9)=3
     IF DT%(P9)>9 AND DT%(P9)<14 THEN P7(P9)=4
     IF DT%(P9)=14 THEN P7(P9)=5
     IF DT%(P9)=0 OR DT%(P9)=4 OR DT%(P9)=5 OR DT%(P9)=8 OR DT%(P9)=10 THEN D2(P9)=0
     IF DT%(P9)=1 OR DT%(P9)=6 OR DT%(P9)=9 OR DT%(P9)=11 THEN D2(P9)=1
     IF DT%(P9)=2 OR DT%(P9)=7 OR DT%(P9)=12 THEN D2(P9)=2
     IF DT%(P9)=3 OR DT%(P9)=13 THEN D2(P9)=3
     COLOR 15,0
8155 COLOR 7,0

END SUB



SUB DEFENSEMENU ()
110 CLS
    PRINT TAB(33) "DEFENSIVE STYLE":PRINT
    FOR I=0 TO 14
    LOCATE ,5:PRINT USING "# ";I;
    IF I=10 THEN LOCATE,5:PRINT "A ";
    IF I=11 THEN LOCATE,5:PRINT "B ";
    IF I=12 THEN LOCATE ,5:PRINT "C ";
    IF I=13 THEN LOCATE ,5:PRINT "D ";
    IF I=14 THEN LOCATE ,5:PRINT "E ";
    PRINT D$(I)
    NEXT
    PRINT
    LOCATE 19,5:PRINT "SELECT DEFENSIVE STYLE FOR "B$(P9)
107 I$=INKEY$:IF I$="" THEN 107
    I1=VAL(I$)
    IF UCASE$(I$)="A" THEN I1=10
    IF UCASE$(I$)="B" THEN I1=11
    IF UCASE$(I$)="C" THEN I1=12
    IF UCASE$(I$)="D" THEN I1=13
    IF UCASE$(I$)="E" THEN I1=14
    IF I1<0 OR I1>14 THEN 107
    DT%(P9)=I1
    IF DT%(P9)<=3 THEN P7(P9)=0
    IF DT%(P9)=4 THEN P7(P9)=1
    IF DT%(P9)=5 OR DT%(P9)=6 THEN P7(P9)=2
    IF DT%(P9)>6 AND DT%(P9)<=10 THEN P7(P9)=3
    IF DT%(P9)>9 AND DT%(P9)<14 THEN P7(P9)=4
    IF DT%(P9)=14 THEN P7(P9)=5
    IF DT%(P9)=14 AND (H<2 OR H>=2 AND T>180) THEN BEEP:LOCATE 23,1:PRINT "CAN ONLY USE LAST 3 MIN OF 2ND HALF OR OT":CALL GETAKEY(i$):GOTO 110
    IF DT%(P9)=0 OR DT%(P9)=4 OR DT%(P9)=5 OR DT%(P9)=8 OR DT%(P9)=10 THEN D2(P9)=0
    IF DT%(P9)=1 OR DT%(P9)=6 OR DT%(P9)=9 OR DT%(P9)=11 THEN D2(P9)=1
    IF DT%(P9)=2 OR DT%(P9)=7 OR DT%(P9)=12 THEN D2(P9)=2
    IF DT%(P9)=3 OR DT%(P9)=13 THEN D2(P9)=3
    COLOR 15,0
END SUB

SUB SETSTAMINA ()
    SQ%=0
    FOR I=0 TO 13
    IF TR%(P9,5)=0 AND C(P9,I,0)=0 AND B%(P9,I,18)=0 THEN SQ%=SQ%+A(P9,I,3)
108 IF TR%(P9,5)<>0 AND C(P9,I,0)<>0 AND B%(P9,I,18)=0 THEN SQ%=SQ%+A(P9,I,3)*TR%(P9,5)/C(P9,I,0):A(P9,I,3)=A(P9,I,3)*TR%(P9,5)/C(P9,I,0)
117 NEXT
    FOR I=0 TO 13
116 IF TR%(P9,5)=0 AND C(P9,I,0)=0 AND B%(P9,I,18)=0 THEN A(P9,I,3)=INT(A(P9,I,3)/SQ%*S9+.5)
118 IF TR%(P9,5)<>0 AND C(P9,I,0)<>0 AND B%(P9,I,18)=0 THEN A(P9,I,3)=INT(A(P9,I,3)/SQ%*S9+.5)
112 IF A(P9,I,3)<1 THEN A(P9,I,3)=1
    NEXT I
    SQ%=0:FOR I=0 TO 13
113 IF B%(P9,I,18)=0 THEN SQ%=SQ%+A(P9,I,3)
    NEXT
    FOR I=0 TO 13
114 IF S9>120 AND F5%(P9,8)<>99 THEN A(P9,I,16)=A(P9,I,16)*(120/S9):A(P9,I,16)=INT(A(P9,I,16)+.5)
    NEXT I
    DY=7
115 IF S9>114 THEN DY=(114/S9)*DY:DY=INT(DY+.5)
END SUB

SUB FRAME ()
     SN=1:LOCATE 8,8:COLOR TR%(TS%,0),TR%(TS%,1)
     PRINT " Ö"; STRING$(61,196);"· ";:FOR II=1 TO JJ:LOCATE 8+II,8
     PRINT " º"; STRING$(61,32); "º ";:NEXT
     LOCATE 9+JJ,8
     PRINT " Ó";STRING$(61,196); "½ ";:LOCATE 10,15
END SUB

SUB COMPUTERSUB ()
930 IF H>=2 AND T<=60 AND X3%=1 AND (S(P9,0)-S(1-P9,0)=-3 OR S(P9,0)-S(1-P9,0)=-6) THEN OF%(P9)=9
    M1=0:M2=0:M3=0:M4=0
    IF U5=1 AND P9=CT AND X=50 OR U5=2 AND P9=P AND X=50 THEN 939
    FOR I1=0 TO 13
    M6=A(P9,I1,3)-A(P9,I1,7)-A(P9,I1,11)-A(P9,I1,12)
    IF H<2 AND M6<=0 OR H=2 AND T>120 AND M6<=0 THEN M1=M1+1
    IF A(P9,I1,12)>=NF% OR AA$(P9,I1)="XXX" OR B%(P9,I1,18)<>0 THEN M2=M2+1
    IF I1>4 THEN 937
    M6=A(P9,B1(P9,I1),3)-A(P9,B1(P9,I1),7)-A(P9,B1(P9,I1),11)-A(P9,B1(P9,I1),12)
    IF H=1 AND M6/A(P9,B1(P9,I1),3)<.5 THEN M3=M3+1
    IF H=1 AND T>=600 AND M6/A(P9,B1(P9,I1),3)<.75 THEN M3=M3+1
    IF H=2 AND T>=600 AND M6/A(P9,B1(P9,I1),3)<.25 THEN M3=M3+1
    IF H=2 AND T>=300 AND T<600 AND M6/A(P9,B1(P9,I1),3)<.13 THEN M3=M3+1
    IF H=2 AND T<300 AND M6/A(P9,B1(P9,I1),3)<T/2400 THEN M3=M3+1
    IF M6<=0 AND H<2 OR M6<=0 AND H=2 AND T>120 THEN M3=M3+1
    IF A(P9,B1(P9,I1),12)>=NF% OR A(P9,B1(P9,I1),12)>=NF%-2 AND H=1 OR H=2 AND T>720 AND A(P9,B1(P9,I1),12)>=NF%-1 THEN M4=M4+1
937 NEXT
    IF M3>=1 AND 5-M3<14-M1 OR H=2 AND T<120 AND XS=0 AND G9%(P9)=0 OR M4>=1 AND M2<13 OR CTO%=1 THEN CTO%=0:XM=1:CALL COMCOACH:GOTO 940
939 IF H=2 AND T<=120 THEN G9%(P9)=1
940 END SUB

SUB FATIGUE ()
    REM:COMPUTER DEFENSE FOR FATIGUE
    FD%=0:FQ%=0
    FOR I=0 TO 4
    FD%=FD%+FA%(P9,B1(P9,I))
    IF FA%(P9,B1(P9,I))<=-4 THEN FQ%=1
    NEXT
    IF FD%<-15 OR FQ%=1 THEN D2(P9)=2:P7(P9)=0:DT%(P9)=2
END SUB

SUB AUTOSETUP ()
     X3%=NG%(3):U5=NG%(8):NF%=NG%(5):C7=NG%(7):N=NG%(2):U6=NG%(4)/10:CM%=NG%(9)
     ST%=NG%(12)
     TB%=NG%(6):TF%=NG%(10):N7%=NG%(14)
     FOR P9=0 TO 1:I1=NG%(P9):YN$=YN$(P9):CALL GETATEAM (I1,YN$):CALL TEAMSETUP:NEXT P9
     IF TOU <> 1 THEN 1305
1302 IF RIGHT$(FF$, 1) = " " THEN FF$ = LEFT$(FF$, LEN(FF$) - 1):GOTO 1302
1303 IF RIGHT$(YN$(0), 1) = " " THEN YN$(0) = LEFT$(YN$(0), LEN(YN$(0)) - 1):GOTO 1303
1304 IF RIGHT$(YN$(1), 1) = " " THEN YN$(1) = LEFT$(YN$(1), LEN(YN$(1)) - 1):GOTO 1304

     OPEN P$(0) + FF$ + ".INF" FOR INPUT AS #2
     INPUT #2, X$
     INPUT #2, X$: REM NUMBER OF REGIONS
     FOR I = 1 TO 16
     INPUT #2, X$: REM NUMBER OF TEAMS IN REGION
     INPUT #2, X$: REM NAME OF REGION
     NEXT
     FOR I = 1 TO 16
     FOR I1 = 1 TO 16
     FOR I2 = 0 TO 3
     INPUT #2, N$(I, I1, I2): REM SEED SLOT NAME
     INPUT #2, N%(I, I1, I2): REM REGION, SEED NUMBER, MODE PLAY/TM#
     NEXT: NEXT: NEXT
     CLOSE 2

     TOU = 0
     FOR I = 1 TO 16
     FOR I1 = 1 TO 16
     'PRINT LEN(YN$(0)),LEN(YN$(1)),LEN( N$(I,I1,1) )
     IF NG%(0) = N%(I, I1, 0) AND YN$(0) = N$(I, I1, 1) AND N%(I, I1, 1) = 0 THEN TOU = 1:GOTO 1305
     IF NG%(1) = N%(I, I1, 0) AND YN$(1) = N$(I, I1, 1) AND N%(I, I1, 1) = 0 THEN TOU = 1:GOTO 1305
     NEXT:NEXT
1305 END SUB

SUB INITIALIZE ()
  NL%=1
  PA%=-1
  TR%(0,0)=15:TR%(0,1)=1
  TR%(1,0)=15:TR%(1,1)=1
  DATA L,1,1,1,1,1,1,H,H,2,2,2,2,2,F
  FOR I=0 TO 14:READ R$(I):NEXT
  DATA 0,1,1,2,2,2,-1,-1,-1,-1,-2,-3
  FOR I=0 TO 1:FOR I1=1 TO 6:READ HF%(I,I1):NEXT:NEXT
  DATA 1,4,2,5,15,29,22,36,7,9,7,12
  FOR I=0 TO 2:FOR I1=1 TO 4:READ DP(I,I1):NEXT:NEXT
  DATA -7,-10,-4,-10,70,100,20,100,-1,1,-2,2,15,22,8,29,5,7,3,9
  FOR I=0 TO 4:FOR I1=0 TO 3:READ D8(I,I1):NEXT:NEXT
  OPEN "DEV.BAS" FOR INPUT AS #2:INPUT #2,P$(0):INPUT #2,P$(1):CLOSE 2
  OPEN "DEFAULT" FOR INPUT AS #1
  INPUT #1,U5:INPUT #1,X3%:INPUT #1,C7:INPUT #1,N:INPUT #1,NF%:INPUT #1,U6:INPUT #1,CM%:INPUT #1,TB%:INPUT #1,TF%:INPUT #1,N7%:INPUT #1,PB%:CLOSE 1

   IF NOT EXIST%("TICKER") THEN TMT=0:GOTO 5
   OPEN "TICKER" FOR INPUT AS #2
   FOR I=1 TO 32:FOR I1=0 TO 1:FOR I2=1 TO 14
   INPUT #2,SX%(I,I1,I2):NEXT:NEXT:NEXT
   FOR I=1 TO 32:FOR I1=0 TO 1:INPUT #2,SX$(I,I1):NEXT:NEXT
   FOR I=1 TO 32:INPUT #2,ST%(I):NEXT
   CLOSE 2
   TMT=1

5  IF NOT EXIST%("GAME82") THEN 6

OPEN "GAME82" FOR INPUT AS #2
  INPUT #2,FF$
  FOR I=0 TO 2:INPUT #2,AP%(I):NEXT
  CLOSE 2
    OPEN P$(0) + FF$ FOR RANDOM AS #1 LEN = 48
    FOR X = 0 TO 18
    FIELD #1, X * 2 AS X$, 2 AS Q$(X + 1), 48 - 2 - 2 * X AS X$
    NEXT
    FIELD #1, 38 AS X$, 2 AS Q$(22), 2 AS Q$(23), 3 AS Q$(20), 3 AS Q$(21)
    GET #1, AP%(0) + AP%(2)
    FOR X = 0 TO 18: NG%(X) = CVI(Q$(X + 1)): NEXT
    FOR X = 0 TO 1: YN$(X) = Q$(20 + X): NEXT
    VS% = CVI(Q$(22)): HS% = CVI(Q$(23))
    CLOSE 1
  AP=1

6 IF NOT EXIST%("TOURNEY") THEN 10
  OPEN "TOURNEY" FOR INPUT AS #2
  INPUT #2,FF$
  FOR I=0 TO 2:INPUT #2,AP%(I):NEXT
  CLOSE 2
  IF AP%(2) = AP%(1) THEN KILL "TOURNEY":END
  OPEN P$(0) + FF$ + ".TOU" AS #1 LEN=90
   FOR X=0 TO 14
    FIELD #1,X*2 AS X$,2 AS Q$(X+1),90-2-2*X AS X$
    NEXT
    FIELD #1,30 AS X$,2 AS Q$(16),2 AS Q$(17),15 AS Q$(18),15 AS Q$(19),26 AS X$
    FIELD #1,64 AS X$,3 AS Q$(20),3 AS Q$(21),6 AS Q$(22),8 AS Q$(23),6 AS X$
    FIELD #1,84 AS X$,2 AS Q$(24),2 AS Q$(25),2 AS Q$(26)
    GET #1,AP%(0)+AP%(2)
    VS%=CVI(Q$(16)):HS%=CVI(Q$(17))
    VT$=Q$(18):W$=Q$(19)
    FOR X=0 TO 14:NG%(X)=CVI(Q$(X+1)):NEXT
    FOR X=0 TO 3:YN$(X)=Q$(20+X):NEXT
    FOR X=1 TO 3:NG%(X+14)=CVI(Q$(X+23)):NEXT
    CLOSE 1
    AP=1:TOU = 1

10 T=1200:H=1:T1(1)=5:T1(0)=5:X$(0)="A ":X$(1)="B ":X$(2)="C ":X$(3)="D "
   C7$(0)="NO SHOT CLOCK    ":C7$(1)="45 SEC SHOT CLOCK":C7$(2)="35 SEC SHOT CLOCK"
   DATA "NORMAL"
   DATA "AGGRESSIVE"
   DATA "SAFE"
   DATA "QUICK OFFENSE (LAST 3 MIN)"
   DATA "DELAY OFFENSE (LAST 3 MIN)"
   DATA "MILK CLOCK TO 15 SEC (IF USING SHOT CLOCK)"
   DATA "STALL-ONLY REAL GOOD SHOT (MUST BE WITHIN 10 POINTS)"
   DATA "TOTAL STALL (LAST 3 MIN)"
   DATA "HOLD BALL VS PASSIVE ZONE (MUST BE AHEAD, WITH NO SHOT CLOCK)"
   DATA "SHOOT ONLY THREE POINTERS (LAST 3 MIN)"
   FOR I=0 TO 9:READ O$(I):NEXT
   TS$(0)="N":TS$(1)="Y"
   CM$(0)="COACH AND SELECT SHOTS           "
   CM$(1)="COACH ONLY AND LET COMPUTER SHOOT"
   U5$(0)="HUMAN OPPONENT           "
   U5$(1)="COMPUTER IS VISITING TEAM"
   U5$(2)="COMPUTER IS HOME TEAM    "
   U5$(3)="COMPUTER VS COMPUTER     "
   LC$(0)="@ TEAM 1    "
   LC$(1)="HOME COURT ADVANTAGE"
   LC$(2)="NEUTRAL SITE        "
   TB$(0)="SHOOT 1+1":TB$(1)="SHOOT 2  "
   PB$(0)="VERBOSE        "
   PB$(1)="HAFFNER CLASSIC"
   DATA "SOLID MAN TO MAN"
   DATA "PRESSURE MAN TO MAN"
   DATA "PASSIVE 2-3 ZONE"
   DATA "1-3-1 TRAPPING ZONE"
   DATA "FULL COURT MAN TO MAN PRESS/SOLID MAN TO MAN"
   DATA "FULL COURT MAN TO MAN (RUN & JUMP) PRESS/SOLID MAN TO MAN"
   DATA "FULL COURT MAN TO MAN (RUN & JUMP) PRESS/PRESSURE MAN TO MAN"
   DATA "PASSIVE 2-2-1 ZONE PRESS/2-3 ZONE"
   DATA "PASSIVE 2-2-1 ZONE PRESS/SOLID MAN TO MAN"
   DATA "PASSIVE 2-2-1 ZONE PRESS/PRESSURE MAN TO MAN"
   DATA "TRAPPING 1-2-1-1 ZONE PRESS/SOLID MAN TO MAN"
   DATA "TRAPPING 1-2-1-1 ZONE PRESS/PRESSURE MAN TO MAN"
   DATA "TRAPPING 1-2-1-1 ZONE PRESS/2-3 ZONE  "
   DATA "TRAPPING 1-2-1-1 ZONE PRESS/1-3-1 TRAPPING ZONE"
   DATA "FULL COURT M-M DENIAL & FOUL (LAST 3 MIN WHEN DOWN)"
   FOR I=0 TO 14:READ D$(I):NEXT I
   DATA "NORMAL                            "
   DATA "AGGRESSIVE                        "
   DATA "SAFE                              "
   DATA "QUICK OFFENSE (LAST 3 MIN)        "
   DATA "DELAY OFFENSE (LAST 3 MIN)        "
   DATA "MILK CLOCK TO 15 SEC-IF USING S.C."
   DATA "STALL-GOOD SHOT-MUST BE WITHIN 10 "
   DATA "TOTAL STALL (LAST 3 MIN)          "
   DATA "HOLD BALL VS PASS.ZN-AHEAD-NO S.C."
   DATA "SHOOT ONLY THREES (LAST 3 MIN)    "
   FOR I=0 TO 9:READ OB$(I):NEXT
   DATA "SOLID MAN TO MAN                  "
   DATA "PRESSURE MAN TO MAN               "
   DATA "PASSIVE 2-3 ZONE                  "
   DATA "1-3-1 TRAPPING ZONE               "
   DATA "FULL COURT M-M PRESS/SOLID M-M    "
   DATA "M-M (RUN & JUMP) PRESS/SOLID M-M  "
   DATA "M-M (RUN & JMP) PRESS/PRESSURE M-M"
   DATA "PASSIVE 2-2-1 ZONE PRESS/2-3 ZONE "
   DATA "PASSIVE 2-2-1 ZONE PRESS/SOLID M-M"
   DATA "PASSIVE 2-2-1 ZN PRSS/PRESSURE M-M"
   DATA "TRAP 1-2-1-1 ZONE PRESS/SOLID M-M "
   DATA "TRAP 1-2-1-1 ZN PRESS/PRESSURE M-M"
   DATA "TRAP 1-2-1-1 ZONE PRESS/2-3 ZONE  "
   DATA "TRAP 1-2-1-1 ZN PRSS/1-3-1 TRAP ZN"
   DATA "DENIAL & FOUL-LAST 3 MIN WHEN DOWN"
   FOR I=0 TO 14:READ DB$(I):NEXT I
   FOR I=0 TO 1:FOR I1=0 TO 4:B1(I,I1)=-1
   NEXT I1:NEXT I
END SUB


SUB LINEUPS ()
   CLS
   COLOR TR%(P9,0),TR%(P9,1):PRINT B$(P9);:COLOR 15,0:PRINT " TEAM ROSTER    COACH: "C$(P9);
   PRINT "  RECORD: ";:PRINT USING "##";TR%(P9, 7);:PRINT "-";:PRINT USING "##";TR%(P9, 8)
   COLOR 14:PRINT "# NAME         POS FG  FT 3FG %3A ORB DRB RB PA  S  B CX EF  PT  F  FC  PTS/G"
   LOCATE 3,1
   FOR R1=0 TO 13
   IF B%(P9,R1,18)<>0 OR AA$(P9,R1)="XXX" OR AA$(P9,R1)="" THEN 71
   COLOR 2
   IF R1<=9 THEN PRINT USING "# ";R1;
   IF R1>9 THEN PRINT X$(R1-10);
   COLOR 15
   PRINT LEFT$(AA$(P9,R1),12);
   LOCATE ,16:PRINT PO$(P9, R1);
   LOCATE ,20
   L=0:L=A(P9,R1,3)-A(P9,R1,7)-A(P9,R1,11)-A(P9,R1,12):IF L<=0 THEN L=0
   PRINT USING "## ###  ##  ##  ##  ## ## ";A(P9,R1,0),A(P9,R1,1),A(P9,R1,20),A(P9,R1,19),A(P9,R1,21)*2/10,A(P9,R1,2)*2/10,(A(P9,R1,2)+A(P9,R1,21))/5;
   PRINT USING "## ## ##";A(P9,R1,4),A(P9,R1,5),A(P9,R1,6);
   IF L<=0 AND (H=1 OR H=2 AND T>120) THEN COLOR 12
   PRINT USING "### ";L;
   COLOR 15
   IF FA%(P9,R1)*-1>=5 AND (H=1 OR H=2 AND T>120) THEN COLOR 12
   PRINT USING "##";FA%(P9,R1)*-1;
   COLOR 15
   LOCATE ,61:PRINT USING"###  ";A(P9,R1,8)*2+A(P9,R1,10)+W%(P9,R1,0);
   IF A(P9,R1,12)>=4 THEN COLOR 12
   PRINT USING "# ";A(P9,R1,12);
   COLOR 15
   PRINT USING "###   ";A(P9,R1,17);

   IF RS(P9,R1,0) = 0 THEN
      PRINT "--.-"
   ELSE
      PRINT USING "##.#";(RS(P9,R1,3)*2+RS(P9,R1,5)+RS(P9,R1,13))/RS(P9,R1,0)
   END IF

71 NEXT R1
   LOCATE 18,1:COLOR 9,0:PRINT STRING$(27,205);CHR$(203);STRING$(51,205)
   FOR R1=1 TO 7:LOCATE R1+18,28:PRINT CHR$(186);:NEXT
   LOCATE 19,1:COLOR 14,0:PRINT "STARTING LINEUP"
   IF C1=1 THEN
      FOR M=0 TO 4
      LOCATE M+20,1
      COLOR 2,0
      PRINT USING "# ";M;
      COLOR 15,0
      PRINT "ENTER "PS$(M);" # ";
      Z=B1(P9,M)
      GOSUB 90
      PRINT AA$(P9,Z);:LOCATE Z+3-CV%,3
      COLOR TR%(P9,0),TR%(P9,1)
      PRINT LEFT$(AA$(P9,Z),12)
      COLOR 15,0
      NEXT
      GOTO 73
   END IF

   FOR I=0 TO 4
   LOCATE I+20,1
   COLOR 2,0:PRINT USING "# ";I;:COLOR 15:PRINT "ENTER "PS$(I);" # ";
72 I$=INKEY$:IF I$="" THEN 72
   CALL ALPHANUM (I$, J)
   IF J<0 OR J>13 OR A(P9,J,12)>=NF% OR AA$(P9,J)="XXX" OR B%(P9,J,18)<>0 THEN 72
   FOR I2=0 TO 4:IF B1(P9,I2)=J THEN 72
   NEXT I2
   B1(P9,I)=J
   Z=J
   GOSUB 90
   PRINT AA$(P9,J);
   LOCATE J+3-CV%,3:COLOR TR%(P9,0),TR%(P9,1)
   PRINT LEFT$(AA$(P9,J),12)
   COLOR 15,0
   NEXT

73 LOCATE 25,1:COLOR 12,0:PRINT "# TO CHANGE (0-4) 6=NONE";
   LOCATE 1,1
74 I$=INKEY$:IF I$="" THEN 74
   I1=VAL(I$):IF I1=6 THEN 100
   IF I1<0 OR I1>4 THEN 73
   IF X=50 AND I1=B AND P9=P THEN LOCATE 20,29:COLOR 14,0:PRINT AA$(P9,B1(P9,I1))" IS AT THE FT LINE":GOTO 73
   LOCATE 25,1:PRINT "                         ";
   J=B1(P9,I1):Z=J:TM%(P9,J)=T:GOSUB 90:LOCATE J+3-CV%,3:COLOR 15,0:PRINT LEFT$(AA$(P9,J),12)
   LOCATE I1+20,1:PRINT "                          ";
   B1(P9,I1)=-1
   LOCATE ,1:COLOR 2:PRINT USING"# ";I1;:COLOR 15:PRINT "ENTER "PS$(I1);" # ";
75 I$=INKEY$:IF I$="" THEN 75
   CALL ALPHANUM (I$, J)
   IF J<0 OR J>13 OR A(P9,J,12)>=NF% OR AA$(P9,J)="XXX" OR B%(P9,J,18)<>0 THEN 75
   FOR I2=0 TO 4:IF B1(P9,I2)=J THEN 75
   NEXT I2
   B1(P9,I1)=J:Z=J:GOSUB FATIGUE:GOSUB 90:PRINT AA$(P9,J);:LOCATE J+3-CV%,3:COLOR TR%(P9,0),TR%(P9,1):PRINT LEFT$(AA$(P9,J),12):COLOR 15,0
   GOTO 73

FATIGUE:
   IF TM%(P9,J)-T>60 AND TM%(P9,J)<120 THEN FA%(P9,J)=FA%(P9,J)+1
   IF TM%(P9,J)-T>=120 THEN FA%(P9,J)=FA%(P9,J)+4
   IF FA%(P9,J)>0 THEN FA%(P9,J)=0
   RETURN



90  CV%=0:FOR IP%=0 TO Z
    IF B%(P9,IP%,18)<>0 OR AA$(P9,IP%)="" OR AA$(P9,IP%)="XXX" THEN CV%=CV%+1
    NEXT
    RETURN

100 CV%=0
    FOR I1=0 TO 13
    IF B%(P9,I1,18)<>0 OR AA$(P9,I1)="XXX" OR A(P9,I1,12)>=NF% THEN CV%=CV%+1
    NEXT
    IF 14-CV%<5 THEN GOTO MENUS
    FOR I1=0 TO 4
    IF A(P9,B1(P9,I1),12)>=NF% THEN LOCATE 20,29:COLOR 14,0:PRINT AA$(P9,B1(P9,I1))" HAS FOULED OUT":GOTO 73
    NEXT
MENUS:
    CALL OFFENSE
END SUB


SUB OFFENSE ()
OFFENSE:
109 COLOR TR%(P9,0),TR%(P9,1):CLS
    PRINT TAB(33) "OFFENSIVE STYLE":PRINT
    FOR I=0 TO 9
    LOCATE ,5:PRINT USING "# ";I;:PRINT O$(I)
    NEXT
    PRINT
    LOCATE 14,5:PRINT "SELECT OFFENSIVE STYLE FOR "B$(P9)
106 I$=INKEY$:IF I$="" THEN 106
    I1=VAL(I$):IF I1<0 OR I1>9 THEN 106
    IF (I1=3 OR I1=4 OR I1=7 OR I1=9) AND (H<2 OR H>=2 AND T>180) THEN BEEP:LOCATE 18,1:PRINT "CAN ONLY USE LAST 3 MIN OF 2ND HALF OR OT":CALL GETAKEY(I$):GOTO 109
    IF I1=8 AND D2(1-P9)<>2 THEN BEEP:LOCATE 18,1:PRINT "DEFENSE NOT IN PASSIVE ZONE":CALL GETAKEY(I$):GOTO 109
    IF I1=4 AND S(P9,0)-S(1-P9,0)>-11 THEN BEEP:LOCATE 18,1:PRINT "ILLEGAL SELECTION":CALL GETAKEY(I$):GOTO 109
    IF I1=9 AND X3%=0 THEN BEEP:LOCATE 18,1:PRINT "NOT USING 3 POINT SHOT":CALL GETAKEY(I$):GOTO 109
    IF I1=5 AND C7=0 THEN BEEP:LOCATE 18,1:PRINT "NOT USING SHOT CLOCK":CALL GETAKEY(I$):GOTO 109
    IF I1=7 AND S(P9,0)-S(1-P9,0)<=0 THEN BEEP:LOCATE 18,1:PRINT "ILLEGAL SELECTION":CALL GETAKEY(I$):GOTO 109
    OF%(P9)=I1
    CZ%(P9)=0
    IF H<2 OR H>=2 AND T>120 THEN GOTO DEFENSE
    PRINT "CRASH OFFENSIVE BOARDS (LAST 2 MIN) (YN)";
111 I$=INKEY$:IF I$="" THEN 111
    IF UCASE$(I$)="Y" THEN CZ%(P9)=1


DEFENSE:
    CALL DEFENSEMENU
END SUB


SUB FOULSAFE ()
1200 CLS:COLOR 15:A=0:S2=1:S3=1:SW=0:FOR ZZ=0 TO 4
     IF A(P9,B1(P9,ZZ),22)=50 THEN A=A+1:IF SW=0 THEN PRINT:PRINT "THE FOLLOWING PLAYER(S) ARE PLAYING SAFE BUT CAN NOW PLAY NORMAL IF YOU WISH":SW=1
     IF A(P9,B1(P9,ZZ),22)=50 AND SW=1 AND S2<6 THEN LOCATE S2+3,1:PRINT S2;"-";AA$(P9,B1(P9,ZZ)):P5(A)=S2:P4(A)=ZZ:S2=S2+1:S3=S3+1
     NEXT ZZ:IF SW=0 THEN 1214
     A=1:PRINT:PRINT "Z - CONTINUE"
1206 I$=INKEY$:IF I$="" THEN 1206
     IF UCASE$(I$)="Z" AND MJ=0 THEN 1214
     IF UCASE$(I$)="Z" AND MJ=25 THEN 1230
     P6=VAL(I$):IF P6<1 OR P6>(S2+1) THEN 1206
     A=P6:IF P6=P5(P6) THEN A(P9,B1(P9,P4(A)),17)=A(P9,B1(P9,P4(A)),17)*3:A(P9,B1(P9,P4(A)),22)=0:LOCATE P5(A)+3,20:PRINT AA$(P9,B1(P9,P4(A)))" WILL NOW PLAY NORMAL DEFENSE!":CALL STEALADJ:D1(P9)=D1(P9)-1:A=A+1:MJ=25:GOTO 1206
1214 A=0:S2=1:FOR ZZ=0 TO 4
     IF H<=1 AND A(P9,B1(P9,ZZ),12)>=NF%-3 AND A(P9,B1(P9,ZZ),22)=0 OR A(P9,B1(P9,ZZ),12)=NF%-1 AND A(P9,B1(P9,ZZ),22)=0 THEN A=A+1:IF S2=1 THEN CLS:PRINT:PRINT "THE FOLLOWING PLAYER(S) CAN ME MADE TO PLAY SAFE IF YOU WISH":PRINT
     IF A=0 AND ZZ>3 THEN 1230
     IF S2=A AND S2<6 THEN PRINT S2;"- ";AA$(P9,B1(P9,ZZ)):P5(A)=S2:P4(A)=ZZ:S2=S2+1:S3=S3+1
     NEXT ZZ
     A=1:PRINT:PRINT "Z - CONTINUE"
1220 I$=INKEY$:IF I$="" THEN 1220
     IF UCASE$(I$)="Z" THEN 1230
     P6=VAL(I$):IF P6<1 OR P6>(S2+1) THEN 1220
     A=P6:IF P6=P5(P6) THEN A(P9,B1(P9,P4(A)),17)=INT((A(P9,B1(P9,P4(A)),17)+1)/3):A(P9,B1(P9,P4(A)),22)=50:LOCATE P5(A)+3,20:PRINT AA$(P9,B1(P9,P4(A)))" WILL NOW PLAY SAFE!":CALL STEALADJ:D1(P9)=D1(P9)+1:A=A+1:S3=S3+1:GOTO 1220
1230 MJ=0
     FO=99:IF H=1 AND T=1200 THEN FO=0
END SUB

SUB FOULHARD ()
     FOR I=0 TO 1:FOR I1=0 TO 13
     IF A(I,I1,22)=50 THEN A(I,I1,22)=0:A(I,I1,17)=A(I,I1,17)*3:D1(I)=D1(I)-1:MJ=50
     NEXT I1
     IF MJ=50 THEN MJ=0:F5%(I,0)=0:FOR I1=0 TO 4:F5%(I,0)=F5%(I,0)+A(I,B1(I,I1),17):NEXT I1
     NEXT I
END SUB

SUB STEALADJ ()
     FOR I=0 TO 1
     F5%(I,0)=0
     F5%(I,1)=0
     FOR I1=0 TO 4
     F5%(I,0)=F5%(I,0)+A(I,B1(I,I1),17)
     F5%(I,1)=F5%(I,1)+A(I,B1(I,I1),18)
     NEXT I1
     NEXT I
END SUB

SUB ALPHANUM (I$,J)
    J = VAL (I$)
    IF UCASE$(I$)="A" THEN J=10
    IF UCASE$(I$)="B" THEN J=11
    IF UCASE$(I$)="C" THEN J=12
    IF UCASE$(I$)="D" THEN J=13
    IF UCASE$(I$)="E" THEN J=14
END SUB

SUB BOXSCREEN ()
     FOR I=0 TO 1:COLOR TR%(I,0),TR%(I,1)
     PRINT B$(I):COLOR 14,0
     PRINT "NAME" TAB(14) " MIN   FG- A 3FG- A  FT- A ORB  RB  PT  F   A   B   S  TO"
     FOR I1=0 TO 13
     IF AA$(I,I1)="XXX" OR ZZ(I,I1)=0 THEN 8529
     COLOR 15:PRINT AA$(I,I1);TAB(14)
     IF ZZ(I,I1)<>0 THEN PRINT USING "##";INT(ZZ(I,I1)/60);:PRINT ":";:IF ZZ(I,I1)-INT(ZZ(I,I1)/60)*60>9 THEN PRINT USING "##";ZZ(I,I1)-INT(ZZ(I,I1)/60)*60; ELSE PRINT "0";:PRINT USING "#";ZZ(I,I1)-INT(ZZ(I,I1)/60)*60;
     LOCATE ,21:PRINT USING "##";A(I,I1,8);:PRINT "-";:PRINT USING"##";A(I,I1,7);:PRINT USING"  ##";W%(I,I1,0);:PRINT"-";:PRINT USING "##";W%(I,I1,1);:PRINT USING"  ##";A(I,I1,10);:PRINT"-";:PRINT USING"##";A(I,I1,9);
     PRINT USING "  ##  ## ###  #  ##  ##  ##  ##  ##  ##";A(I,I1,24),A(I,I1,11),A(I,I1,8)*2+A(I,I1,10)+W%(I,I1,0),A(I,I1,12),A(I,I1,14),A(I,I1,15),A(I,I1,13),A(I,I1,23);
     IF ZZ(I,I1)=0 THEN LOCATE ,15:PRINT"DNP" ELSE PRINT
     V9(0)=V9(0)+A(I,I1,8)
     V9(1)=V9(1)+A(I,I1,7)
     V9(2)=V9(2)+A(I,I1,10)
     V9(3)=V9(3)+A(I,I1,9)
     V9(4)=V9(4)+A(I,I1,11)
     V9(5)=V9(5)+(A(I,I1,8)*2)+A(I,I1,10)+W%(I,I1,0)
     V9(13)=V9(13)+W%(I,I1,0)
     V9(14)=V9(14)+W%(I,I1,1)
     V9(6)=V9(6)+A(I,I1,12)
     V9(7)=V9(7)+A(I,I1,14)
     V9(8)=V9(8)+A(I,I1,15)
     V9(9)=V9(9)+A(I,I1,13)
     V9(11)=V9(11)+A(I,I1,24)
     V9(12)=V9(12)+A(I,I1,23)
     V9(10)=V9(10)+ZZ(I,I1)
8529 NEXT I1
     IF V9(3)=0 THEN V9(3)=1
     PRINT:COLOR 14:PRINT "TOTALS";:COLOR 15:PRINT TAB(14) INT(V9(10)/60);:LOCATE ,21:PRINT USING"##";V9(0);:PRINT "-";:PRINT USING "###";V9(1);
     LOCATE ,28:PRINT USING "##";V9(13);:PRINT "-";:PRINT USING "##";V9(14);
     LOCATE ,35:PRINT USING "##";V9(2);:PRINT "-";:PRINT USING "##";V9(3);
     LOCATE ,42:PRINT USING "##  ## ### ##  ##  ##  ##  ##";V9(11),V9(4),V9(5),V9(6),V9(7),V9(8),V9(9),V9(12)
     PRINT TAB(22);
     IF V9(1)<>0 THEN PRINT INT(((V9(0)/V9(1))*100)+.5);"%";
     PRINT TAB(35);
     IF V9(3)<>0 THEN PRINT INT(((V9(2)/V9(3))*100)+.5);"%"
     PRINT
     COLOR 14:PRINT"TOTAL TURNOVERS -";:COLOR 15:PRINT T0(I)
     COLOR 14:PRINT"TOTAL REBOUNDS  -";:COLOR 15:PRINT R3(I)
     FOR I2=0 TO 14:V9(I2)=0:NEXT I2
     CALL HITKEY:CLS
     NEXT I
END SUB

SUB SHOTPERCENT ()
    FX%=A(P,B1(P,B),0)+TP%(D)+TP%(P)
    TP%(D)=0:TP%(P)=0
    IF FA%(P,B1(P,B))<=-5 THEN FX%=FX%-10
    F=FX%+D1(D)+D8(0,D2(D)):J8%=0
    IF N=P THEN F=F+HF%(0,TR%(P,6))
    IF N<>P AND N<>2 THEN F=F+HF%(1,TR%(P,6))
    F3S%=INT(RND(1)*100)+1
    TPA%=0
    IF DT%(D)=2 OR DT%(D)=7 OR DT%(D)=12 THEN TPA%=3
    IF DT%(D)=1 OR DT%(D)=6 OR DT%(D)=9 OR DT%(D)=11 THEN TPA%=-5
    IF OF%(P)=9 AND (F3S%>A(P,B1(P,B),19)+F5%(D,3)+TPA% OR A(P,B1(P,B),19)=0) THEN F3S%=INT(RND(1)*5)+11:J8%=1:GOTO 925
    IF OF%(P)=9 THEN 924
    IF F3S%>A(P,B1(P,B),19)+F5%(D,3)+TPA% OR A(P,B1(P,B),19)=0 THEN F3S%=INT(RND(1)*5)+3:GOTO 925
924 FX%=A(P,B1(P,B),20)
    IF FA%(P,B1(P,B))<=-5 THEN FX%=INT(FX%*.67 + .5)
    F3S%=FX%+F5%(D,2):J8%=1
    IF A(P,B1(P,B),3)-A(P,B1(P,B),7)-A(P,B1(P,B),11)-A(P,B1(P,B),12)<=0 AND (H=1 OR H=2 AND T>120) THEN F3S%=INT(RND(1)*5)+3:J8%=0
925 REM
END SUB

SUB THREEFT ()
     A(P,B1(P,B),10)=A(P,B1(P,B),10)+1
     RN=INT(RND(1)*100)+1
     IF F3=1 AND RN<=50 THEN U$="FREE THROW IS GOOD"
     IF F3=1 AND RN>50 THEN U$="FREE THROW IS GOOD"
     RN=INT(RND(1)*100)+1
     IF F3=2 AND RN<=50 THEN U$="SECOND FREE THROW IS GOOD"
     IF F3=2 AND RN>50 THEN U$="HE HITS THE SECOND ONE"
      RN=INT(RND(1)*100)+1
     IF F3=3 AND RN<=50 THEN U$="THIRD FREE THROW IS GOOD"
     IF F3=3 AND RN>50 THEN U$="HE HITS THE LAST ONE"
     CALL PBP:S(P,H)=S(P,H)+1:S(P,0)=S(P,0)+1:CALL MAINSCREEN
END SUB

SUB MADEFT ()
     A(P,B1(P,B),10)=A(P,B1(P,B),10)+1
     IF U6<>0 THEN LOCATE F3+9,1:CALL DELAY:PRINT F3;" GOOD"
     S(P,H)=S(P,H)+1:S(P,0)=S(P,0)+1
     CALL MAINSCREEN:CALL DELAY
END SUB

SUB MISSFT ()
     IF U6=0 THEN 3699
     CALL DELAY
     LOCATE F3+9,1
     PRINT F3;" MISSED"
     CALL DELAY
3699 REM
END SUB

SUB BADFT ()
     IF F3=1 THEN U$="FIRST FREE THROW IS MISSED"
     IF F3=2 THEN U$="SECOND FREE THROW IS MISSED"
     IF F3=3 THEN U$="THIRD FREE THROW IS MISSED"
     CALL PBP
END SUB

SUB PRELOAD ()
1100 NT = 0
     OPEN P$(0) + "BASK." + YN$ FOR RANDOM AS #1 LEN = 655
     Y2 = LOF(1)
     FIELD #1, 15 AS Q$(0)
     FOR I1 = 1 TO Y2 / 655
     GET #1, I1
     FOR I2 = 1 TO 15
     IF ASC(MID$(Q$(0), I2, 1)) < 32 OR ASC(MID$(Q$(0), I2, 1)) > 123 OR UCASE$(LEFT$(Q$(0), 3)) = "NOT" OR UCASE$(LEFT$(Q$(0), 3)) = "UN" THEN 1105
     NEXT I2
     NT = NT + 1
     V$(NT) = Q$(0): V%(NT) = I1
1105 NEXT I1
    CLOSE 1
    CALL TEAMSELECT
END SUB

SUB TEAMSELECT ()
1102 SELECTION% = 1
     Count% = NT
     Start% = 1
     FileColr% = 79
     HiLiteColr% = 112
     Rows% = 20
     Columns% = 4
     Spacing% = 6
     Row% = 4
     Column% = 1
     COLOR , 4: CLS : LOCATE , 33: COLOR 14
     PRINT "TEAM SELECTION": COLOR 15
     LOCATE 25, 1: COLOR 14: PRINT "ESC"; : COLOR 15
     PRINT "-SELECT NEW ID  PGDN  PGUP  "; : COLOR 14
     PRINT "ENTER"; : COLOR 15: PRINT "-SELECTS TEAM";
     CALL ShowCursor
20   MAMenu VARPTR(V$(1)), SELECTION%, Start%, Count%, EXITCODE%, FileColr%, HiLiteColr%, Rows%, Columns%, Spacing%, Row%, Column%
     CALL HideCursor
     IF EXITCODE% = 27 THEN BO% = 1: GOTO 21
     IF EXITCODE% = -71 THEN Start% = 1: EXITCODE% = 3: SELECTION% = 1: GOTO 20
     IF EXITCODE% = -79 THEN Start% = NT: EXITCODE% = 3: SELECTION% = NT: GOTO 20
     IF EXITCODE% = -73 THEN Start% = Start% - 80: IF Start% < 1 THEN Start% = 1
     IF EXITCODE% = -81 THEN Start% = Start% + 80: IF Start% > NT THEN Start% = NT
     IF EXITCODE% = -81 OR EXITCODE% = -73 THEN EXITCODE% = 3: SELECTION% = Start%: GOTO 20
     I1 = V%(SELECTION%)
     CALL GETATEAM (I1,YN$)
21   END SUB

SUB SELECTID ()
56 COLOR 15,0:CLS
   JJ=9
   SN=1:LOCATE 6,8:COLOR 15,4
   PRINT " Ö"; STRING$(61,196);"· ";:FOR II=1 TO JJ:LOCATE 6+II,8
   PRINT " º"; STRING$(61,32); "º ";:NEXT
   LOCATE 7+JJ,8
   PRINT " Ó";STRING$(61,196); "½ ";:LOCATE 7,32
   LOCATE ,12:PRINT "ENTER DISK ID: ":PRINT
   LOCATE ,12:PRINT "THE DISK ID IS USUALLY THE LAST TWO DIGITS OF THE"
   LOCATE ,12:PRINT "SEASON DISK YOU ARE PLAYING FROM (IE. 89, 76, 67)."
   PRINT
   LOCATE ,12:PRINT "MAKE SURE NUM LOCK KEY IS OFF TO USE ARROW KEYS"
   LOCATE ,12:PRINT "AND PG UP/PG DN KEYS"
   PRINT
   LOCATE ,12:PRINT "(JUST HIT ENTER TO USE PREVIOUS ID, IF SAME)"
   LOCATE 7,27:INPUT NY$
   COLOR 15,0
   IF UCASE$(LEFT$(P$(0),1))<>"A" AND UCASE$(LEFT$(P$(0),1))<>"B" THEN 61
   CLS:PRINT "MAKE SURE CORRECT TEAMS DISK IS IN DRIVE "P$(0)
   LOCATE 23,1:PRINT "PRESS ANY KEY TO CONTINUE"
   CALL HITKEY
61 IF NY$="" THEN CALL TEAMSELECT:GOTO 60
   YN$=NY$
   FOR I=1 TO 500:V$(I)="":NEXT
   CALL PRELOAD
60 IF BO%=1 THEN BO%=0:GOTO 56
58 LOCATE 2,33:COLOR TR%(P9,0),TR%(P9,1):PRINT B$(P9):COLOR 15,4:LOCATE ,33:PRINT "ANY CHANGE (YN)";:I$=INKEY$:IF I$="" THEN 58
   IF UCASE$(I$)="Y" THEN 56
   COLOR 15,0
   CALL TEAMSETUP
   CALL DISABLEPLAYER
END SUB

SUB PRDFAT ()
    'FATIGUE DUE TO PRESSURE DEFENSE ON THE DEFENSE
    FOR I=0 TO 4
    R0=INT(RND(1)*100)+1
    IF R0<=X0% THEN FA%(D,B1(D,I))=FA%(D,B1(D,I))+X1%
    IF R0>X0% THEN FA%(D,B1(D,I))=FA%(D,B1(D,I))+X1%+1
    IF FA%(D,B1(D,I))>0 THEN FA%(D,B1(D,I))=0
    IF FA%(D,B1(D,I))<-5 THEN FA%(D,B1(D,I))=-5
    NEXT
END SUB

SUB PRPFAT ()
    'FATIGUE AGAINST OFFENSIVE PLAYERS SUBJECT TO PRESS
    FOR I=0 TO 4
    R0=INT(RND(1)*100)+1
    IF R0<=X0% THEN FA%(P,B1(P,I))=FA%(P,B1(P,I))+X1%
    IF R0>X0% THEN FA%(P,B1(P,I))=FA%(P,B1(P,I))+X1%+1
    IF FA%(P,B1(P,I))>0 THEN FA%(P,B1(P,I))=0
    IF FA%(P,B1(P,I))<-5 THEN FA%(P,B1(P,I))=-5
    NEXT
END SUB

SUB WHOGETSBALL ()
1040 cnt%=0
1041 cnt%=cnt%+1
     if cnt%=4 then 1047
     M9=0:B=INT(RND(1)*5):X=INT(RND(1)*100)+1
     IF X<=25 THEN 1046
     FOR I=0 TO 4
     M8=INT(C(P,B1(P,I),1)/C(P,B1(P,I),0)+.5)-A(P,B1(P,I),7)
     IF M8<=0 THEN M8=0
     rem:IF M8<=0 AND A(P,B1(P,I),3)-A(P,B1(P,I),7)-A(P,B1(P,I),11)-A(P,B1(P,I),12)>0 THEN M8=A(P,B1(P,I),3)-A(P,B1(P,I),7)-A(P,B1(P,I),11)-A(P,B1(P,I),12)
     IF M8>=M9 THEN B=I:M9=M8
     NEXT I
1046 M8=A(P,B1(P,B),3)-A(P,B1(P,B),7)-A(P,B1(P,B),11)-A(P,B1(P,B),12)
     IF A(P,B1(P,B),4)>=5 AND M8/A(P,B1(P,B),3)<=0.4 AND H=1 THEN 1041
     IF A(P,B1(P,B),4)>=5 AND M8/A(P,B1(P,B),3)<=0.2 AND H=2 AND T>120 THEN 1041
     IF A(P,B1(P,B),3)<10 AND A(P,B1(P,B),4)>=5 AND M8/A(P,B1(P,B),3)<=0.75 AND H=1 THEN 1041
     IF A(P,B1(P,B),3)<10 AND A(P,B1(P,B),4)>=5 AND M8/A(P,B1(P,B),3)<=0.5 AND H=2 AND T>120 THEN 1041
     GOTO 1041
1047 REM
END SUB

SUB BALLDISTRIBUTE ()
    R0=INT(RND(1)*100)+1
    IF U5=0 AND CM%=1 OR U5=1 AND D=CT AND CM%=1 OR U5=1 AND P=CT OR U5=2 THEN CALL WHOGETSBALL:GOTO 427
    IF D2(D)=2 OR D2(D)=3 THEN 415
    IF S9<=90 AND R0<=15 THEN 424
    IF S9<=100 AND R0<=20 THEN 424
    IF S9<=110 AND R0<=25 THEN 424
    IF S9<=120 AND R0<=30 THEN 424
    IF S9<=130 AND R0<=38 THEN 424
    IF S9<=140 AND R0<=53 THEN 424
    IF S9<=150 AND R0<=60 THEN 424
    IF S9>150 AND R0<=67 THEN 424
    GOTO 423
415 IF S9<=90 AND R0<=8 THEN 424
    IF S9<=100 AND R0<=10 THEN 424
    IF S9<=110 AND R0<=13 THEN 424
    IF S9<=120 AND R0<=15 THEN 424
    IF S9<=130 AND R0<=18 THEN 424
    IF S9<=140 AND R0<=53 THEN 424
    IF S9<=150 AND R0<=60 THEN 424
    IF S9>150 AND R0<=67 THEN 424
423 B=INT(RND(1)*5):GOTO 427
424 IF U6<>0 AND PB%=0 THEN U$="PASS TO CHOICE (0-4)":CALL PBP
    IF U6<>0 AND PB%=1 THEN
       REM:IF AP=1 AND U5=2 OR U6=0 THEN 425
       IF U6=0 THEN 425
       FOR I=8 TO 15
       LOCATE I,1
       CALL BLANKLINE
       NEXT I
       LOCATE 8,1
       PRINT "PASS TO CHOICE (0-4)"
       CALL DELAY
    END IF
425 I$=INKEY$:IF I$="" THEN 425
    IF UCASE$(I$)="T" THEN CALL TICKER:CALL SCOREBOARD:GOTO 425
    B=VAL(I$):IF B<0 OR B>4 THEN 424
427 END SUB

SUB PLAYINGTIME ()
    REM:*** INCREMENT MINUTES ***
    FOR I3=0 TO 1:FOR I4=0 TO 4
    ZZ(I3,B1(I3,I4))=ZZ(I3,B1(I3,I4))+TE
    NEXT:NEXT
END SUB

SUB CLOCKOVER ()
    IF T<=0 THEN TE=T:CALL PLAYINGTIME:T=0
END SUB

SUB BLANKLINE ()
     PRINT "                                      "
END SUB

SUB CLEARPBPBOX ()
     REM:IF AP=1 AND U5=2 OR U6=0 THEN 4096
     IF U6=0 THEN 4096
     FOR I=8 TO 15:LOCATE I,1:CALL BLANKLINE:NEXT I
4096 LOCATE 10
END SUB

SUB DEADBALLOPTIONS ()
220 PB$=""
    CALL CLEARPBP
    IF U5=2 THEN P9=0:CALL COMPUTERSUB:CALL FATIGUE:P9=1:CALL COMPUTERSUB:CALL FATIGUE
    IF U5=1 THEN P9=CT:CALL COMPUTERSUB:CALL FATIGUE
    FO=0
    XM=0
    CALL CLEARPBPBOX
    IF U5=2 THEN S2=0:P9=P:C1=2:CALL CLOCKOVER:CALL STEALADJ:GOTO 222
    LOCATE 9,1:COLOR 14,0
    PRINT "<ENTER>-CONTINUE"
    PRINT "1-SUB ";B$(P)
    PRINT "2-SUB ";B$(D)
    PRINT "3-CHANGE STRATEGY ";B$(P)
    PRINT "4-CHANGE STRATEGY ";B$(D)
    PRINT "5-TIME OUT ";B$(P)
    PRINT "6-TIME OUT ";B$(D)
221 I$=INKEY$:IF I$="" THEN 221
    P3=VAL(I$)
    IF P3<1 OR P3>6 OR U5=1 AND (P3=1 OR P3=3 OR P3=5 AND T1(P)<=0) AND P=CT OR U5=1 AND (P3=2 OR P3=4 OR P3=6 AND T1(D)<=0) AND D=CT THEN S2=0:P9=P:C1=2:CALL CLOCKOVER:CALL STEALADJ:GOTO 227
    IF P3=5 AND T1(P)<=0 OR P3=6 AND T1(D)<=0 THEN 221
    IF P3=1 THEN S2=P
    IF P3=2 THEN S2=D
    IF P3=3 THEN P9=P:CALL OFFENSE:CALL SCOREBOARD:GOTO 220
    IF P3=4 THEN P9=D:CALL OFFENSE:CALL SCOREBOARD:GOTO 220
    IF P3=5 THEN T1(P)=T1(P)-1:CALL RESETFATIGUE:CALL SCOREBOARD:GOTO 220
    IF P3=6 THEN T1(D)=T1(D)-1:CALL RESETFATIGUE:CALL SCOREBOARD:GOTO 220
    C1=1:P9=S2:CALL LINEUPS:CALL FOULSAFE:P9=P:LC%=1:GOTO 220
227 IF LC%=1 THEN LC%=0:CALL CLOCKOVER:CALL SCOREBOARD
    REM:IF AP=1 AND U5=2 OR U6=0 THEN 222
    IF U6=0 THEN 222
    FOR I=8 TO 15:LOCATE I,1:CALL BLANKLINE:NEXT I
222 END SUB


SUB LASTFIVEMENU ()
     JJ=12
     LOCATE 8,8:COLOR TR%(P,0),TR%(P,1)
     PRINT " Ö"; STRING$(61,196);"· ";:FOR II=1 TO JJ:LOCATE 8+II,8
     PRINT " º"; STRING$(61,32); "º ";:NEXT
     LOCATE 9+JJ,8
     PRINT " Ó";STRING$(61,196); "½ ";:LOCATE 10,15
     PRINT B$(P)" LAST 5 SEC STRATEGY:"
     LOCATE 12,14
     LOCATE ,14:PRINT USING "TIME REMAINING #.#";T
     LOCATE ,14:PRINT "                                     TIME REQD"
     LOCATE ,14:PRINT "0 - FULL COURT PASS (SHOOT A 2)      0.1 - 3.0"
     LOCATE ,14:PRINT "1 - FULL COURT PASS (SHOOT A 3)      0.1 - 3.0"
     LOCATE ,14:PRINT "2 - SHOOT FROM BACKCOURT             0.1 - 0.5"
     LOCATE ,14:PRINT "3 - GET TO HALF COURT, CALL TIME OUT 1.5 - 2.5"
     LOCATE ,14:PRINT "4 - WORK DOWN THE FLOOR FOR A 3      3.0 - 4.0"
     LOCATE ,14:PRINT "5 - WORK DOWN THE FLOOR FOR A 2      3.0 - 5.0"
END SUB

SUB RESETFATIGUE ()
295  FOR I=0 TO 1:FOR I1=0 TO 1:PR%(I,I1)=0:NEXT:NEXT
     FOR I=0 TO 1:FOR I1=0 TO 13:FA%(I,I1)=FA%(I,I1)+1
     IF FA%(I,I1)>0 THEN FA%(I,I1)=0
     NEXT:NEXT
END SUB

SUB WINDEX ()
       REM:IF AP=1 AND U5=2 OR U6=0 THEN 4090
       IF U6=0 THEN 4090
       FOR I=8 TO 15
       LOCATE I,1
       PRINT "                                      "
       NEXT I
       LOCATE 8,1
4090 REM
END SUB


